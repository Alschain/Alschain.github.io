<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>SGM</title>
    <link href="/2022/06/28/SGM/"/>
    <url>/2022/06/28/SGM/</url>
    
    <content type="html"><![CDATA[<h1 id="Semi-Global-Matching"><a href="#Semi-Global-Matching" class="headerlink" title="Semi-Global Matching"></a>Semi-Global Matching</h1><p>Semi-Global Matchingï¼Œå³åŠå…¨å±€åŒ¹é…ï¼Œæ˜¯åŒç›®ç«‹ä½“åŒ¹é…ä¸­ä¸€é¡¹éå¸¸å‡ºè‰²çš„å·¥ä½œã€‚SGMç”±Heiko Hirschmulleräº2007å¹´åœ¨T-PAMIä¸Šå‘è¡¨çš„æ–‡ç« <a href="https://elib.dlr.de/55367/1/Stereo_Processing-Hirschm%c3%bcller.pdf">Stereo Processing by Semi-Global Matching and Mutual Information</a>æå‡ºã€‚Semi-Globalé¡¾åæ€ä¹‰ï¼Œæ˜¯ä»‹äºå…¨å±€å’Œå±€éƒ¨ä¹‹é—´çš„ä¸€ç§ç®—æ³•ï¼Œæ—¢æ²¡æœ‰è€ƒè™‘æ•´å¼ å›¾åƒæ‰€æœ‰çš„åƒç´ ç‚¹ï¼Œä¹Ÿæ²¡æœ‰åªè€ƒè™‘åƒç´ çš„å±€éƒ¨åŒºåŸŸã€‚</p><h1 id="ç†µä¸äº’ä¿¡æ¯"><a href="#ç†µä¸äº’ä¿¡æ¯" class="headerlink" title="ç†µä¸äº’ä¿¡æ¯"></a>ç†µä¸äº’ä¿¡æ¯</h1><p>SGMæ–‡ç« ä¸­é‡‡ç”¨çš„costè®¡ç®—æ˜¯åŸºäºç†µå’Œäº’ä¿¡æ¯æ¥å®Œæˆçš„ã€‚ç†µ$H_I$ã€è”åˆç†µ$H_{I_1,I_2}$å’Œäº’ä¿¡æ¯$MI_{I_1,I_2}$å¦‚ä¸‹å…¬å¼å®šä¹‰ã€‚</p><p>$$<br>H_I &#x3D; - \int_0^1P_I(i)\log P_I(i)di<br>$$</p><p>$$<br>H_{I_1,I_2} &#x3D; - \int_0^1\int_0^1P_{I_1,I_2}(i_1,i_2) \log P_{I_1,I_2}(i_1,i_2)di_1di_2<br>$$</p><p>$$<br>MI_{I_1,I_2}&#x3D;H_{I_1} + H_{I_2} - H_{I_1,I_2}<br>$$</p><p>å…¶ä¸­$P$ä¸ºå€¼å‡ºç°çš„æ¦‚ç‡ã€‚æ–‡ç« æŒ‡å‡ºåˆ©ç”¨äº’ä¿¡æ¯çš„æ–¹å¼æ¥è¡¨ç¤ºpixelå¯¹åº”çš„costå€¼ï¼Œå¯¹äºå…‰å¼ºç­‰æœ‰è‰¯å¥½çš„é²æ£’æ€§ã€‚</p><p>é‚£ä¹ˆåœ¨å›¾ç‰‡ä¸­å¦‚ä½•è®¡ç®—å‘¢ï¼ŸSGMçš„è¾“å…¥æ˜¯å·¦å³ä¸¤å¼ <strong>æçº¿çŸ«æ­£å</strong>çš„<strong>ç°åº¦å›¾</strong>ï¼Œå› æ­¤é¦–å…ˆè®¡ç®—æ¯ä¸€å¼ å›¾ç‰‡çš„ç°åº¦ç›´æ–¹å›¾ï¼Œä»¥æ­¤æ¥è¡¨ç¤ºæ¯ä¸€ä¸ªç°åº¦å€¼å‡ºç°çš„æ¦‚ç‡ï¼Œæ‰€ä»¥å•å¼ å›¾ç‰‡ä¸­çš„æ¦‚ç‡å‡½æ•°è‡ªå˜é‡çš„å–å€¼æ˜¯0<del>255ã€‚è€Œå›¾ç‰‡çš„è”åˆæ¦‚ç‡$P_{I_1,I_2}(i,k)$åˆ™å®šä¹‰åŸŸ(0,0)</del>(255,255)ï¼Œå®šä¹‰ä¸ºï¼š</p><p>$$<br>P_{I_1,I_2}(i,k) &#x3D; \frac{1}{n} \Sigma_pT[(i,k)&#x3D;&#x3D;(I_{1p},I_{2p})]<br>$$</p><p>å…¶ä¸­$T$ä¸ºæŒ‡ç¤ºå‡½æ•°ï¼Œæ¡ä»¶ä¸ºçœŸå€¼ä¸º1å¦åˆ™ä¸º0ã€‚é‚£ä¹ˆå®é™…ä¸Šåœ¨é¢„å¤„ç†çš„æ—¶å€™æˆ‘ä»¬åªéœ€è¦å°†256*256çš„è”åˆæ¦‚ç‡å›¾è®¡ç®—å¥½å°±è¡Œã€‚å¦å¤–è¿˜å¯¹è¿™ä¸ªæ¦‚ç‡å›¾åšäº†Gaussianå¹³æ»‘å¤„ç†ï¼Œç›®çš„æ˜¯ä¸ºäº†å‡å°‘å™ªå£°å¯¹ç»“æœçš„å½±å“ã€‚</p><h1 id="ä»£ä»·èšåˆ"><a href="#ä»£ä»·èšåˆ" class="headerlink" title="ä»£ä»·èšåˆ"></a>ä»£ä»·èšåˆ</h1><p>æˆ‘ä»¬å·²ç»å¯ä»¥ç®—å‡ºåŸºäºMIçš„åŒ¹é…ä»£ä»·ï¼Œä½†æ˜¯è¿™åªæ˜¯per-pixel levelçš„å¤„ç†ï¼Œå¾ˆå®¹æ˜“å—åˆ°è¯¯å·®å’Œå™ªå£°çš„å½±å“ã€‚å› æ­¤SGMè¿˜éœ€è¦è€ƒè™‘ä½¿ç”¨é‚»åŸŸä¿¡æ¯æ¥æ„é€ loss functionå¯¹å…¶è¿›è¡Œçº¦æŸã€‚æ–‡ç« ä½¿ç”¨èƒ½é‡å…¬å¼$E(D)$æ¥è¡¨ç¤ºã€‚</p><p>$$<br>E(D)&#x3D;\Sigma_p(C(p,D_p)+\Sigma_{q\in N_p}P_1T[|D_p-D_q|&#x3D;1]+\Sigma_{q\in N_p}P_2T[|D_p-D_q|&gt;1])<br>$$</p><p>å…¶ä¸­$P_1,P_2$éƒ½æ˜¯äººä¸ºè®¾ç½®çš„æƒ©ç½šé¡¹å¸¸æ•°ï¼Œåä¸¤é¡¹æ˜¯å½“å‰åƒç´ $p$å’Œå…¶é‚»åŸŸ$N_p$å†…æ‰€æœ‰åƒç´ $q$ä¹‹é—´çš„çº¦æŸã€‚ç°åœ¨é—®é¢˜å°±è½¬åŒ–ä¸ºæ‰¾å‡ºä¸€ä¸ªæœ€ç»ˆçš„Disparity Mapä½¿å¾—è¿™ä¸ªå…¨å±€èƒ½é‡å‡½æ•°æœ€å°ã€‚</p><p>æ–‡ç« æå‡ºæ¯ä¸€ä¸ªç‚¹éƒ½æœ‰å‘¨å›´çš„Nä¸ªï¼ˆ8ä¸ªã€16ä¸ªç­‰ï¼‰æ–¹å‘ï¼Œæˆ‘ä»¬åªéœ€è¦å°†æ²¡ä¸€ä¸ªæ–¹å‘ä¸Šè¿›è¡Œä¼ æ’­è®¡ç®—å°±èƒ½å¤Ÿè®©å¯¹ç‚¹$p$ä¸å¯å¯¼çš„$E(D)$åˆ©ç”¨è¿™ç§æ–¹å¼æ¥è¿›è¡Œä¼˜åŒ–ã€‚</p><p>$$<br>L_r(p,d)&#x3D;C(p,d) + \min(L_r(p-r,d), L_r(p-r,d-1)+P_1, L_r(p-r,d+1)+P_1, \min_iL_r(p-r,i)+P_2) - \min_kL_r(p-r,k)<br>$$</p><p>$p$ç‚¹ä¸ŠæŸä¸ªé‚»åŸŸæ–¹å‘çš„ä»£ä»·èšåˆåŒ…å«ï¼šå½“å‰ç‚¹çš„åŒ¹é…ä»£ä»·ï¼›minï¼ˆå½“å‰é‚»åŸŸæ–¹å‘ä¸Š$p-r$è¿™ä¸ªåƒç´ ç‚¹çš„å½“å‰è§†å·®ä»£ä»·èšåˆï¼Œ$p-r$ç‚¹çš„è§†å·®å·®å€¼ä¸º1çš„ä»£ä»·èšåˆ$+P_1$ï¼Œ$p-r$ç‚¹çš„è§†å·®å€¼å¤§äº1çš„æœ€å°ä»£ä»·èšåˆ$+P_2$ï¼‰ï¼›$p-r$ç‚¹çš„è§†å·®æ’å€¼å¤§äº1çš„æœ€å°ä»£ä»·èšåˆï¼Œlast termæ˜¯é˜²æ­¢ç»“æœè¿‡å¤§åšçš„å¤„ç†ã€‚</p><p>è€Œ$p-r$å®é™…ä¸Šå°±æ˜¯æ²¿ç€æŸä¸€ä¸ªæ–¹å‘ä»å‰å¾€åè®¡ç®—ç›´åˆ°ç»“æŸã€‚</p><h1 id="å…³äºéƒ¨åˆ†å®ç°"><a href="#å…³äºéƒ¨åˆ†å®ç°" class="headerlink" title="å…³äºéƒ¨åˆ†å®ç°"></a>å…³äºéƒ¨åˆ†å®ç°</h1><p>åœ¨å®ç°SGMçš„æ—¶å€™ï¼Œæ–‡ç« ä¸­è¯´æ˜¯éšæœºåˆå§‹åŒ–å‡ æ¬¡æ¥åšåˆå€¼ï¼Œä½†æ˜¯ä¸€èˆ¬çš„åšæ³•æ˜¯åœ¨DispèŒƒå›´å†…éƒ½å»è®¡ç®—äº’ä¿¡æ¯å¾—åˆ°æœ€åˆçš„Cost Volumeï¼Œç„¶ååœ¨å¯¹ä¸åŒæ–¹å‘ä¸Šåšä»£ä»·èšåˆã€‚</p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>SGMæ˜¯ä¸€ä¸ªå¾ˆå¼ºå¤§çš„æ–¹æ³•ï¼Œåœ¨Deep Learningæ²¡å¼€æˆ˜ä»¥å‰æ¦œå•å‰åˆ—éƒ½æ˜¯åŸºäºSGMçš„æ”¹è¿›ï¼ŒOpenCVä¹Ÿå®ç°äº†SGBMçš„åŒç›®ç«‹ä½“åŒ¹é…ç®—æ³•ï¼ŒåŒæ—¶ä¹Ÿæœ‰å¾ˆå¤šåŸºäºCUDAçš„å¹¶è¡Œå®ç°ï¼Œè®©SGMç®—æ³•æœ‰äº†æ›´å¿«çš„è¿è¡Œæ—¶é—´ï¼Œæ˜¯åŒç›®ç«‹ä½“åŒ¹é…ä¸­ç»å…¸çš„ç®—æ³•ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://elib.dlr.de/55367/1/Stereo_Processing-Hirschm%c3%bcller.pdf">Stereo Processing by Semi-Global Matching and Mutual Information</a></p><p><a href="https://blog.csdn.net/wsj998689aa/article/details/49464017">CSDN-ç‹å—£é’§ blog</a></p><p><a href="https://blog.csdn.net/zilanpotou182/article/details/73382412">CSDN-Witnesses blog</a></p>]]></content>
    
    
    <categories>
      
      <category>3D Algorithm</category>
      
    </categories>
    
    
    <tags>
      
      <tag>stereo matching</tag>
      
      <tag>traditional</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Diving into NeRF-PyTorch</title>
    <link href="/2022/06/27/nerf-pytorch/"/>
    <url>/2022/06/27/nerf-pytorch/</url>
    
    <content type="html"><![CDATA[<h1 id="Diving-into-NeRF-PyTorch"><a href="#Diving-into-NeRF-PyTorch" class="headerlink" title="Diving into NeRF-PyTorch"></a>Diving into NeRF-PyTorch</h1><p>NeRFï¼Œå³Neural Radiance Fieldsï¼Œç”±Ben Mildenhallç­‰äººäºECCV2020åœ¨æ–‡ç« <a href="https://arxiv.org/pdf/2003.08934.pdf">NeRF: Representing Scenes as Neural Radiance Fields for View Synthesis</a>ä¸­æå‡ºã€‚</p><p>æœ¬è´¨ä¸Šï¼ŒNeRFå’ŒDeepSDFç±»ä¼¼ï¼Œéƒ½æ˜¯å°†ä¿¡æ¯encodeåˆ°ç¥ç»ç½‘ç»œä¸­ï¼Œè€ŒNeRFåˆ©ç”¨Differentiable Volume Renderingå’Œpositional encodingå°†æ•´ä¸ªè¿‡ç¨‹å˜å¾—å¯å¾®ï¼Œç„¶åå¯ä»¥åˆ©ç”¨ç¥ç»ç½‘ç»œæ¥è¿›è¡Œbpã€‚</p><h1 id="A-Brief-Review-of-NeRF"><a href="#A-Brief-Review-of-NeRF" class="headerlink" title="A Brief Review of NeRF"></a>A Brief Review of NeRF</h1><ul><li>åˆ©ç”¨å·²çŸ¥ç›¸æœºå‚æ•°çš„å›¾ç‰‡ç»„è¿›è¡Œè®­ç»ƒMLP</li><li>MLPè¾“å…¥ä¸º3Dç‚¹$&lt;x,y,z&gt;$å’Œæ–¹å‘$&lt;\theta, \phi&gt;$ï¼Œè¾“å‡ºä¸ºè¯¥RGBå’Œdensity</li><li>åŠ å…¥äº†3Dç‚¹çš„positional encoding</li><li>åˆ©ç”¨å¯å¾®çš„volume renderingåœ¨å›¾ç‰‡è§†è§’ä¸‹è¿›è¡Œæ¸²æŸ“å¹¶åˆ©ç”¨è¾“å…¥çš„å›¾ç‰‡ç»„è¿›è¡Œçº¦æŸå­¦ä¹ </li></ul><h1 id="Implementation-Keypoints"><a href="#Implementation-Keypoints" class="headerlink" title="Implementation Keypoints"></a>Implementation Keypoints</h1><p>æœ¬æ–‡ä»£ç é˜…è¯»åŸºäº<a href="https://github.com/yenchenlin/nerf-pytorch">NeRF-PyTorch Codebase</a>ã€‚</p><h2 id="Positional-Encoding"><a href="#Positional-Encoding" class="headerlink" title="Positional Encoding"></a>Positional Encoding</h2><p>ä½ç½®ç¼–ç å¦‚åŒpaperä¸­ä»‹ç»çš„ä¸€æ ·ï¼Œåˆ©ç”¨$sin$å’Œ$cos$å¯¹ä½ç½®ä¿¡æ¯è¿›è¡Œç¼–ç ï¼Œåˆ©ç”¨ä¸åŒé¢‘ç‡çš„ç®—å­å¯¹å…¶è¿›è¡Œè§£è€¦ã€‚å¦åœ¨NeRFä¸­ï¼Œ$&lt;x,y,z&gt;$ä¸‰ä¸ªæ–¹å‘æ˜¯åˆ†åˆ«è¿›è¡Œä½ç½®ç¼–ç çš„ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Positional encoding (section 5.1)</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Embedder</span>:<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, **kwargs</span>):<br>        self.kwargs = kwargs<br>        self.create_embedding_fn()<br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">create_embedding_fn</span>(<span class="hljs-params">self</span>):<br>        embed_fns = []<br>        d = self.kwargs[<span class="hljs-string">&#x27;input_dims&#x27;</span>]<br>        out_dim = <span class="hljs-number">0</span><br>        <span class="hljs-keyword">if</span> self.kwargs[<span class="hljs-string">&#x27;include_input&#x27;</span>]:<br>            embed_fns.append(<span class="hljs-keyword">lambda</span> x : x)<br>            out_dim += d<br>            <br>        max_freq = self.kwargs[<span class="hljs-string">&#x27;max_freq_log2&#x27;</span>]<br>        N_freqs = self.kwargs[<span class="hljs-string">&#x27;num_freqs&#x27;</span>]<br>        <br>        <span class="hljs-keyword">if</span> self.kwargs[<span class="hljs-string">&#x27;log_sampling&#x27;</span>]:<br>            freq_bands = <span class="hljs-number">2.</span>**torch.linspace(<span class="hljs-number">0.</span>, max_freq, steps=N_freqs)<br>        <span class="hljs-keyword">else</span>:<br>            freq_bands = torch.linspace(<span class="hljs-number">2.</span>**<span class="hljs-number">0.</span>, <span class="hljs-number">2.</span>**max_freq, steps=N_freqs)<br>            <br>        <span class="hljs-keyword">for</span> freq <span class="hljs-keyword">in</span> freq_bands:<br>            <span class="hljs-keyword">for</span> p_fn <span class="hljs-keyword">in</span> self.kwargs[<span class="hljs-string">&#x27;periodic_fns&#x27;</span>]:<br>                embed_fns.append(<span class="hljs-keyword">lambda</span> x, p_fn=p_fn, freq=freq : p_fn(x * freq))<br>                out_dim += d<br>                    <br>        self.embed_fns = embed_fns<br>        self.out_dim = out_dim<br>        <br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">embed</span>(<span class="hljs-params">self, inputs</span>):<br>        <span class="hljs-keyword">return</span> torch.cat([fn(inputs) <span class="hljs-keyword">for</span> fn <span class="hljs-keyword">in</span> self.embed_fns], -<span class="hljs-number">1</span>)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_embedder</span>(<span class="hljs-params">multires, i=<span class="hljs-number">0</span></span>):<br>    <span class="hljs-keyword">if</span> i == -<span class="hljs-number">1</span>:<br>        <span class="hljs-keyword">return</span> nn.Identity(), <span class="hljs-number">3</span><br>    <br>    embed_kwargs = &#123;<br>                <span class="hljs-string">&#x27;include_input&#x27;</span> : <span class="hljs-literal">True</span>,<br>                <span class="hljs-string">&#x27;input_dims&#x27;</span> : <span class="hljs-number">3</span>,<br>                <span class="hljs-string">&#x27;max_freq_log2&#x27;</span> : multires-<span class="hljs-number">1</span>,<br>                <span class="hljs-string">&#x27;num_freqs&#x27;</span> : multires,<br>                <span class="hljs-string">&#x27;log_sampling&#x27;</span> : <span class="hljs-literal">True</span>,<br>                <span class="hljs-string">&#x27;periodic_fns&#x27;</span> : [torch.sin, torch.cos],<br>    &#125;<br>    <br>    embedder_obj = Embedder(**embed_kwargs)<br>    embed = <span class="hljs-keyword">lambda</span> x, eo=embedder_obj : eo.embed(x)<br>    <span class="hljs-keyword">return</span> embed, embedder_obj.<br></code></pre></td></tr></table></figure><h2 id="Get-Rays"><a href="#Get-Rays" class="headerlink" title="Get Rays"></a>Get Rays</h2><p>ä¸€å¼€å§‹å¯¹è¿™ä¸ªdirectionçš„è·å–æ²¡æœ‰ç†è§£ï¼Œåé¢åœ¨issueä¸­çœ‹åˆ°è¿™ç¯‡æ–‡ç« ï¼š<a href="https://www.scratchapixel.com/lessons/3d-basic-rendering/ray-tracing-generating-camera-rays/generating-camera-rays">Ray-Tracing: Generating Camera Rays</a>åæœ‰äº†è¿›ä¸€æ­¥çš„è®¤è¯†ã€‚å®é™…è¿˜æ˜¯3D Basicæ²¡æœ‰äº†è§£åˆ°ä½ï¼Œæ¦‚æ‹¬ä¸€ä¸‹å®é™…ä¸Šè¿™ä¸ªdirectionå°±æ˜¯åœ¨ndcåæ ‡ç³»ä¸‹ï¼Œç›¸æœºåœ¨åŸç‚¹è€Œndcå¹³é¢åœ¨1ä¸ªå•ä½è·ç¦»å¤„å¯¹æ¯ä¸€ä¸ªpixelè®¡ç®—æ–¹å‘å¾—åˆ°ã€‚ç„¶åå°†directionéƒ½å’Œå¤–å‚çŸ©é˜µç›¸ä¹˜å°±èƒ½å¤Ÿå¾—åˆ°ä¸–ç•Œåæ ‡ç³»ä¸‹æ¯ä¸€ä¸ªpixelå¯¹åº”çš„rayçš„directionï¼Œä¹Ÿèƒ½å¤ŸçŸ¥é“ç›¸æœºåŸç‚¹çš„positionã€‚ä¹‹ååªéœ€è¦æŒ‰ç…§æ­¥é•¿å‘å‰passæ¥åšvolume renderå°±å¯ä»¥äº†ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># Ray helpers</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_rays</span>(<span class="hljs-params">H, W, K, c2w</span>):<br>    i, j = torch.meshgrid(torch.linspace(<span class="hljs-number">0</span>, W-<span class="hljs-number">1</span>, W), torch.linspace(<span class="hljs-number">0</span>, H-<span class="hljs-number">1</span>, H))  <span class="hljs-comment"># pytorch&#x27;s meshgrid has indexing=&#x27;ij&#x27;</span><br>    i = i.t()<br>    j = j.t()<br>    dirs = torch.stack([(i-K[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>])/K[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], -(j-K[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>])/K[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>], -torch.ones_like(i)], -<span class="hljs-number">1</span>)<br>    <span class="hljs-comment"># Rotate ray directions from camera frame to the world frame</span><br>    rays_d = torch.<span class="hljs-built_in">sum</span>(dirs[..., np.newaxis, :] * c2w[:<span class="hljs-number">3</span>,:<span class="hljs-number">3</span>], -<span class="hljs-number">1</span>)  <span class="hljs-comment"># dot product, equals to: [c2w.dot(dir) for dir in dirs]</span><br>    <span class="hljs-comment"># Translate camera frame&#x27;s origin to the world frame. It is the origin of all rays.</span><br>    rays_o = c2w[:<span class="hljs-number">3</span>,-<span class="hljs-number">1</span>].expand(rays_d.shape)<br>    <span class="hljs-keyword">return</span> rays_o, rays_d<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">get_rays_np</span>(<span class="hljs-params">H, W, K, c2w</span>):<br>    i, j = np.meshgrid(np.arange(W, dtype=np.float32), np.arange(H, dtype=np.float32), indexing=<span class="hljs-string">&#x27;xy&#x27;</span>)<br>    dirs = np.stack([(i-K[<span class="hljs-number">0</span>][<span class="hljs-number">2</span>])/K[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>], -(j-K[<span class="hljs-number">1</span>][<span class="hljs-number">2</span>])/K[<span class="hljs-number">1</span>][<span class="hljs-number">1</span>], -np.ones_like(i)], -<span class="hljs-number">1</span>)<br>    <span class="hljs-comment"># Rotate ray directions from camera frame to the world frame</span><br>    rays_d = np.<span class="hljs-built_in">sum</span>(dirs[..., np.newaxis, :] * c2w[:<span class="hljs-number">3</span>,:<span class="hljs-number">3</span>], -<span class="hljs-number">1</span>)  <span class="hljs-comment"># dot product, equals to: [c2w.dot(dir) for dir in dirs]</span><br>    <span class="hljs-comment"># Translate camera frame&#x27;s origin to the world frame. It is the origin of all rays.</span><br>    rays_o = np.broadcast_to(c2w[:<span class="hljs-number">3</span>,-<span class="hljs-number">1</span>], np.shape(rays_d))<br>    <span class="hljs-keyword">return</span> rays_o, rays_d<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">ndc_rays</span>(<span class="hljs-params">H, W, focal, near, rays_o, rays_d</span>):<br>    <span class="hljs-comment"># Shift ray origins to near plane</span><br>    t = -(near + rays_o[...,<span class="hljs-number">2</span>]) / rays_d[...,<span class="hljs-number">2</span>]<br>    rays_o = rays_o + t[...,<span class="hljs-literal">None</span>] * rays_d<br>    <br>    <span class="hljs-comment"># Projection</span><br>    o0 = -<span class="hljs-number">1.</span>/(W/(<span class="hljs-number">2.</span>*focal)) * rays_o[...,<span class="hljs-number">0</span>] / rays_o[...,<span class="hljs-number">2</span>]<br>    o1 = -<span class="hljs-number">1.</span>/(H/(<span class="hljs-number">2.</span>*focal)) * rays_o[...,<span class="hljs-number">1</span>] / rays_o[...,<span class="hljs-number">2</span>]<br>    o2 = <span class="hljs-number">1.</span> + <span class="hljs-number">2.</span> * near / rays_o[...,<span class="hljs-number">2</span>]<br><br>    d0 = -<span class="hljs-number">1.</span>/(W/(<span class="hljs-number">2.</span>*focal)) * (rays_d[...,<span class="hljs-number">0</span>]/rays_d[...,<span class="hljs-number">2</span>] - rays_o[...,<span class="hljs-number">0</span>]/rays_o[...,<span class="hljs-number">2</span>])<br>    d1 = -<span class="hljs-number">1.</span>/(H/(<span class="hljs-number">2.</span>*focal)) * (rays_d[...,<span class="hljs-number">1</span>]/rays_d[...,<span class="hljs-number">2</span>] - rays_o[...,<span class="hljs-number">1</span>]/rays_o[...,<span class="hljs-number">2</span>])<br>    d2 = -<span class="hljs-number">2.</span> * near / rays_o[...,<span class="hljs-number">2</span>]<br>    <br>    rays_o = torch.stack([o0,o1,o2], -<span class="hljs-number">1</span>)<br>    rays_d = torch.stack([d0,d1,d2], -<span class="hljs-number">1</span>)<br>    <br>    <span class="hljs-keyword">return</span> rays_o, rays_d<br></code></pre></td></tr></table></figure><h2 id="Render-Rays"><a href="#Render-Rays" class="headerlink" title="Render Rays"></a>Render Rays</h2><p>NeRFä¸­è¿˜æœ‰ä¸€ä¸ªå…³é”®å°±æ˜¯å¯¹æ¯ä¸ªpixeläº§ç”Ÿçš„å…‰çº¿æ¸²æŸ“å‡ºæœ€åçš„RGBå’Œdensityã€‚åœ¨<code>render_ray</code>å‡½æ•°ä¸­ï¼Œä»å‘å°„åŸç‚¹å‡ºå‘ï¼Œå¯¹äºç»™å®šçš„æ–¹å‘è¿›è¡Œé‡‡æ ·ï¼Œè¿™æ ·å°±èƒ½å¤Ÿå¯¹æ¯ä¸€ä¸ªpixelå¯¹åº”çš„æœ‰é™é•¿å…‰çº¿(å¯¹äºè¿™ä¸ªvolumeæ¥è¯´æœ‰æœ€è¿‘è·ç¦»å’Œæœ€è¿œè·ç¦»)è¿›è¡Œé‡‡æ ·ã€‚é‡‡æ ·åˆ°çš„ç‚¹ç»è¿‡NeRFå®šä¹‰çš„MLPå°±èƒ½å¤Ÿè·å¾—å¯¹åº”çš„RGBå’Œdensityï¼Œå¯¹æ‰€æœ‰é‡‡æ ·ç‚¹çš„å€¼è¿›è¡Œç´¯åŠ å³ä¸ºåœ¨å½“å‰ä½å§¿ä¸‹ï¼Œè¿™ä¸ªpixelå¯¹åº”å…‰çº¿åˆ©ç”¨NeRFçš„MLPæ¸²æŸ“å‡ºæ¥çš„ç»“æœã€‚è¿™ä¸ªè¿‡ç¨‹æ¯ä¸ªç‚¹ä»ç„¶æ˜¯å¯å¾®çš„ï¼Œå› æ­¤æ•´ä¸ªç½‘ç»œå¯ä»¥ç”¨è¾“å…¥çš„å›¾ç‰‡å¯¹åº”çš„RGBæ¥è¿›è¡Œçº¦æŸå’Œbpå›ä¼ æ›´æ–°ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">render_rays</span>(<span class="hljs-params">ray_batch,</span><br><span class="hljs-params">                network_fn,</span><br><span class="hljs-params">                network_query_fn,</span><br><span class="hljs-params">                N_samples,</span><br><span class="hljs-params">                retraw=<span class="hljs-literal">False</span>,</span><br><span class="hljs-params">                lindisp=<span class="hljs-literal">False</span>,</span><br><span class="hljs-params">                perturb=<span class="hljs-number">0.</span>,</span><br><span class="hljs-params">                N_importance=<span class="hljs-number">0</span>,</span><br><span class="hljs-params">                network_fine=<span class="hljs-literal">None</span>,</span><br><span class="hljs-params">                white_bkgd=<span class="hljs-literal">False</span>,</span><br><span class="hljs-params">                raw_noise_std=<span class="hljs-number">0.</span>,</span><br><span class="hljs-params">                verbose=<span class="hljs-literal">False</span>,</span><br><span class="hljs-params">                pytest=<span class="hljs-literal">False</span></span>):<br>    <span class="hljs-string">&quot;&quot;&quot;Volumetric rendering.</span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">      ray_batch: array of shape [batch_size, ...]. All information necessary</span><br><span class="hljs-string">        for sampling along a ray, including: ray origin, ray direction, min</span><br><span class="hljs-string">        dist, max dist, and unit-magnitude viewing direction.</span><br><span class="hljs-string">      network_fn: function. Model for predicting RGB and density at each point</span><br><span class="hljs-string">        in space.</span><br><span class="hljs-string">      network_query_fn: function used for passing queries to network_fn.</span><br><span class="hljs-string">      N_samples: int. Number of different times to sample along each ray.</span><br><span class="hljs-string">      retraw: bool. If True, include model&#x27;s raw, unprocessed predictions.</span><br><span class="hljs-string">      lindisp: bool. If True, sample linearly in inverse depth rather than in depth.</span><br><span class="hljs-string">      perturb: float, 0 or 1. If non-zero, each ray is sampled at stratified</span><br><span class="hljs-string">        random points in time.</span><br><span class="hljs-string">      N_importance: int. Number of additional times to sample along each ray.</span><br><span class="hljs-string">        These samples are only passed to network_fine.</span><br><span class="hljs-string">      network_fine: &quot;fine&quot; network with same spec as network_fn.</span><br><span class="hljs-string">      white_bkgd: bool. If True, assume a white background.</span><br><span class="hljs-string">      raw_noise_std: ...</span><br><span class="hljs-string">      verbose: bool. If True, print more debugging info.</span><br><span class="hljs-string">    Returns:</span><br><span class="hljs-string">      rgb_map: [num_rays, 3]. Estimated RGB color of a ray. Comes from fine model.</span><br><span class="hljs-string">      disp_map: [num_rays]. Disparity map. 1 / depth.</span><br><span class="hljs-string">      acc_map: [num_rays]. Accumulated opacity along each ray. Comes from fine model.</span><br><span class="hljs-string">      raw: [num_rays, num_samples, 4]. Raw predictions from model.</span><br><span class="hljs-string">      rgb0: See rgb_map. Output for coarse model.</span><br><span class="hljs-string">      disp0: See disp_map. Output for coarse model.</span><br><span class="hljs-string">      acc0: See acc_map. Output for coarse model.</span><br><span class="hljs-string">      z_std: [num_rays]. Standard deviation of distances along ray for each</span><br><span class="hljs-string">        sample.</span><br><span class="hljs-string">    &quot;&quot;&quot;</span><br>    N_rays = ray_batch.shape[<span class="hljs-number">0</span>]<br>    rays_o, rays_d = ray_batch[:,<span class="hljs-number">0</span>:<span class="hljs-number">3</span>], ray_batch[:,<span class="hljs-number">3</span>:<span class="hljs-number">6</span>] <span class="hljs-comment"># [N_rays, 3] each</span><br>    viewdirs = ray_batch[:,-<span class="hljs-number">3</span>:] <span class="hljs-keyword">if</span> ray_batch.shape[-<span class="hljs-number">1</span>] &gt; <span class="hljs-number">8</span> <span class="hljs-keyword">else</span> <span class="hljs-literal">None</span><br>    bounds = torch.reshape(ray_batch[...,<span class="hljs-number">6</span>:<span class="hljs-number">8</span>], [-<span class="hljs-number">1</span>,<span class="hljs-number">1</span>,<span class="hljs-number">2</span>])<br>    near, far = bounds[...,<span class="hljs-number">0</span>], bounds[...,<span class="hljs-number">1</span>] <span class="hljs-comment"># [-1,1]</span><br><br>    t_vals = torch.linspace(<span class="hljs-number">0.</span>, <span class="hljs-number">1.</span>, steps=N_samples)<br>    <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> lindisp:<br>        z_vals = near * (<span class="hljs-number">1.</span>-t_vals) + far * (t_vals)<br>    <span class="hljs-keyword">else</span>:<br>        z_vals = <span class="hljs-number">1.</span>/(<span class="hljs-number">1.</span>/near * (<span class="hljs-number">1.</span>-t_vals) + <span class="hljs-number">1.</span>/far * (t_vals))<br><br>    z_vals = z_vals.expand([N_rays, N_samples])<br><br>    <span class="hljs-keyword">if</span> perturb &gt; <span class="hljs-number">0.</span>:<br>        <span class="hljs-comment"># get intervals between samples</span><br>        mids = <span class="hljs-number">.5</span> * (z_vals[...,<span class="hljs-number">1</span>:] + z_vals[...,:-<span class="hljs-number">1</span>])<br>        upper = torch.cat([mids, z_vals[...,-<span class="hljs-number">1</span>:]], -<span class="hljs-number">1</span>)<br>        lower = torch.cat([z_vals[...,:<span class="hljs-number">1</span>], mids], -<span class="hljs-number">1</span>)<br>        <span class="hljs-comment"># stratified samples in those intervals</span><br>        t_rand = torch.rand(z_vals.shape)<br><br>        <span class="hljs-comment"># Pytest, overwrite u with numpy&#x27;s fixed random numbers</span><br>        <span class="hljs-keyword">if</span> pytest:<br>            np.random.seed(<span class="hljs-number">0</span>)<br>            t_rand = np.random.rand(*<span class="hljs-built_in">list</span>(z_vals.shape))<br>            t_rand = torch.Tensor(t_rand)<br><br>        z_vals = lower + (upper - lower) * t_rand<br><br>    pts = rays_o[...,<span class="hljs-literal">None</span>,:] + rays_d[...,<span class="hljs-literal">None</span>,:] * z_vals[...,:,<span class="hljs-literal">None</span>] <span class="hljs-comment"># [N_rays, N_samples, 3]</span><br><br><br><span class="hljs-comment">#     raw = run_network(pts)</span><br>    raw = network_query_fn(pts, viewdirs, network_fn)<br>    rgb_map, disp_map, acc_map, weights, depth_map = raw2outputs(raw, z_vals, rays_d, raw_noise_std, white_bkgd, pytest=pytest)<br><br>    <span class="hljs-keyword">if</span> N_importance &gt; <span class="hljs-number">0</span>:<br><br>        rgb_map_0, disp_map_0, acc_map_0 = rgb_map, disp_map, acc_map<br><br>        z_vals_mid = <span class="hljs-number">.5</span> * (z_vals[...,<span class="hljs-number">1</span>:] + z_vals[...,:-<span class="hljs-number">1</span>])<br>        z_samples = sample_pdf(z_vals_mid, weights[...,<span class="hljs-number">1</span>:-<span class="hljs-number">1</span>], N_importance, det=(perturb==<span class="hljs-number">0.</span>), pytest=pytest)<br>        z_samples = z_samples.detach()<br><br>        z_vals, _ = torch.sort(torch.cat([z_vals, z_samples], -<span class="hljs-number">1</span>), -<span class="hljs-number">1</span>)<br>        pts = rays_o[...,<span class="hljs-literal">None</span>,:] + rays_d[...,<span class="hljs-literal">None</span>,:] * z_vals[...,:,<span class="hljs-literal">None</span>] <span class="hljs-comment"># [N_rays, N_samples + N_importance, 3]</span><br><br>        run_fn = network_fn <span class="hljs-keyword">if</span> network_fine <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span> <span class="hljs-keyword">else</span> network_fine<br><span class="hljs-comment">#         raw = run_network(pts, fn=run_fn)</span><br>        raw = network_query_fn(pts, viewdirs, run_fn)<br><br>        rgb_map, disp_map, acc_map, weights, depth_map = raw2outputs(raw, z_vals, rays_d, raw_noise_std, white_bkgd, pytest=pytest)<br><br>    ret = &#123;<span class="hljs-string">&#x27;rgb_map&#x27;</span> : rgb_map, <span class="hljs-string">&#x27;disp_map&#x27;</span> : disp_map, <span class="hljs-string">&#x27;acc_map&#x27;</span> : acc_map&#125;<br>    <span class="hljs-keyword">if</span> retraw:<br>        ret[<span class="hljs-string">&#x27;raw&#x27;</span>] = raw<br>    <span class="hljs-keyword">if</span> N_importance &gt; <span class="hljs-number">0</span>:<br>        ret[<span class="hljs-string">&#x27;rgb0&#x27;</span>] = rgb_map_0<br>        ret[<span class="hljs-string">&#x27;disp0&#x27;</span>] = disp_map_0<br>        ret[<span class="hljs-string">&#x27;acc0&#x27;</span>] = acc_map_0<br>        ret[<span class="hljs-string">&#x27;z_std&#x27;</span>] = torch.std(z_samples, dim=-<span class="hljs-number">1</span>, unbiased=<span class="hljs-literal">False</span>)  <span class="hljs-comment"># [N_rays]</span><br><br>    <span class="hljs-keyword">for</span> k <span class="hljs-keyword">in</span> ret:<br>        <span class="hljs-keyword">if</span> (torch.isnan(ret[k]).<span class="hljs-built_in">any</span>() <span class="hljs-keyword">or</span> torch.isinf(ret[k]).<span class="hljs-built_in">any</span>()) <span class="hljs-keyword">and</span> DEBUG:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;! [Numerical Error] <span class="hljs-subst">&#123;k&#125;</span> contains nan or inf.&quot;</span>)<br><br>    <span class="hljs-keyword">return</span> <br></code></pre></td></tr></table></figure><p>ä¸ªäººè®¤ä¸ºæœ€å…³é”®çš„ç‚¹å°±æ˜¯ä¸Šè¿°è¿™äº›ï¼Œå…¶ä»–çš„ç›¸å¯¹è¿™å‡ é¡¹è€Œè¨€å°±æ›´å®¹æ˜“é˜…è¯»äº†ã€‚</p><h1 id="åè®°"><a href="#åè®°" class="headerlink" title="åè®°"></a>åè®°</h1><p>NeRFå‡ºç°åè¶Šæ¥è¶Šå¤šçš„ç ”ç©¶è€…å¼€å§‹å…³æ³¨è¿™æ–¹é¢çš„å·¥ä½œã€‚å¯¹äºNeRFçš„è®­ç»ƒä¸ªäººè®¤ä¸ºé™¤äº†éœ€è¦å¥½çš„æ‹æ‘„å›¾ç‰‡ç»„å¤–ï¼Œå¯¹äºæ¯ä¸€æ¡rayçš„é‡‡æ ·ä¹Ÿæ˜¯å¾ˆå…³é”®çš„ã€‚ç”±äºNeRFæ˜¯å°†ä¿¡æ¯å­˜å‚¨åœ¨MLPä¸­ï¼Œå› æ­¤å®ƒéœ€è¦åœ¨ä¸åŒåœºæ™¯éƒ½é‡æ–°è®­ç»ƒï¼Œå°†ä¿¡æ¯ç¼–ç è¿›å»ã€‚</p><br /><p>ç°åœ¨ä¹Ÿæœ‰å¾ˆå¤šçš„ç ”ç©¶æ˜¯å…³äºå¿«é€Ÿè®­ç»ƒNeRFï¼Œä»¥åŠå¯é©±åŠ¨çš„NeRFæ¥è®©å…¶æœ‰æ›´å¥½çš„å®é™…åº”ç”¨ï¼Œè¿™äº›ä¼šå¯¹NeRFçš„å®ç”¨ä»·å€¼æœ‰è¿›ä¸€æ­¥çš„æé«˜ï¼ŒæœŸå¾…ç›¸å…³ç ”ç©¶çš„å‘å±•ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://arxiv.org/pdf/2003.08934.pdf">NeRF: Representing Scenes as Neural Radiance Fields for View Synthesis</a></p><p><a href="https://github.com/yenchenlin/nerf-pytorch">NeRF-PyTorch</a></p><p><a href="https://www.scratchapixel.com/lessons/3d-basic-rendering/ray-tracing-generating-camera-rays/generating-camera-rays">Ray-Tracing: Generating Camera Rays</a></p>]]></content>
    
    
    <categories>
      
      <category>code reading</category>
      
    </categories>
    
    
    <tags>
      
      <tag>NeRF</tag>
      
      <tag>code reading</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDA Memory Copy</title>
    <link href="/2022/06/25/cudamemcpy/"/>
    <url>/2022/06/25/cudamemcpy/</url>
    
    <content type="html"><![CDATA[<h1 id="CUDA-memcpy"><a href="#CUDA-memcpy" class="headerlink" title="CUDA memcpy"></a>CUDA memcpy</h1><blockquote><p>CUDA Memory Copy</p></blockquote><h1 id="CUDAå†…å­˜æ‹·è´"><a href="#CUDAå†…å­˜æ‹·è´" class="headerlink" title="CUDAå†…å­˜æ‹·è´"></a>CUDAå†…å­˜æ‹·è´</h1><p>åœ¨CUDAç¨‹åºçš„å†…å­˜æ•°æ®æ‹·è´ä¸­åŒ…å«ä»¥ä¸‹å‡ ç§æƒ…å†µï¼šHost2Deviceã€Device2Hostå’ŒDevice2Deviceï¼ˆHost2Hostå³æ­£å¸¸ç¨‹åºä¸­çš„copyï¼‰ã€‚åœ¨åˆšå¼€å§‹ç¼–å†™CUDAç¨‹åºæ—¶å¯¹cudaArrayå’Œå…¶ä»–DeviceArrayçš„copyå­˜åœ¨è¾ƒå¤§çš„ç–‘æƒ‘ï¼Œåœ¨æ­¤å¯¹CUDA memcpyè¿›è¡Œä¸€ä¸ªå°½é‡è¯¦ç»†çš„è®°å½•ã€‚</p><h1 id="cudaArrayä»¥åŠç»‘å®šçº¹ç†å¯¹è±¡ã€è¡¨é¢å¯¹è±¡çš„æ‹·è´"><a href="#cudaArrayä»¥åŠç»‘å®šçº¹ç†å¯¹è±¡ã€è¡¨é¢å¯¹è±¡çš„æ‹·è´" class="headerlink" title="cudaArrayä»¥åŠç»‘å®šçº¹ç†å¯¹è±¡ã€è¡¨é¢å¯¹è±¡çš„æ‹·è´"></a>cudaArrayä»¥åŠç»‘å®šçº¹ç†å¯¹è±¡ã€è¡¨é¢å¯¹è±¡çš„æ‹·è´</h1><p>ä»¥2Då›¾åƒæ•°ç»„ä¸ºä¾‹è¿›è¡Œè¯´æ˜ã€‚</p><h2 id="Host2Device"><a href="#Host2Device" class="headerlink" title="Host2Device"></a>Host2Device</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">cudaMemcpy2DToArray</span>(<br>cudaArray_t dst,<br><span class="hljs-type">size_t</span> wOffset,<br><span class="hljs-type">size_t</span> hOffset,<br><span class="hljs-type">const</span> <span class="hljs-type">void</span>* src,<br><span class="hljs-type">size_t</span> spitch,<br><span class="hljs-type">size_t</span> width,<br><span class="hljs-type">size_t</span> height,<br>cudaMemcpyKind kind<br>);<br><span class="hljs-built_in">cudaMemcpy2DToArray</span>(<br>_cuda_array, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>_host.data,<br>_host.cols * _host.<span class="hljs-built_in">elemSize</span>(),<br>_host_cols * _host.<span class="hljs-built_in">elemSize</span>(),<br>_host.rows,<br>cudaMemcpyHostToDevice<br>);<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨å‡½æ•°<code>cudaMallocPitch</code>å’Œ<code>cudaMemcpy2D</code>æ¥ä½¿ç”¨äºŒç»´æ•°ç»„ã€‚C&#x2F;C++ä¸­äºŒç»´æ•°ç»„å†…å­˜åˆ†é…æ˜¯è½¬åŒ–ä¸ºä¸€ç»´æ•°ç»„ï¼Œè¿è´¯ç´§å‡‘ï¼Œæ¯æ¬¡è®¿é—®æ•°ç»„ä¸­çš„å…ƒç´ éƒ½å¿…é¡»ä»æ•°ç»„é¦–å…ƒç´ å¼€å§‹éå†ï¼›è€ŒCUDAä¸­åˆ†é…çš„äºŒç»´æ•°ç»„å†…å­˜ä¿è¯æ•°ç»„æ¯ä¸€è¡Œé¦–å…ƒç´ çš„åœ°å€å€¼éƒ½æŒ‰ç…§ 256 æˆ– 512 çš„å€æ•°å¯¹é½ï¼Œæé«˜è®¿é—®æ•ˆç‡ï¼Œä½†ä½¿å¾—æ¯è¡Œæœ«å°¾å…ƒç´ ä¸ä¸‹ä¸€è¡Œé¦–å…ƒç´ åœ°å€å¯èƒ½ä¸è¿è´¯ï¼Œä½¿ç”¨æŒ‡é’ˆå¯»å€æ—¶è¦æ³¨æ„è€ƒè™‘å°¾éƒ¨ã€‚</p><p><code>cudaMallocPitch</code>ä¼ å…¥å­˜å‚¨å™¨æŒ‡é’ˆ<code>**devPtr</code>ï¼Œåç§»å€¼çš„æŒ‡é’ˆ<code>*pitch</code>ï¼Œæ•°ç»„è¡Œå­—èŠ‚æ•°<code>widthByte</code>ï¼Œæ•°ç»„è¡Œæ•°<code>height</code>ã€‚å‡½æ•°è¿”å›åæŒ‡é’ˆæŒ‡å‘åˆ†é…çš„å†…å­˜ï¼ˆæ¯è¡Œåœ°å€å¯¹é½åˆ° AlignByte å­—èŠ‚ï¼Œä¸º 256B æˆ– 512Bï¼‰ï¼Œåç§»å€¼æŒ‡é’ˆæŒ‡å‘çš„å€¼ä¸ºè¯¥è¡Œå®é™…å­—èŠ‚æ•°&#x3D;sizeof(datatype) * width + alignByte - 1) &#x2F; alignByteï¼‰ã€‚</p><p><code>cudaMemcpy2D</code>ä¼ å…¥ç›®æ ‡å­˜å‚¨å™¨çš„æŒ‡é’ˆ<code>*dst</code>ï¼Œç›®æ ‡å­˜å‚¨å™¨è¡Œå­—èŠ‚æ•°<code>dpitch</code>ï¼Œæºå­˜å‚¨å™¨æŒ‡é’ˆ<code>*src</code>ï¼Œæºå­˜å‚¨å™¨è¡Œå­—èŠ‚æ•°<code>spitch</code>ï¼Œæ•°ç»„è¡Œå­—èŠ‚æ•°<code>widthByte</code>ï¼Œæ•°ç»„è¡Œæ•°<code>height</code>ï¼Œæ‹·è´æ–¹å‘ <code>kind</code>ã€‚è¿™é‡Œè¦æ±‚å­˜å‚¨å™¨è¡Œå­—èŠ‚æ•°ä¸å°äºæ•°ç»„è¡Œå­—èŠ‚æ•°ï¼Œå¤šå‡ºæ¥çš„éƒ¨åˆ†å°±æ˜¯æ¯è¡Œå°¾éƒ¨ç©ºç™½éƒ¨åˆ†ã€‚</p><p>æˆ‘ä»¬åœ¨ä½¿ç”¨<code>cudaMemcpy2DToArray</code>æ—¶ï¼Œç¬¬ä¸€ä¸ªå­˜æ”¾çš„ä¸º<code>cudaArray_t</code>çš„å‚æ•°ï¼Œä¸ªäººç†è§£ä¸ºæŒ‡å‘GPUä¸­æŸä¸€ä¸ªå†…å­˜åœ°å€çš„æŒ‡é’ˆï¼Œä½†é‡‡ç”¨<code>cudaArray_t</code>çš„æ ¼å¼å¯¹å…¶è¿›è¡Œå°è£…ã€‚åœ¨åˆ©ç”¨<code>cv::Mat</code>å¯¹äºŒç»´å›¾åƒè¿›è¡Œhoståˆ°deviceçš„æ‹·è´æ—¶ï¼Œä¸€èˆ¬pitchçš„å¤§å°å’Œè¡Œå­—èŠ‚æ•°ç›¸ç­‰ã€‚</p><p>å¯¹pitchçš„ç†è§£ï¼Œä¸ªäººè®¤ä¸ºå’ŒC++ä¸­çš„å†…å­˜å¯¹é½ç±»ä¼¼ï¼Œæé«˜äº†è¯»å†™é€Ÿç‡ã€‚</p><h2 id="Device2Host"><a href="#Device2Host" class="headerlink" title="Device2Host"></a>Device2Host</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-built_in">cudaMemcpy2DFromArray</span>(<br><span class="hljs-type">void</span>* dst,<br><span class="hljs-type">size_t</span> dpitch,<br>cudaArray_const_t src,<br><span class="hljs-type">size_t</span> wOffset,<br><span class="hljs-type">size_t</span> hOffset,<br><span class="hljs-type">size_t</span> width,<br><span class="hljs-type">size_t</span> height,<br>cudaMemcpyKind kind<br>);<br><span class="hljs-built_in">cudaMemcpy2DFromArray</span>(<br>_host.data,<br>_host.cols * _host.<span class="hljs-built_in">elemSize</span>(),<br>_cuda_array,<br><span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>_host.cols * _host.<span class="hljs-built_in">elemSize</span>(),<br>_host.rows,<br>cudaMemcpyDeviceToHost<br>);<br></code></pre></td></tr></table></figure><p>Deviceåˆ°Hostæ‹·è´å’ŒHostæ‹·è´åˆ°DeviceåŸºæœ¬ä¸€è‡´ï¼Œä»…ä»…æ˜¯å‚æ•°ä¼ å…¥çš„ä½ç½®è¿›è¡Œäº†æ”¹å˜ã€‚</p><h2 id="Device2Device"><a href="#Device2Device" class="headerlink" title="Device2Device"></a>Device2Device</h2><p>ä¸€èˆ¬ä¹Ÿåˆ©ç”¨<code>cudaMemcpy2DToArray</code>çš„æ–¹å¼ï¼Œå°†hostçš„dataåœ°å€æ”¹æˆGPUä¸­æŒ‡å‘æŸä¸ªåˆ†é…çš„æ•°æ®å—æŒ‡é’ˆå³å¯ã€‚</p><h2 id="cudaTexture-t"><a href="#cudaTexture-t" class="headerlink" title="cudaTexture_t"></a>cudaTexture_t</h2><p>å½“æˆ‘ä»¬è·å–åˆ°<code>cudaTexture_t</code>çš„å¥æŸ„æ—¶ï¼Œä½†å¹¶ä¸èƒ½ç›´æ¥è·å¾—<code>cudaArray_t</code>çš„å¥æŸ„ï¼Œå¯ä»¥ä½¿ç”¨descçš„æ–¹å¼å¯¹<code>cudaArray_t</code>æ•°æ®è¿›è¡Œè·å–ã€‚</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs cpp">cudaResourceDesc desc;<br><span class="hljs-built_in">cudaGetTextureObjectResourceDesc</span>(&amp;desc, _cuda_texobj);<br><span class="hljs-built_in">cudaMemcpy2DFromArray</span>(<br>_host.data,<br>_host.cols * _host.<span class="hljs-built_in">elemSize</span>(),<br>desc.res.array.array,<br><span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>_host.cols * _host.<span class="hljs-built_in">elemSize</span>(),<br>_host.rows,<br>cudaMemcpyDeviceToHost<br>);<br></code></pre></td></tr></table></figure><p>ä½¿ç”¨è¿™ç§æ–¹å¼å°±èƒ½å¤Ÿä¸å»è·å–<code>cudaArray_t</code>çš„å¥æŸ„ï¼Œé€šè¿‡<code>cudaTextureObject_t</code>å°±å¯ä»¥ç›´æ¥è·å–åˆ°CUDAä¸Šå­˜å‚¨çš„æ•°ç»„å¹¶ä¸‹è½½åˆ°Hostä¸Šã€‚</p><h1 id="cudaArrayå’Œcudaå¯¹è±¡çš„æ‹·è´"><a href="#cudaArrayå’Œcudaå¯¹è±¡çš„æ‹·è´" class="headerlink" title="cudaArrayå’Œcudaå¯¹è±¡çš„æ‹·è´"></a>cudaArrayå’Œcudaå¯¹è±¡çš„æ‹·è´</h1><p><code>cudaArray_t</code>å’ŒCUDA mallocå¯¹è±¡ä¹‹é—´çš„æ‹·è´ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨<code>cudaMemcpy2DFromArray</code>ã€<code>cudaMemcpy2DToArray</code>çš„æ–¹å¼æ¥å®ç°ï¼ŒåŒæ ·åœ¨ç¼–å†™å¥½å¯¹åº”æŒ‡é’ˆåœ°å€ã€pitchå¤§å°ç­‰å‚æ•°åï¼Œåˆ©ç”¨<code>cudaMemcpyDeviceToDevice</code>è¿›è¡Œæ‹·è´ã€‚</p><p>é€šå¸¸ï¼Œæ‹·è´é‡‡ç”¨Asyncçš„å¼‚æ­¥æ‹·è´æ–¹å¼è¿›è¡Œï¼Œå¹¶é‡‡ç”¨<code>cudaStreamSynchronize</code>çš„æ–¹å¼å®ŒæˆåŒæ­¥ã€‚è¿™æ˜¯å› ä¸ºCUDAæŒ‡ä»¤åŸºæœ¬éƒ½æ˜¯å¼‚æ­¥è¿›è¡Œï¼Œç¨‹åºä¸ä¼šç­‰å¾…CUDAè°ƒç”¨ç»“æŸå†è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ä½†æ‹·è´çš„æŒ‡ä»¤è‹¥ä¸å®ç”¨Asyncå¼‚æ­¥æ–¹å¼åˆ™ä¼šè®©CPUè¿›è¡Œç­‰å¾…ï¼Œé€ æˆæœ€ç»ˆç¨‹åºæ—¶é•¿è¿‡å¤§ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://nichijou.co/cudaRandom-memAlign/">Memory Alignment For CUDA - Fangâ€™s Notebook</a></p>]]></content>
    
    
    <categories>
      
      <category>CUDA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>OpenGLæ¸²æŸ“æµç¨‹</title>
    <link href="/2022/06/25/OpenGL%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B/"/>
    <url>/2022/06/25/OpenGL%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B/</url>
    
    <content type="html"><![CDATA[<h1 id="OpenGLæ¸²æŸ“æµç¨‹"><a href="#OpenGLæ¸²æŸ“æµç¨‹" class="headerlink" title="OpenGLæ¸²æŸ“æµç¨‹"></a>OpenGLæ¸²æŸ“æµç¨‹</h1><blockquote><p>OpenGLï¼ŒOpen Graphics Library</p></blockquote><h1 id="æ¸²æŸ“ç®¡çº¿"><a href="#æ¸²æŸ“ç®¡çº¿" class="headerlink" title="æ¸²æŸ“ç®¡çº¿"></a>æ¸²æŸ“ç®¡çº¿</h1><p>åœ¨OpenGLä¸­ï¼Œä»»ä½•äº‹ç‰©éƒ½å¤„äº3Dç©ºé—´ä¸­ï¼Œè€Œå±å¹•å’Œçª—å£å´éƒ½æ˜¯2Dåƒç´ æ•°ç»„ï¼Œè¿™å°±å¯¼è‡´äº†OpenGLå¤§éƒ¨åˆ†å·¥ä½œéƒ½æ˜¯å…³äºæŠŠ3Dåæ ‡è½¬å˜ä¸ºé€‚é…ä½ å±å¹•çš„2Dåƒç´ ã€‚</p><p>æ¸²æŸ“ç®¡çº¿ï¼ŒæŒ‡çš„æ˜¯ä¸€å †åŸå§‹å›¾å½¢æ•°æ®é€”ç»ä¸€ä¸ªè¾“é€ç®¡é“ï¼ŒæœŸé—´ç»è¿‡å„ç§å˜åŒ–å¤„ç†æœ€ç»ˆå‡ºç°åœ¨å±å¹•çš„è¿‡ç¨‹ã€‚å›¾å½¢æ¸²æŸ“ç®¡çº¿ï¼ˆ3Dåæ ‡â†’2Dåæ ‡ï¼‰ä¸»è¦å¯åˆ’åˆ†ä¸ºï¼šæŠŠ3Dåæ ‡è½¬æ¢ä¸º2Dåæ ‡å’ŒæŠŠ2Dåæ ‡è½¬å˜ä¸ºå®é™…çš„æœ‰é¢œè‰²çš„åƒç´ ä¸¤ä¸ªéƒ¨åˆ†ã€‚</p><p>3Dåæ ‡è½¬ä¸º2Dåæ ‡çš„å¤„ç†è¿‡ç¨‹æ˜¯ç”±OpenGLçš„å›¾å½¢æ¸²æŸ“ç®¡çº¿ç®¡ç†çš„ã€‚</p><h1 id="æ¸²æŸ“ç®¡çº¿å¤„ç†æµç¨‹"><a href="#æ¸²æŸ“ç®¡çº¿å¤„ç†æµç¨‹" class="headerlink" title="æ¸²æŸ“ç®¡çº¿å¤„ç†æµç¨‹"></a>æ¸²æŸ“ç®¡çº¿å¤„ç†æµç¨‹</h1><p>Vertex Data â†’ Vertex Shader â†’ Shape Assembly â†’ Geometry Shader â†’ Rasterization â†’ Fragment Shader â†’ Blending</p><p>ç°è‰²ä¸ºç»‘å®šæµç¨‹ï¼Œä¸éœ€è¦è‡ªå®šä¹‰ç¼–å†™ä»£ç ã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œé€šè¿‡å¯¹shaderçš„ç¼–å†™ï¼ˆVertex Shaderï¼Œ.vsï¼›Geometry Shaderï¼Œ.gsï¼›Fragment Shaderï¼Œ.fsï¼‰æ¥å®Œæˆç›¸åº”çš„æ•ˆæœå‘ˆç°ã€‚</p><p>é¦–å…ˆï¼Œä»¥æ•°ç»„çš„å½¢å¼ä¼ é€’3ä¸ª3Dåæ ‡ä½œä¸ºå›¾å½¢æ¸²æŸ“ç®¡çº¿çš„è¾“å…¥ï¼Œç”¨æ¥è¡¨ç¤ºä¸€ä¸ªä¸‰è§’å½¢ï¼Œè¿™ä¸ªæ•°ç»„å«åšé¡¶ç‚¹æ•°æ®ï¼ˆVertex Dataï¼‰ã€‚é¡¶ç‚¹æ•°æ®æ˜¯ä¸€ç³»åˆ—é¡¶ç‚¹çš„é›†åˆã€‚ä¸€ä¸ªé¡¶ç‚¹ï¼ˆVertexï¼‰æ˜¯ä¸€ä¸ª3Dåæ ‡çš„æ•°æ®çš„é›†åˆã€‚è€Œé¡¶ç‚¹æ•°æ®æ˜¯ç”¨é¡¶ç‚¹å±æ€§ï¼ˆVertex Attributeï¼‰è¡¨ç¤ºçš„ï¼Œå®ƒå¯ä»¥åŒ…å«ä»»ä½•æˆ‘ä»¬æƒ³ç”¨çš„æ•°æ®ã€‚</p><aside>ğŸ’¡ OpenGLåœ¨å¯¹åæ ‡å’Œé¢œè‰²æ„æˆè¿›è¡Œåˆ†ææ¸²æŸ“æ—¶å€™ï¼Œéœ€è¦äººä¸ºæŒ‡å®šæ•°æ®æ‰€è¡¨ç¤ºçš„æ¸²æŸ“ç±»å‹ï¼Œå¦‚ç‚¹ï¼ˆGL_POINTSï¼‰ã€çº¿ï¼ˆGL_LINE_STRIPï¼‰ã€ä¸‰è§’ï¼ˆGL_TRIANGLESï¼‰ç­‰ã€‚åšå‡ºçš„è¿™äº›æç¤ºå«åšå›¾å…ƒï¼ˆPrimitiveï¼‰ï¼Œä»»ä½•ä¸€ä¸ªç»˜åˆ¶æŒ‡ä»¤çš„è°ƒç”¨éƒ½å°†æŠŠå›¾å…ƒä¼ é€’ç»™OpenGLã€‚</aside><p>å›¾å½¢æ¸²æŸ“ç®¡çº¿çš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†æ˜¯é¡¶ç‚¹ç€è‰²å™¨ï¼ˆVertex Shaderï¼‰ï¼Œå®ƒæŠŠä¸€ä¸ªå•ç‹¬çš„é¡¶ç‚¹ä½œä¸ºè¾“å…¥ã€‚é¡¶ç‚¹ç€è‰²å™¨ä¸»è¦çš„ç›®çš„æ˜¯æŠŠ3Dåæ ‡è½¬ä¸ºå¦ä¸€ç§3Dåæ ‡ï¼ŒåŒæ—¶é¡¶ç‚¹ç€è‰²å™¨å…è®¸æˆ‘ä»¬å¯¹é¡¶ç‚¹å±æ€§è¿›è¡Œä¸€äº›åŸºæœ¬å¤„ç†ã€‚</p><p>å›¾å…ƒè£…é…ï¼ˆPrimitive Assemblyï¼‰é˜¶æ®µå°†é¡¶ç‚¹ç€è‰²å™¨è¾“å‡ºçš„æ‰€æœ‰é¡¶ç‚¹ä½œä¸ºè¾“å…¥ï¼ˆå¦‚æœæ˜¯GL_POINTSï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªé¡¶ç‚¹ï¼‰ï¼Œå¹¶æ‰€æœ‰çš„ç‚¹è£…é…æˆæŒ‡å®šå›¾å…ƒçš„å½¢çŠ¶ã€‚</p><p>å›¾å…ƒè£…é…é˜¶æ®µçš„è¾“å‡ºä¼šä¼ é€’ç»™å‡ ä½•ç€è‰²å™¨ï¼ˆGeometry Shaderï¼‰ã€‚å‡ ä½•ç€è‰²å™¨æŠŠå›¾å…ƒå½¢å¼çš„ä¸€ç³»åˆ—é¡¶ç‚¹çš„é›†åˆä½œä¸ºè¾“å…¥ï¼Œå®ƒå¯ä»¥é€šè¿‡äº§ç”Ÿæ–°é¡¶ç‚¹æ„é€ å‡ºæ–°çš„å›¾å…ƒæ¥ç”Ÿæˆå…¶ä»–å½¢çŠ¶ã€‚</p><p>å‡ ä½•ç€è‰²å™¨çš„è¾“å‡ºä¼šè¿›è¡Œå…‰æ …åŒ–ï¼ˆRasterization Stageï¼‰ï¼Œè¿™é‡Œå®ƒä¼šæŠŠå›¾å…ƒæ˜ å°„ä¸ºæœ€ç»ˆå±å¹•ä¸Šç›¸åº”çš„åƒç´ ï¼Œç”Ÿæˆä¾›ç‰‡æ®µç€è‰²å™¨ï¼ˆFragment Shaderï¼‰ä½¿ç”¨çš„ç‰‡æ®µï¼ˆFragmentï¼‰ã€‚åœ¨ç‰‡æ®µç€è‰²å™¨è¿è¡Œä¹‹å‰ä¼šæ‰§è¡Œè£åˆ‡ï¼ˆClippingï¼‰ã€‚è£åˆ‡ä¼šä¸¢å¼ƒè¶…å‡ºè§†å›¾ä»¥å¤–çš„æ‰€æœ‰åƒç´ ï¼Œç”¨æ¥æå‡æ‰§è¡Œæ•ˆç‡ã€‚</p><aside>ğŸ’¡ OpenGLä¸­çš„ä¸€ä¸ªç‰‡æ®µæ˜¯OpenGLæ¸²æŸ“ä¸€ä¸ªåƒç´ æ‰€éœ€çš„æ‰€æœ‰æ•°æ®ã€‚</aside><p>Fragment Shaderçš„ä¸»è¦ç›®çš„æ˜¯è®¡ç®—ä¸€ä¸ªåƒç´ çš„æœ€ç»ˆé¢œè‰²ï¼Œè¿™ä¹Ÿæ˜¯æ‰€æœ‰OpenGLé«˜çº§æ•ˆæœäº§ç”Ÿçš„åœ°æ–¹ã€‚é€šå¸¸ï¼ŒFragment ShaderåŒ…å«3Dåœºæ™¯çš„æ•°æ®ï¼ˆå¦‚å…‰ç…§ã€é˜´å½±ã€å…‰çš„é¢œè‰²ç­‰ï¼‰ï¼Œè¿™äº›æ•°æ®å¯ä»¥è¢«ç”¨æ¥è®¡ç®—æœ€ç»ˆåƒç´ çš„é¢œè‰²ã€‚</p><p>åœ¨æ‰€æœ‰å¯¹åº”é¢œè‰²å€¼ç¡®å®šä»¥åï¼Œæœ€ç»ˆçš„å¯¹è±¡å°†ä¼šè¢«ä¼ åˆ°æœ€åä¸€ä¸ªé˜¶æ®µï¼Œæˆ‘ä»¬å«åšAlphaæµ‹è¯•å’Œæ··åˆï¼ˆBlendingï¼‰é˜¶æ®µã€‚è¿™ä¸ªé˜¶æ®µæ£€æµ‹ç‰‡æ®µçš„å¯¹åº”çš„æ·±åº¦ï¼ˆå’Œæ¨¡æ¿Stencilï¼‰å€¼ï¼Œç”¨å®ƒä»¬æ¥åˆ¤æ–­è¿™ä¸ªåƒç´ æ˜¯å…¶å®ƒç‰©ä½“çš„å‰é¢è¿˜æ˜¯åé¢ï¼Œå†³å®šæ˜¯å¦åº”è¯¥ä¸¢å¼ƒã€‚è¿™ä¸ªé˜¶æ®µä¹Ÿä¼šæ£€æŸ¥Aplhaå€¼ï¼ˆRGBAä¸­çš„Aï¼‰å¹¶å¯¹ç‰©ä½“è¿›è¡ŒBlendingã€‚æ‰€ä»¥ï¼Œå³ä½¿åœ¨ç‰‡æ®µç€è‰²å™¨ä¸­è®¡ç®—å‡ºæ¥äº†ä¸€ä¸ªåƒç´ è¾“å‡ºçš„é¢œè‰²ï¼Œåœ¨æ¸²æŸ“å¤šä¸ªä¸‰è§’å½¢çš„æ—¶å€™æœ€åçš„åƒç´ é¢œè‰²ä¹Ÿå¯èƒ½å®Œå…¨ä¸åŒã€‚</p><h1 id="OpenGLç¼–å†™éœ€è¦"><a href="#OpenGLç¼–å†™éœ€è¦" class="headerlink" title="OpenGLç¼–å†™éœ€è¦"></a>OpenGLç¼–å†™éœ€è¦</h1><p>OpenGL é¦–å…ˆæ¥æ”¶ç”¨æˆ·æä¾›çš„å‡ ä½•æ•°æ®ï¼ˆé¡¶ç‚¹å’Œå‡ ä½•å›¾å…ƒï¼‰ï¼Œå¹¶ä¸”å°†å®ƒè¾“å…¥åˆ°ä¸€ç³»åˆ—Shaderä¸­è¿›è¡Œå¤„ç†ï¼ŒåŒ…æ‹¬:é¡¶ç‚¹ç€è‰²ã€ç»†åˆ†ç€è‰²(å®ƒæœ¬èº«åŒ…å«ä¸¤ä¸ªç€è‰²å™¨)ï¼Œä»¥åŠæœ€åçš„å‡ ä½•ç€è‰²ï¼Œç„¶åå®ƒå°†è¢«é€å…¥Rasterizationã€‚Rasterizationè´Ÿè´£å¯¹æ‰€æœ‰å‰ªåˆ‡ï¼ˆClippingï¼‰å†…çš„å›¾å…ƒç”ŸæˆFragmentï¼Œç„¶åå¯¹æ¯ä¸ªç”Ÿæˆçš„ç‰‡å…ƒéƒ½æ‰§è¡Œä¸€ä¸ªFragment Shaderã€‚</p><ul><li>Shaderæ˜¯OpenGLä¸­æœ€é‡è¦çš„ç»„æˆï¼Œå¯ä»¥æ§åˆ¶ä½¿ç”¨ä¸åŒçš„Shaderæ¥å®ç°æ‰€éœ€çš„åŠŸèƒ½</li><li>åªæœ‰Vertex Shaderå’ŒFragment Shaderæ˜¯å¿…é¡»çš„ï¼Œç»†åˆ†å’ŒGeometry Shaderæ˜¯å¯é€‰çš„æ­¥éª¤</li></ul><h1 id="æ•°æ®ä¸æ•°æ®æµ"><a href="#æ•°æ®ä¸æ•°æ®æµ" class="headerlink" title="æ•°æ®ä¸æ•°æ®æµ"></a>æ•°æ®ä¸æ•°æ®æµ</h1><ul><li>VAOï¼ŒVertex Array Objectï¼Œå®šç‚¹æ•°ç»„å¯¹è±¡ï¼Œä¿å­˜ç¼“å­˜ä»¥åŠé¡¶ç‚¹å±æ€§çŠ¶æ€ä¿¡æ¯</li><li>VBOï¼ŒVertex Buffer Objectï¼Œå®šç‚¹ç¼“å­˜å¯¹è±¡ï¼Œç”¨äºåˆ†é…å†…å­˜ï¼Œä¿å­˜é¡¶ç‚¹æ•°æ®ç»™å›¾å½¢å¡ä½¿ç”¨çš„ä¸€ç§ç¼“å­˜å¯¹è±¡</li><li>EBO&#x2F;IBOï¼ŒElement Buffer Object&#x2F;Index Buffer Objectï¼Œä¿å­˜é¡¶ç‚¹ç´¢å¼•çš„ä¸€ç§ç¼“å­˜å¯¹è±¡</li></ul><p>åœ¨å®šä¹‰å¥½é¡¶ç‚¹æ•°æ®ä»¥åï¼Œéœ€è¦åœ¨å†…å­˜ä¸­å­˜å‚¨è¿™äº›é¡¶ç‚¹ï¼ŒVBOç®¡ç†è¿™ä¸ªå†…å­˜ï¼Œå®ƒä¼šåœ¨æ˜¾å­˜ä¸­å‚¨å­˜å¤§é‡é¡¶ç‚¹ã€‚ä½¿ç”¨è¿™äº›ç¼“å†²å¯¹è±¡çš„å¥½å¤„æ˜¯å¯ä»¥ä¸€æ¬¡æ€§çš„å‘é€ä¸€å¤§æ‰¹æ•°æ®åˆ°æ˜¾å¡ä¸Šï¼Œè€Œä¸æ˜¯æ¯ä¸ªé¡¶ç‚¹å‘é€ä¸€æ¬¡ã€‚ä»CPUæŠŠæ•°æ®å‘é€åˆ°æ˜¾å¡ç›¸å¯¹è¾ƒæ…¢ï¼Œæ‰€ä»¥åªè¦å¯èƒ½éƒ½è¦å°½é‡ä¸€æ¬¡æ€§å‘é€å°½å¯èƒ½å¤šçš„æ•°æ®ã€‚å½“æ•°æ®å‘é€è‡³æ˜¾å¡çš„å†…å­˜ä¸­åï¼Œé¡¶ç‚¹ç€è‰²å™¨å‡ ä¹èƒ½ç«‹å³è®¿é—®é¡¶ç‚¹ã€‚</p><h1 id="Vertex-Shader"><a href="#Vertex-Shader" class="headerlink" title="Vertex Shader"></a>Vertex Shader</h1><ul><li>é¡¶ç‚¹ç€è‰²å™¨å¯¹é¡¶ç‚¹å®ç°äº†ä¸€ç§é€šç”¨çš„å¯ç¼–ç¨‹æ–¹æ³•ï¼Œå®ƒä¸€èˆ¬ç”¨æ¥å¤„ç†å›¾å½¢æ¯ä¸ªé¡¶ç‚¹å˜æ¢ï¼ˆæ—‹è½¬&#x2F;å¹³ç§»&#x2F;æŠ•å½±ç­‰ï¼‰ï¼Œé¡¶ç‚¹ç€è‰²å™¨æ˜¯OpenGLä¸­ç”¨äºè®¡ç®—é¡¶ç‚¹å±æ€§çš„ç¨‹åº</li><li>æ¯ä¸ªé¡¶ç‚¹éƒ½ä¼šæ‰§è¡Œä¾æ¬¡é¡¶ç‚¹ç€è‰²å™¨ï¼Œæ‰§è¡Œé¡ºåºæ˜¯æŒ‰ç…§å­˜å‚¨åœ¨é¡¶ç‚¹æ•°ç»„çš„é¡ºåºä¾æ¬¡å¤„ç†ï¼ˆä¸€èˆ¬æ˜¯é€†æ—¶é’ˆï¼‰</li><li>è¾“å…¥æ•°æ®ç»„æˆ<ul><li>Attributesï¼Œä½¿ç”¨é¡¶ç‚¹æ•°ç»„å°è£…æ¯ä¸ªé¡¶ç‚¹çš„æ•°æ®ï¼Œä¸€èˆ¬ç”¨äºæ¯ä¸ªé¡¶ç‚¹éƒ½å„ä¸ç›¸åŒçš„å˜é‡ï¼Œå¦‚é¡¶ç‚¹ä½ç½®ã€é¢œè‰²ç­‰</li><li>Uniformsï¼Œé¡¶ç‚¹ç€è‰²å™¨ä½¿ç”¨çš„å¸¸é‡æ•°æ®ï¼Œä¸èƒ½è¢«ç€è‰²å™¨ä¿®æ”¹ï¼Œä¸€èˆ¬ç”¨äºå¯¹åŒä¸€ç»„é¡¶ç‚¹ç»„æˆçš„å•ä¸ª3Dç‰©ä½“ä¸­æ‰€æœ‰é¡¶ç‚¹éƒ½ç›¸åŒçš„å˜é‡ï¼Œå¦‚å½“å‰å…‰æºçš„ä½ç½®</li><li>Samplersï¼Œè¿™ä¸ªæ˜¯å¯é€‰çš„ï¼Œä¸€ç§ç‰¹æ®Šçš„Uniformsï¼Œè¡¨ç¤ºé¡¶ç‚¹ç€è‰²å™¨ä½¿ç”¨çš„çº¹ç†</li><li>Shader Programï¼Œé¡¶ç‚¹ç€è‰²å™¨çš„æºç æˆ–å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæè¿°äº†å°†å¯¹é¡¶ç‚¹æ‰§è¡Œçš„æ“ä½œã€‚</li></ul></li><li>è¾“å‡ºæ•°æ®ç»„æˆ<ul><li>é¡¶ç‚¹ç€è‰²å™¨çš„è¾“å‡ºæ•°æ®æ˜¯Varyingå˜é‡ï¼Œåœ¨å›¾å…ƒå…‰æ …åŒ–é˜¶æ®µï¼Œè¿™äº›Varyingå€¼ä¸ºæ¯ä¸ªç”Ÿæˆçš„ç‰‡å…ƒè¿›è¡Œè®¡ç®—ï¼Œå¹¶å°†ç»“æœä½œä¸ºç‰‡å…ƒç€è‰²å™¨çš„è¾“å…¥æ•°æ®ã€‚ä»åˆ†é…ç»™æ¯ä¸ªé¡¶ç‚¹çš„åŸå§‹Varyingå€¼æ¥ä¸ºæ¯ä¸ªç‰‡å…ƒç”Ÿæˆä¸€ä¸ªVaryingå€¼çš„æœºåˆ¶ä¸ºæ’å€¼</li></ul></li></ul><h1 id="Rasterization"><a href="#Rasterization" class="headerlink" title="Rasterization"></a>Rasterization</h1><ul><li>å…‰æ …åŒ–ï¼ˆRasterizationï¼‰æ˜¯æŠŠé¡¶ç‚¹æ•°æ®è½¬æ¢ä¸ºç‰‡å…ƒçš„è¿‡ç¨‹ï¼Œå…·æœ‰å°†å›¾è½¬åŒ–ä¸ºä¸€ä¸ªä¸ªæ …æ ¼ç»„æˆçš„å›¾è±¡çš„ä½œç”¨ï¼Œç‰¹ç‚¹æ˜¯æ¯ä¸ªå…ƒç´ å¯¹åº”å¸§ç¼“å†²åŒºä¸­çš„ä¸€åƒç´ </li><li>å…‰æ …åŒ–å…¶å®æ˜¯ä¸€ç§å°†å‡ ä½•å›¾å…ƒå˜ä¸ºäºŒç»´å›¾åƒçš„è¿‡ç¨‹ã€‚è¯¥è¿‡ç¨‹åŒ…å«äº†ä¸¤éƒ¨åˆ†çš„å·¥ä½œã€‚1. å†³å®šçª—å£åæ ‡ä¸­çš„å“ªäº›æ•´å‹æ …æ ¼åŒºåŸŸè¢«åŸºæœ¬å›¾å…ƒå ç”¨ï¼›2. åˆ†é…ä¸€ä¸ªé¢œè‰²å€¼å’Œä¸€ä¸ªæ·±åº¦å€¼åˆ°å„ä¸ªåŒºåŸŸã€‚å…‰æ …åŒ–è¿‡ç¨‹äº§ç”Ÿçš„æ˜¯ç‰‡å…ƒ</li><li>æŠŠç‰©ä½“çš„æ•°å­¦æè¿°ä»¥åŠä¸ç‰©ä½“ç›¸å…³çš„é¢œè‰²ä¿¡æ¯è½¬æ¢ä¸ºå±å¹•ä¸Šç”¨äºå¯¹åº”ä½ç½®çš„åƒç´ åŠç”¨äºå¡«å……åƒç´ çš„é¢œè‰²ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå…‰æ …åŒ–ï¼Œè¿™æ˜¯ä¸€ä¸ªå°†æ¨¡æ‹Ÿä¿¡å·è½¬åŒ–ä¸ºç¦»æ•£ä¿¡å·çš„è¿‡ç¨‹</li></ul><p>ç®€è€Œè¨€ä¹‹ï¼Œå…‰æ …åŒ–é˜¶æ®µç»˜åˆ¶å¯¹åº”çš„å›¾å…ƒï¼ˆç‚¹ã€çº¿ã€ä¸‰è§’å½¢ï¼‰ï¼Œå°†å›¾å…ƒè½¬åŒ–ä¸ºä¸€ç»„äºŒç»´æ•°ç»„çš„è¿‡ç¨‹ï¼Œç„¶åä¼ é€’ç»™Fragment Shaderå¤„ç†ï¼Œæ•°ç»„ä¸­æ¯ä¸€ä¸ªæ•°å°±æ˜¯pixel</p><h1 id="Fragment-Shader"><a href="#Fragment-Shader" class="headerlink" title="Fragment Shader"></a>Fragment Shader</h1><p>Fragment Shaderä¸»è¦æ˜¯å¯¹å…‰æ …åŒ–å¤„ç†åç”Ÿæˆçš„ç‰‡å…ƒé€ä¸ªè¿›è¡Œ å¹¶è¡Œå¤„ç†ã€‚æ¥æ”¶Vertex Shaderè¾“å‡ºçš„å€¼ï¼Œéœ€è¦ä¼ å…¥çš„æ•°æ®ï¼Œä»¥åŠå®ƒç»è¿‡å˜æ¢çŸ©é˜µåè¾“å‡ºå€¼å­˜å‚¨ä½ç½®ã€‚</p><ul><li>è¾“å…¥æ•°æ®ç»„æˆ<ul><li>Shader Programï¼Œæè¿°ç‰‡å…ƒæ‰€æ‰§è¡Œçš„ç‰‡å…ƒç€è‰²å™¨ç¨‹åºæºä»£ç è¾“å…¥å˜é‡</li><li>Rasterizationå¯¹Vertex Shaderæ’å€¼åçš„è¾“å‡ºå€¼</li><li>Uniformï¼ŒFragment Shaderä½¿ç”¨çš„ä¸å˜çš„æ•°æ®</li><li>Samplerï¼Œä»£è¡¨Fragment Shaderæ‰€ç”¨çº¹ç†çš„ä¸€ç§ç‰¹æ®Šçš„ç»Ÿä¸€å˜é‡ç±»å‹</li></ul></li><li>è¾“å‡ºæ•°æ®ç»„æˆ<ul><li>Fragment Color</li></ul></li></ul><h1 id="Blending"><a href="#Blending" class="headerlink" title="Blending"></a>Blending</h1><p>Blend æ··åˆæ˜¯å°†æºè‰²å’Œç›®æ ‡è‰²ä»¥æŸç§æ–¹å¼æ··åˆç”Ÿæˆç‰¹æ•ˆçš„æŠ€æœ¯ï¼Œæ··åˆå¸¸ç”¨æ¥ç»˜åˆ¶æœ‰é€æ˜åº¦çš„ç‰©ä½“ã€‚</p><p>åœ¨æ··åˆä¸­èµ·å…³é”®ä½œç”¨çš„$\alpha$å€¼å®é™…ä¸Šæ˜¯å°†æºè‰²å’Œç›®æ ‡è‰²æŒ‰ç»™å®šæ¯”ç‡è¿›è¡Œæ··åˆï¼Œä»¥è¾¾åˆ°ä¸åŒç¨‹åº¦çš„é€æ˜ã€‚$\alpha$å€¼ä¸º0åˆ™å®Œå…¨é€æ˜ï¼Œ$\alpha$å€¼ä¸º1åˆ™å®Œå…¨ä¸é€æ˜ã€‚æ··åˆæ“ä½œåªèƒ½åœ¨RGBAæ¨¡å¼ä¸‹è¿›è¡Œï¼Œé¢œè‰²ç´¢å¼•æ¨¡å¼ä¸‹æ— æ³•æŒ‡å®š$\alpha$å€¼ã€‚</p><p>ç‰©ä½“çš„ç»˜åˆ¶é¡ºåºä¼šå½±å“åˆ°OpenGLçš„æ··åˆå¤„ç†ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.jianshu.com/p/0992fecb5107">OpenGL-æ¸²æŸ“æµç¨‹</a></p><p><a href="https://www.cnblogs.com/bigfeng/p/5068715.html">BigFengFeng</a></p>]]></content>
    
    
    <categories>
      
      <category>render</category>
      
    </categories>
    
    
    <tags>
      
      <tag>opengl</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Occypancy Networks</title>
    <link href="/2022/06/25/OccupancyNetworks/"/>
    <url>/2022/06/25/OccupancyNetworks/</url>
    
    <content type="html"><![CDATA[<h1 id="Occupancy-Networks"><a href="#Occupancy-Networks" class="headerlink" title="Occupancy Networks"></a>Occupancy Networks</h1><blockquote><p>Occupancy Networks: Learning 3D Reconstruction in Function Space</p></blockquote><h1 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h1><p>å°†3Dè¡¨é¢ä½¿ç”¨æ·±åº¦ç¥ç»ç½‘ç»œè¡¨ç¤ºç§°è¿ç»­çš„åˆ†ç±»ï¼ˆäºŒåˆ†ç±»ï¼‰é—®é¢˜ã€‚</p><h1 id="æ ¸å¿ƒæ€æƒ³"><a href="#æ ¸å¿ƒæ€æƒ³" class="headerlink" title="æ ¸å¿ƒæ€æƒ³"></a>æ ¸å¿ƒæ€æƒ³</h1><p>åœ¨ç©ºé—´ä½“ç´ ä¸­ï¼Œéœ€è¦é‡å»ºçš„ç‰©ä½“çš„å æœ‰ç‡å¹¶ä¸æ˜¯ç¦»æ•£çš„3Dç‚¹ä½ç½®ï¼Œè€Œæ˜¯æ¯ä¸€ä¸ªå¯èƒ½çš„3Dç‚¹$p\in \mathbb{R}^3$ï¼Œå‡æœ‰æ¨è®ºå‡½æ•°ï¼ˆoccupancy functionï¼‰$o:\mathbb{R}^3 \to {0,1}$</p><p>åˆ©ç”¨ç¥ç»ç½‘ç»œä¼°è®¡æ¨è®ºå‡½æ•°ï¼Œç©ºé—´ä½“ç´ æ¯ä¸€ä¸ªç‚¹éƒ½èƒ½å¤Ÿé¢„æµ‹ä¸€ä¸ª0åˆ°1çš„å æœ‰ç‡ã€‚å®é™…ä¸Šï¼Œç½‘ç»œå°±æ˜¯è¿›è¡Œä¸€ä¸ªäºŒåˆ†ç±»çš„åˆ¤æ–­ï¼Œå¯¹äºç©ºé—´ä½“ç´ çš„æ¯ä¸€ä¸ªç‚¹éƒ½èƒ½å¤Ÿç”Ÿæˆå…¶æ˜¯å¦ä¸ºç‰©ä½“è¡¨é¢ï¼ˆæ˜¯å¦åœ¨ç‰©ä½“å†…éƒ¨ï¼‰çš„æ¦‚ç‡ã€‚</p><p>å› æ­¤åœ¨ä½¿ç”¨ç½‘ç»œè¿›è¡Œé‡å»ºä¹‹å‰ï¼Œå¯¹äºè¾“å…¥å’Œè¾“å‡ºè¿›è¡Œäº†å¯¹åº”ã€‚å¯¹äºç»™å®šçš„è§‚æµ‹è¾“å…¥$x\in \mathcal X$ï¼Œå¯¹äºç½‘ç»œçš„è¾“å‡º$p\in \mathbb R^3$èƒ½å¤Ÿä½¿ç”¨$(p,x)\in \mathbb R^3 \times \mathcal X$æ¥è¡¨ç¤ºã€‚å³å¯¹äºä¸€ä¸ªå‚æ•°åŒ–ç¥ç»ç½‘ç»œ$f_\theta(\cdot)$ï¼Œå¯¹äºç»™å®šçš„pair $(p,x)$èƒ½å¤Ÿæœ‰</p><p>$$<br>f_\theta:\mathcal R^3 \times \mathbb X \to [0,1]<br>$$</p><p>å…¶ä¸­ï¼Œè¾“å…¥è¾“å‡ºéƒ½ä¸ºå®æ•°ã€‚</p><h2 id="è®­ç»ƒç­–ç•¥"><a href="#è®­ç»ƒç­–ç•¥" class="headerlink" title="è®­ç»ƒç­–ç•¥"></a>è®­ç»ƒç­–ç•¥</h2><p>åœ¨å¯¹è±¡çš„ä¸‰ç»´è¾¹ç•Œä½“ä¸­éšæœºé‡‡æ ·ç‚¹ï¼Œå¯¹äºç¬¬iä¸ªæ ·æœ¬ï¼Œé‡‡æ ·Kä¸ªç‚¹ï¼Œç„¶åè¯„ä¼°è¿™äº›ä½ç½®çš„å°æ‰¹é‡æŸå¤±ä¸º</p><p>$$<br>\mathcal L_\mathcal B(\theta)&#x3D;\frac{1}{|\mathcal B|}\sum_{i&#x3D;1}^{|\mathcal B|}\sum_{j&#x3D;1}^K\mathcal L(f_\theta(p_{ij},x_i),o_{ij})<br>$$</p><p>$x_i$æ˜¯batch Bä¸­çš„ç¬¬iä¸ªè§‚æµ‹å€¼ï¼Œ$o_{ij}\equiv o(p_{ij})$ï¼Œæ˜¯ç‚¹äº‘çš„çœŸå®ä½ç½®ï¼Œ$\mathcal L(\cdot,\cdot)$æ˜¯äº¤å‰ç†µã€‚</p><p>3Dè¡¨å¾èƒ½å¤Ÿå­¦ä¹ åˆ°æ¦‚ç‡éšå˜é‡æ¨¡å‹ï¼Œäºæ˜¯è®ºæ–‡ä»‹ç»äº†ä¸€ä¸ªencoderç½‘ç»œ$g_\psi(\cdot)$ï¼Œä½¿ç”¨ä½ç½®$p_{ij}$å’Œå æœ‰$o_{ij}$ä½œä¸ºè¾“å…¥ï¼Œæœ€ç»ˆé¢„æµ‹å‡ºå‡å€¼$\mu_\psi$å’Œæ ‡å‡†å·®$\sigma_\psi$ï¼Œå…¶æ»¡è¶³é«˜æ–¯åˆ†å¸ƒ$q_\psi(z|(p_{ij},o_{ij})<em>{j&#x3D;1:K}$ï¼Œä¸”éšç©ºé—´$z\in \mathbb R^L$ã€‚ä½œè€…åˆ©ç”¨ç”Ÿæˆæ¨¡å‹$p((o</em>{ij})<em>{j&#x3D;1:K}|(p</em>{ij})_{j&#x3D;1:K})$è´Ÿå¯¹æ•°ä¼¼ç„¶æ¥ä¼˜åŒ–ä¸‹è¾¹ç•Œ</p><p>$$<br>\mathcal L_\mathcal B^{gen}(\theta,\psi)&#x3D;\frac{1}{|\mathcal B|}\sum_{i&#x3D;1}^{|\mathcal B|}[\sum_{j&#x3D;1}^K\mathcal L(f_\theta(p_{ij},z_i),o_{ij})+KL(q_\psi(z|(p_{ij},o_{ij})_{j&#x3D;1:K})||p_0(z))]<br>$$</p><p>KLå³KLæ•£åº¦ï¼Œ$p_0(z)$ä¸ºéšå˜é‡$z_i$çš„å…ˆéªŒåˆ†å¸ƒï¼Œ$z_i$æ˜¯é€šè¿‡$q_\psi(z|(p_{ij},o_{ij})_{j&#x3D;1:K})$é‡‡æ ·å¾—åˆ°ã€‚</p><h2 id="æ¨ç†é˜¶æ®µ"><a href="#æ¨ç†é˜¶æ®µ" class="headerlink" title="æ¨ç†é˜¶æ®µ"></a>æ¨ç†é˜¶æ®µ</h2><p>è®ºæ–‡ä¸ºäº†æ ¹æ®è®­ç»ƒå‡ºçš„Occupancy Networkåœ¨æ–°çš„è§‚æµ‹ä¸‹å¾—åˆ°çš„ç»“æœæå–å‡ºç­‰å€¼é¢ï¼Œæå‡ºMISEï¼ˆMultiresolution IsoSurface Extractionï¼Œå¤šåˆ†è¾¨ç‡ç­‰å€¼é¢æå–ï¼‰ã€‚</p><p><img src="/./2022/06/25/OccupancyNetworks/OccupancyNet.png" alt="Occupency Network"></p><p>é¦–å…ˆåœ¨ç»™å®šçš„åˆ†è¾¨ç‡ä¸Šæ ‡è®°æ‰€æœ‰å·²ç»è¢«è¯„ä¼°ä¸ºè¢«å æ®ï¼ˆçº¢ï¼‰æˆ–æœªè¢«å æ®ï¼ˆé’ï¼‰çš„ç‚¹ã€‚ç„¶åç¡®å®šæ‰€æœ‰çš„ä½“ç´ å·²ç»å é¢†å’Œæœªå é¢†çš„è§’è½ï¼Œå¹¶æ ‡è®°ï¼ˆæ·¡çº¢ï¼‰ï¼Œç»†åˆ†ä¸º4ä¸ªäºšä½“ç´ ã€‚æ¥ä¸‹æ¥ï¼Œè¯„ä¼°æ‰€æœ‰ç”±ç»†åˆ†å¼•å…¥çš„æ–°ç½‘æ ¼ç‚¹ï¼ˆç©ºï¼‰ã€‚é‡å¤å‰ä¸¤ä¸ªæ­¥éª¤ï¼Œç›´åˆ°è¾¾åˆ°æ‰€éœ€çš„è¾“å‡ºåˆ†è¾¨ç‡ã€‚æœ€åä½¿ç”¨Marching Cubesç®—æ³•æå–ç½‘æ ¼ï¼Œåˆ©ç”¨ä¸€é˜¶å’ŒäºŒé˜¶æ¢¯åº¦ä¿¡æ¯å¯¹è¾“å‡ºç½‘æ ¼è¿›è¡Œç®€åŒ–å’Œç»†åŒ–ã€‚</p><h1 id="å®ç°ç»†èŠ‚"><a href="#å®ç°ç»†èŠ‚" class="headerlink" title="å®ç°ç»†èŠ‚"></a>å®ç°ç»†èŠ‚</h1><p>åœ¨è®ºæ–‡ç»™å‡ºçš„ä»£ç ä¸­ï¼Œdecoderéƒ¨åˆ†æœ€åä¸€å±‚ä¸ºConv1dè€Œæ²¡æœ‰è¡”æ¥Sigmoid&#x2F;Softmaxå±‚ï¼Œåœ¨losså‡½æ•°è®¡ç®—çš„æ—¶å€™ï¼Œä½¿ç”¨BCE_with_logitsæ¥è®¡ç®—ã€‚åŒæ—¶ï¼Œå°†è¾“å‡ºçš„logitsç”Ÿæˆdist.Bernoulliåˆ†å¸ƒï¼Œç”¨KLæ•£åº¦ä¸å…ˆéªŒæ¨¡å‹è¿›è¡ŒæŸå¤±è®¡ç®—ã€‚</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">class</span> <span class="hljs-title class_">DecoderCBatchNorm</span>(nn.Module):<br>    <span class="hljs-string">&#x27;&#x27;&#x27; Decoder with conditional batch normalization (CBN) class.</span><br><span class="hljs-string"></span><br><span class="hljs-string">    Args:</span><br><span class="hljs-string">        dim (int): input dimension</span><br><span class="hljs-string">        z_dim (int): dimension of latent code z</span><br><span class="hljs-string">        c_dim (int): dimension of latent conditioned code c</span><br><span class="hljs-string">        hidden_size (int): hidden size of Decoder network</span><br><span class="hljs-string">        leaky (bool): whether to use leaky ReLUs</span><br><span class="hljs-string">        legacy (bool): whether to use the legacy structure</span><br><span class="hljs-string">    &#x27;&#x27;&#x27;</span><br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self, dim=<span class="hljs-number">3</span>, z_dim=<span class="hljs-number">128</span>, c_dim=<span class="hljs-number">128</span>,</span><br><span class="hljs-params">                 hidden_size=<span class="hljs-number">256</span>, leaky=<span class="hljs-literal">False</span>, legacy=<span class="hljs-literal">False</span></span>):<br>        <span class="hljs-built_in">super</span>().__init__()<br>        self.z_dim = z_dim<br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> z_dim == <span class="hljs-number">0</span>:<br>            self.fc_z = nn.Linear(z_dim, hidden_size)<br><br>        self.fc_p = nn.Conv1d(dim, hidden_size, <span class="hljs-number">1</span>)<br>        self.block0 = CResnetBlockConv1d(c_dim, hidden_size, legacy=legacy)<br>        self.block1 = CResnetBlockConv1d(c_dim, hidden_size, legacy=legacy)<br>        self.block2 = CResnetBlockConv1d(c_dim, hidden_size, legacy=legacy)<br>        self.block3 = CResnetBlockConv1d(c_dim, hidden_size, legacy=legacy)<br>        self.block4 = CResnetBlockConv1d(c_dim, hidden_size, legacy=legacy)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> legacy:<br>            self.bn = CBatchNorm1d(c_dim, hidden_size)<br>        <span class="hljs-keyword">else</span>:<br>            self.bn = CBatchNorm1d_legacy(c_dim, hidden_size)<br><br>        self.fc_out = nn.Conv1d(hidden_size, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>)<br><br>        <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> leaky:<br>            self.actvn = F.relu<br>        <span class="hljs-keyword">else</span>:<br>            self.actvn = <span class="hljs-keyword">lambda</span> x: F.leaky_relu(x, <span class="hljs-number">0.2</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self, p, z, c, **kwargs</span>):<br>        p = p.transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)<br>        batch_size, D, T = p.size()<br>        net = self.fc_p(p)<br><br>        <span class="hljs-keyword">if</span> self.z_dim != <span class="hljs-number">0</span>:<br>            net_z = self.fc_z(z).unsqueeze(<span class="hljs-number">2</span>)<br>            net = net + net_z<br><br>        net = self.block0(net, c)<br>        net = self.block1(net, c)<br>        net = self.block2(net, c)<br>        net = self.block3(net, c)<br>        net = self.block4(net, c)<br><br>        out = self.fc_out(self.actvn(self.bn(net, c)))<br>        out = out.squeeze(<span class="hljs-number">1</span>)<br><br>        <span class="hljs-keyword">return</span> out<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_loss</span>(<span class="hljs-params">self, data</span>):<br>        <span class="hljs-string">&#x27;&#x27;&#x27; Computes the loss.</span><br><span class="hljs-string"></span><br><span class="hljs-string">        Args:</span><br><span class="hljs-string">            data (dict): data dictionary</span><br><span class="hljs-string">        &#x27;&#x27;&#x27;</span><br>        device = self.device<br>        p = data.get(<span class="hljs-string">&#x27;points&#x27;</span>).to(device)<br>        occ = data.get(<span class="hljs-string">&#x27;points.occ&#x27;</span>).to(device)<br>        inputs = data.get(<span class="hljs-string">&#x27;inputs&#x27;</span>, torch.empty(p.size(<span class="hljs-number">0</span>), <span class="hljs-number">0</span>)).to(device)<br><br>        kwargs = &#123;&#125;<br><br>        c = self.model.encode_inputs(inputs)<br>        q_z = self.model.infer_z(p, occ, c, **kwargs)<br>        z = q_z.rsample()<br><br>        <span class="hljs-comment"># KL-divergence</span><br>        kl = dist.kl_divergence(q_z, self.model.p0_z).<span class="hljs-built_in">sum</span>(dim=-<span class="hljs-number">1</span>)<br>        loss = kl.mean()<br><br>        <span class="hljs-comment"># General points</span><br>        logits = self.model.decode(p, z, c, **kwargs).logits<br>        loss_i = F.binary_cross_entropy_with_logits(<br>            logits, occ, reduction=<span class="hljs-string">&#x27;none&#x27;</span>)<br>        loss = loss + loss_i.<span class="hljs-built_in">sum</span>(-<span class="hljs-number">1</span>).mean()<br><br>        <span class="hljs-keyword">return</span> loss<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>paper reading</category>
      
    </categories>
    
    
    <tags>
      
      <tag>volume reconstruction</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Marching Cubes</title>
    <link href="/2022/06/25/MarchingCubes/"/>
    <url>/2022/06/25/MarchingCubes/</url>
    
    <content type="html"><![CDATA[<h1 id="Marching-Cubes"><a href="#Marching-Cubes" class="headerlink" title="Marching Cubes"></a>Marching Cubes</h1><p>Marching Cubesç®—æ³•æ˜¯ä¸‰ç»´ç¦»æ•£æ•°æ®åœºä¸­æå–ç­‰å€¼é¢çš„ç»å…¸ç®—æ³•ï¼Œå…¶ä¸»è¦åº”ç”¨äºåŒ»å­¦é¢†åŸŸçš„å¯è§†åŒ–åœºæ™¯ï¼Œä¾‹å¦‚CTæ‰«æå’ŒMRIæ‰«æçš„3Dé‡å»ºç­‰å€¼é¢ï¼Œå³ç©ºé—´ä¸­æ‰€æœ‰å…·æœ‰æŸä¸ªç›¸åŒå€¼çš„ç‚¹çš„é›†åˆï¼Œå¯ä»¥ç±»æ¯”ä¸ºåœ°å½¢å›¾é‡Œçš„ç­‰é«˜çº¿ã€‚</p><p>${ (x,y,z)|f(x,y,z)&#x3D;c, c\in C  }$</p><h1 id="ç®—æ³•æ€æƒ³"><a href="#ç®—æ³•æ€æƒ³" class="headerlink" title="ç®—æ³•æ€æƒ³"></a>ç®—æ³•æ€æƒ³</h1><ul><li>åŸºæœ¬å‡è®¾ï¼šæ²¿å…­é¢ä½“è¾¹çš„æ•°æ®åœºå‘ˆè¿ç»­æ€§å˜åŒ–ã€‚å¦‚æœä¸€æ¡è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹åˆ†åˆ«å¤§äºæˆ–å°äºç­‰å€¼é¢çš„å€¼ï¼Œåˆ™åœ¨è¯¥æ¡è¾¹ä¸Šæœ‰ä¸”ä»…æœ‰ä¸€ç‚¹æ˜¯è¿™æ¡è¾¹ä¸ç­‰å€¼é¢çš„äº¤ç‚¹ã€‚</li><li>é€ä¸ªå¤„ç†æ•°æ®åœºä¸­çš„ç«‹æ–¹ä½“ï¼ˆä½“ç´ voxelï¼‰ï¼Œåˆ†ç¦»å‡ºä¸ç­‰å€¼é¢ç›¸äº¤çš„ç«‹æ–¹ä½“ï¼Œé‡‡ç”¨æ’å€¼è®¡ç®—å‡ºç­‰å€¼é¢ä¸ç«‹æ–¹ä½“è¾¹çš„äº¤ç‚¹ã€‚æ ¹æ®ç«‹æ–¹ä½“æ¯ä¸€é¡¶ç‚¹ä¸ç­‰å€¼é¢çš„ç›¸å¯¹ä½ç½®ï¼Œå°†ç­‰å€¼é¢ä¸ç«‹æ–¹ä½“è¾¹çš„äº¤ç‚¹æŒ‰ä¸€å®šæ–¹å¼è¿æ¥ç”Ÿæˆç­‰å€¼é¢ï¼Œä½œä¸ºç­‰å€¼é¢åœ¨è¯¥ç«‹æ–¹ä½“å†…çš„ä¸€ä¸ªé€¼è¿‘è¡¨ç¤º</li><li>ç›´è§‚åœ°è¯´ï¼Œå°±æ˜¯ç”¨è®¸å¤šå°æ­£æ–¹ä½“å»å¯¹ç©ºé—´è¿›è¡Œåˆ‡åˆ†ï¼Œç„¶åç”¨å°æ­£æ–¹ä½“å†…éƒ¨çš„å¹³é¢æ¥è¿‘ä¼¼è¡¨ç¤ºå½“å‰çš„ç­‰å€¼é¢ã€‚å°æ­£æ–¹ä½“çš„æ•°é‡è¶Šå¤šï¼Œé€¼è¿‘çš„æ•ˆæœè¶Šå¥½ï¼Œè®¡ç®—éœ€è¦çš„èµ„æºå°±è¶Šå¤š</li></ul><h1 id="éƒ¨åˆ†ç»†èŠ‚"><a href="#éƒ¨åˆ†ç»†èŠ‚" class="headerlink" title="éƒ¨åˆ†ç»†èŠ‚"></a>éƒ¨åˆ†ç»†èŠ‚</h1><ul><li>å°æ­£æ–¹ä½“å†…éƒ¨çš„å¹³é¢å¯ä»¥å°ç«‹æ–¹ä½“å’Œç­‰å€¼é¢çš„ç›¸äº¤æƒ…å†µæ¥ç¡®å®š</li></ul><p><img src="/./2022/06/25/MarchingCubes/Judge.png" alt="Judge Cube"></p><ul><li>å¯¹äºæ¯ä¸ªå°æ­£æ–¹ä½“æ¥è¯´ï¼Œæ¯ä¸ªé¡¶ç‚¹ä¸¤ç§æƒ…å†µï¼ˆå¤§äºæˆ–å°äºï¼‰å½“å‰ç­‰å€¼é¢çš„å€¼ï¼Œ8ä¸ªé¡¶ç‚¹å…±256ç§æƒ…å†µï¼Œè€ƒè™‘åˆ°æ—‹è½¬å¯¹ç§°æ€§ï¼Œä»æ–°åˆ†ç±»åå¯å¾—15ç§åŸºæœ¬æ¨¡å¼</li></ul><p><img src="/./2022/06/25/MarchingCubes/MarchingCubeCases.png" alt="Marching Cube Cases"></p><h1 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h1><ol><li>å°†åŸå§‹æ•°æ®ç»è¿‡é¢„å¤„ç†ä¹‹åï¼Œè¯»å…¥æŒ‡å®šçš„æ•°ç»„ä¸­</li><li>ä»ç½‘æ ¼æ•°æ®ä½“ä¸­æå–ä¸€ä¸ªå•å…ƒä½“ï¼Œæˆä¸ºå½“å‰å•å…ƒä½“ï¼ŒåŒæ—¶è·å–è¯¥å•å…ƒä½“çš„æ‰€æœ‰ä¿¡æ¯ï¼Œä¾‹å¦‚8ä¸ªé¡¶ç‚¹çš„å€¼ã€åæ ‡ä½ç½®ç­‰</li><li>å°†å½“å‰å•å…ƒä½“8ä¸ªé¡¶ç‚¹çš„å‡½æ•°å€¼ä¸ç»™å®šç­‰å€¼é¢å€¼Cè¿›è¡Œæ¯”è¾ƒï¼Œå¾—åˆ°è¯¥å•å…ƒä½“çš„çŠ¶æ€è¡¨ï¼ˆedgeTableã€triTableï¼‰</li><li>æ ¹æ®å½“å‰å•å…ƒä½“çš„çŠ¶æ€è¡¨ç´¢å¼•ï¼Œæ‰¾å‡ºä¸ç­‰å€¼é¢ç›¸äº¤çš„å•å…ƒä½“æ£±è¾¹ï¼Œå¹¶é‡‡ç”¨çº¿æ€§æ’å€¼çš„æ–¹æ³•ï¼Œè®¡ç®—å‡ºå„ä¸ªäº¤ç‚¹çš„ä½ç½®åæ ‡</li><li>åˆ©ç”¨ä¸­å¿ƒå·®åˆ†æ³•ï¼Œæ±‚å‡ºå½“å‰å•å…ƒä½“8ä¸ªé¡¶ç‚¹çš„æ³•å‘é‡ï¼Œåœ¨é‡‡ç”¨çº¿æ€§æ’å€¼çš„æ–¹æ³•ï¼Œå¾—åˆ°ä¸‰è§’é¢ç‰‡å„ä¸ªé¡¶ç‚¹çš„æ³•å‘</li><li>æ ¹æ®å„ä¸ªä¸‰è§’é¢ç‰‡é¡¶ç‚¹çš„åæ ‡ï¼Œé¡¶ç‚¹æ³•å‘é‡è¿›è¡Œç­‰å€¼é¢å›¾è±¡çš„ç»˜åˆ¶</li></ol><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://zhuanlan.zhihu.com/p/48022195">Marching Cubesç®—æ³•ç†è§£</a></p><p><a href="https://tandy123.github.io/2017/03/02/Marching-Cubes/">ã€ç®—æ³•ã€‘Marching Cubesç®—æ³•ç†è§£</a></p>]]></content>
    
    
    <categories>
      
      <category>3D Basic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>volume</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>CUDAæç®€å…¥é—¨</title>
    <link href="/2022/06/25/CUDA%E6%9E%81%E7%AE%80%E5%85%A5%E9%97%A8/"/>
    <url>/2022/06/25/CUDA%E6%9E%81%E7%AE%80%E5%85%A5%E9%97%A8/</url>
    
    <content type="html"><![CDATA[<h1 id="CUDAæç®€å…¥é—¨"><a href="#CUDAæç®€å…¥é—¨" class="headerlink" title="CUDAæç®€å…¥é—¨"></a>CUDAæç®€å…¥é—¨</h1><blockquote><p>CUDAï¼ŒCompute Unified Device Architecture</p></blockquote><aside>ğŸ’¡ è¿™æ˜¯ä¸€ä»½æç®€çš„CUDAå…¥é—¨ç¼–ç¨‹æŒ‡å—ï¼Œç¡®ä¿è‡³å°‘äº†è§£C/C++</aside><h1 id="å…¸å‹æµç¨‹"><a href="#å…¸å‹æµç¨‹" class="headerlink" title="å…¸å‹æµç¨‹"></a>å…¸å‹æµç¨‹</h1><ol><li>åˆ†é…hostå†…å­˜ï¼Œå¹¶è¿›è¡Œæ•°æ®åˆå§‹åŒ–</li><li>åˆ†é…deviceå†…å­˜ï¼Œå¹¶ä»hostå°†æ•°æ®æ‹·è´åˆ°deviceä¸Š</li><li>è°ƒç”¨CUDAçš„æ ¸å‡½æ•°åœ¨deviceä¸Šå®ŒæˆæŒ‡å®šçš„è¿ç®—</li><li>å°†deviceä¸Šçš„è¿ç®—ç»“æœæ‹·è´åˆ°hostä¸Š</li><li>é‡Šæ”¾deviceå’Œhostä¸Šåˆ†é…çš„å†…å­˜</li></ol><h1 id="CUDAæ•°ç»„ã€å¯¹è±¡å’Œèµ„æºçš„ä½¿ç”¨"><a href="#CUDAæ•°ç»„ã€å¯¹è±¡å’Œèµ„æºçš„ä½¿ç”¨" class="headerlink" title="CUDAæ•°ç»„ã€å¯¹è±¡å’Œèµ„æºçš„ä½¿ç”¨"></a>CUDAæ•°ç»„ã€å¯¹è±¡å’Œèµ„æºçš„ä½¿ç”¨</h1><p>ä¸€èˆ¬ä½¿ç”¨<code>cudaArray_t</code>ã€<code>cudaTextureObj_t</code>å’Œ<code>cudaSurfaceObj_t</code>ä¸‰ç§ï¼Œå¹¶ä¸”å¸¸å°†åŒä¸€ä¸ªå˜é‡çš„ä¸‰è€…ï¼ˆor lessï¼Œä½†è‡³å°‘ä½¿ç”¨ï¼‰å½¢å¼è¿›è¡Œç»‘å®šã€‚<code>cudaChannelFormatDesc</code>å’Œ<code>cudaCreateChannelDesc</code>çš„ä½¿ç”¨ä¸º<code>cudaArray_t</code>ã€<code>cudaTextureObj_t</code>å’Œ<code>cudaSurfaceObj_t</code>è¿›è¡Œæ ¼å¼åˆ›å»ºæè¿°ï¼Œä½¿ç”¨<code>MallocCudaArray</code>å¯¹ç›¸å…³Resourceè¿›è¡Œæ˜¾å­˜åˆ†é…ã€‚åŒæ—¶ï¼Œå¦‚æœéœ€è¦å°†GPUä¸­çš„æ•°æ®ä¸CPUä¸­çš„æ•°æ®è¿›è¡ŒåŒæ­¥æˆ–äº¤æ¢ï¼Œé‡‡ç”¨<code>cudaMemcpy2DToArray</code>å’Œ<code>cudaMemcpy2DFromArray</code>ï¼Œå®ŒæˆGPUå’ŒCPUçš„æ•°æ®åŒæ­¥ã€‚</p><h1 id="Errorå®šä½"><a href="#Errorå®šä½" class="headerlink" title="Errorå®šä½"></a>Errorå®šä½</h1><p>ç”±äºCUDAæ˜¯è·‘åœ¨GPUä¸Šçš„ç¨‹åºï¼Œæ‰€æœ‰çš„å˜é‡åˆ†é…ä¹Ÿæ˜¯å­˜æ”¾åœ¨GPUä¸­ï¼Œå› æ­¤ä¸èƒ½å¤Ÿå’ŒCPUè°ƒè¯•ä¸€æ ·æœ‰è¯¦ç»†çš„è¾“å‡ºæˆ–å †æ ˆè°ƒç”¨ã€‚ä½†æˆ‘ä»¬åœ¨ç¼–å†™æ—¶æ€»å¯èƒ½ä¼šé‡åˆ°åœ¨æŸä¸€äº›ä»£ç æ®µå‡ºé”™çš„æƒ…å†µï¼Œä½†CUDAåªä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œå¹¶ä¸ä¼šå®šä½åˆ°ä»£ç æ®µï¼Œå› æ­¤éœ€è¦è¿›è¡ŒGPUä»£ç æ¨¡å—çš„Errorå®šä½ã€‚</p><p>ä¸€èˆ¬è€Œè¨€ï¼Œæˆ‘ä»¬åœ¨å®ŒæˆGPUç›¸åº”çš„ä»£ç æ¨¡å—åŠŸèƒ½åï¼Œå¯ä»¥ä½¿ç”¨<code>cudaGetLastError</code>å’Œ<code>cudaStreamSynchtonize</code>æ¥å®šä½å¯èƒ½å‡ºç°çš„CUDA Errorã€‚è¿™ä¸¤ä¸ªæŒ‡ä»¤å¯ä»¥è¿½è¸ªCUDAä¸­é‡åˆ°çš„Errorï¼Œåœ¨ç¨‹åºä¸­å¯ä»¥ä½¿ç”¨å¤šä¸ªè¿½è¸ªã€‚åœ¨CUDAæ¨¡å—è¿è¡Œå‡ºé”™åï¼Œç¨‹åºä¼šæ ¹æ®Errorè¿½è¸ªæŒ‡ä»¤æç¤ºåˆ°å‡ºé”™CUDAæ¨¡å—åçš„ç¬¬ä¸€ä¸ª<code>cudaGetLastError</code>ï¼Œç”¨æ­¤æ–¹å¼å¯ä»¥å¿«é€Ÿå®šä½åˆ°ç¼–å†™çš„å“ªä¸€ä¸ªæ¨¡å—åœ¨æœ€ç»ˆè¿è¡Œæ—¶å‡ºç°é”™è¯¯ã€‚</p><p>å®é™…ä¸Šï¼Œæ‰€æœ‰çš„CUDA APIéƒ½ä¼šè¿”å›ä¸€ä¸ªCUDAçŠ¶æ€å€¼ï¼Œä½†æˆ‘ä»¬ä¸€èˆ¬ä¸éœ€è¦å°†æ‰€æœ‰çš„CUDAå‘½ä»¤éƒ½è¿›è¡Œå‡ºé”™åˆ¤æ–­ã€‚</p><h1 id="From-simple-example"><a href="#From-simple-example" class="headerlink" title="From simple example"></a>From simple example</h1><p>ç¤ºä¾‹ä»£ç åŠŸèƒ½ä¸ºåˆ©ç”¨CUDAå®ç°ç°åº¦å›¾ç‰‡å¯¹åº”åƒç´ ç›¸åŠ ã€‚ï¼ˆå½“ç„¶æˆ‘è¿˜æ²¡è·‘è¿‡ï¼Œè™½ç„¶æ˜¯æˆ‘å†™çš„ï¼‰</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br></pre></td><td class="code"><pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;opencv2/core.hpp&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;opencv2/imgcodecs.hpp&gt;</span></span><br><span class="hljs-meta">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;cuda_runtime.h&gt;</span></span><br><br><span class="hljs-comment">// __global__ declare</span><br><span class="hljs-function">__global__ <span class="hljs-type">void</span> <span class="hljs-title">add</span><span class="hljs-params">(cudaTextureObject_t* img1,cudaTextureObject_t* img2,cudaSurfaceObject_t* img3, <span class="hljs-type">int</span> imgH, <span class="hljs-type">int</span> imhW)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-type">int</span> pidx = blockIdx.x * blockDim.x + threadIdx.x;<br><span class="hljs-type">int</span> pidy = blockIdx.y * blockDim.y + threadIdx.y;<br><span class="hljs-keyword">if</span>((pidx&lt;imgW)&amp;&amp;(pidy&lt;imgH))&#123;<br>uchar v1 = <span class="hljs-built_in">tex2D</span>&lt;uchar&gt;(img1, pidx, pidy);<br>uchar v2 = <span class="hljs-built_in">tex2D</span>&lt;uchar&gt;(img2, pidx, pidy);<br>uchar v3 = v1 + v2;<br><span class="hljs-built_in">surf2Dwrite</span>(v3, img3, <span class="hljs-built_in">sizeof</span>(uchar)*pidx, pidy);<br>&#125;<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Upload</span><span class="hljs-params">(cv::Mat &amp;_img_host, cudaArray_t &amp;_cuda_array)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">cudaSafeCall</span>(<span class="hljs-built_in">cudaMemcpy2DToArray</span>(<br>_cuda_array, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>_img_host.data,<br>_img_host.cols * _img_host.<span class="hljs-built_in">elemSize</span>(),<br>_img_host.cols * _img_host.<span class="hljs-built_in">elemSize</span>(),<br>_img_host.rows,<br>cudaMemcpyHostToDevice));<br>&#125;<br><br><span class="hljs-function"><span class="hljs-type">void</span> <span class="hljs-title">Download</span><span class="hljs-params">(cudaArray_t &amp;_cuda_array, cv::Mat &amp;_img_host)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-built_in">cudaSafeCall</span>(<span class="hljs-built_in">cudaMemcpy2DFromArray</span>(<br>_img_host.data,<br>_img_host.cols * _img_host.<span class="hljs-built_in">elemSize</span>(),<br>_cuda_array,<br><span class="hljs-number">0</span>, <span class="hljs-number">0</span>,<br>_img_host.cols * _img_host.<span class="hljs-built_in">elemSize</span>(),<br>_img_host.rows,<br>cudaMemcpyDeviceToHost));<br>&#125;<br><br><span class="hljs-keyword">auto</span> CreateCudaTextureAndSurfaceObject = [](<br>cudaTextureObject_t &amp;_tex,<br>cudaSurfaceObject_t &amp;_surf,<br>cudaArray_t &amp;_array,<br>cudaResourceDesc &amp;_res_desc,<br>cudaTextureDesc &amp;_tex_desc)<br>&#123;<br>_res_desc.res.array.array = _array;<br><span class="hljs-built_in">cudaSafeCall</span>(<span class="hljs-built_in">cudaCreateTextureObject</span>(&amp;_tex, &amp;_res_desc, &amp;_tex_desc, <span class="hljs-number">0</span>));<br><span class="hljs-built_in">cudaSafeCall</span>(<span class="hljs-built_in">cudaCreateSurfaceObject</span>(&amp;_surf, &amp;_res_desc));<br>&#125;;<br><br><span class="hljs-function"><span class="hljs-type">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-type">void</span>)</span></span><br><span class="hljs-function"></span>&#123;<br><span class="hljs-comment">// Host array init</span><br>    cv::Mat host_a, host_b, host_c;<br><span class="hljs-type">int</span> width = <span class="hljs-number">512</span>, height = <span class="hljs-number">512</span>;<br>host_a.<span class="hljs-built_in">create</span>(width, height, CV_8CU1);<br>host_b.<span class="hljs-built_in">create</span>(width, height, CV_8CU1);<br>host_c.<span class="hljs-built_in">create</span>(width, height, CV_8CU1);<br><br><span class="hljs-comment">// Device array, surface, texture init</span><br>cudaArray_t dev_a_cuarray;<br>cudaArray_t dev_b_cuarray;<br>cudaArray_t dev_c_cuarray;<br><br>cudaTextureObject_t dev_a_cutex;<br>cudaTextureObject_t dev_b_cutex;<br>cudaTextureObject_t dev_c_cutex;<br><br>cudaSurfaceObject_t dev_a_cusurf;<br>cudaSurfaceObject_t dev_b_cusurf;<br>cudaSurfaceObject_t dev_c_cusurf;<br><br>cudaChannelFormatDesc dev_a_desc = <span class="hljs-built_in">cudaCreateChannelDesc</span>&lt;uchar&gt;();<br>cudaChannelFormatDesc dev_b_desc = <span class="hljs-built_in">cudaCreateChannelDesc</span>&lt;uchar&gt;();<br>cudaChannelFormatDesc dev_c_desc = <span class="hljs-built_in">cudaCreateChannelDesc</span>&lt;uchar&gt;();<br><br><span class="hljs-built_in">cudaMallocArray</span>(&amp;dev_a_cuarray, &amp;dev_a_desc, width, height, cudaArraySurfaceLoadStore);<br><span class="hljs-built_in">cudaMallocArray</span>(&amp;dev_b_cuarray, &amp;dev_b_desc, width, height, cudaArraySurfaceLoadStore);<br><span class="hljs-built_in">cudaMallocArray</span>(&amp;dev_c_cuarray, &amp;dev_c_desc, width, height, cudaArraySurfaceLoadStore);<br><br>cudaTextureDesc tex_desc;<br><span class="hljs-built_in">memset</span>(&amp;tex_desc, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(cudaTextureDesc));<br>tex_desc.addressMode[<span class="hljs-number">0</span>] = cudaAddressModeBorder;<br>tex_desc.addressMode[<span class="hljs-number">1</span>] = cudaAddressModeBorder;<br>tex_desc.filterMode = cudaFilterModePoint;<br>tex_desc.readMode = cudaReadModeElementType;<br>tex_desc.normalizedCoords = <span class="hljs-number">0</span>;<br><br>cudaResourceDesc res_desc;<br><span class="hljs-built_in">memset</span>(&amp;res_desc, <span class="hljs-number">0</span>, <span class="hljs-built_in">sizeof</span>(cudaResourceDesc));<br>res_desc.resType = cudaResourceTypeArray;<br><br><span class="hljs-built_in">CreateCudaTextureAndSurfaceObject</span>(dev_a_cutex, dev_a_cusurf, dev_a_cuarray, res_desc, tex_desc);<br><span class="hljs-built_in">CreateCudaTextureAndSurfaceObject</span>(dev_b_cutex, dev_b_cusurf, dev_b_cuarray, res_desc, tex_desc);<br><span class="hljs-built_in">CreateCudaTextureAndSurfaceObject</span>(dev_c_cutex, dev_c_cusurf, dev_c_cuarray, res_desc, tex_desc);<br><br><span class="hljs-comment">// Upload data from CPU to GPU</span><br><span class="hljs-built_in">Upload</span>(host_a, dev_a_cuarray);<br><span class="hljs-built_in">Upload</span>(host_b, dev_b_cuarray);<br><span class="hljs-built_in">Upload</span>(host_c, dev_c_cuarray);<br><br><span class="hljs-comment">// Block and Grid init</span><br><span class="hljs-function">dim3 <span class="hljs-title">block</span><span class="hljs-params">(<span class="hljs-number">16</span>, <span class="hljs-number">16</span>)</span></span>;<br><span class="hljs-function">dim3 <span class="hljs-title">grid</span><span class="hljs-params">(width/block.x, height/block.y)</span></span>;<br>    add&lt;&lt;&lt;grid, block&gt;&gt;&gt;(dev_a_cutex, dev_b_cutex, dev_c_cusurf, height, width);<br><br><span class="hljs-built_in">cudaSafeCall</span>(<span class="hljs-built_in">cudaGetLastError</span>());<br><span class="hljs-built_in">cudaSafeCall</span>(<span class="hljs-built_in">cudaDeviceSynchronize</span>());<br><br><span class="hljs-comment">// Download data from GPU to CPU</span><br><span class="hljs-built_in">Download</span>(dev_c_cuarray, host_c);<br><br><span class="hljs-comment">// Destroy CUDA resource</span><br><span class="hljs-built_in">cudaDestroyTextureObject</span>(dev_a_cutex);<br><span class="hljs-built_in">cudaDestroyTextureObject</span>(dev_b_cutex);<br><span class="hljs-built_in">cudaDestroyTextureObject</span>(dev_c_cutex);<br><br><span class="hljs-built_in">cudaDestroySurfaceObject</span>(dev_a_cusurf);<br><span class="hljs-built_in">cudaDestroySurfaceObject</span>(dev_b_cusurf);<br><span class="hljs-built_in">cudaDestroySurfaceObject</span>(dev_c_cusurf);<br><br><span class="hljs-built_in">cudaFreeArray</span>(dev_a_cuarray);<br><span class="hljs-built_in">cudaFreeArray</span>(dev_b_cuarray);<br><span class="hljs-built_in">cudaFreeArray</span>(dev_c_cuarray);<br><br><span class="hljs-comment">// Release cv::Mat</span><br>host_a.<span class="hljs-built_in">release</span>();<br>host_b.<span class="hljs-built_in">release</span>();<br>host_c.<span class="hljs-built_in">release</span>();<br>    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<br>&#125;<br></code></pre></td></tr></table></figure><h1 id="Grid-and-Block"><a href="#Grid-and-Block" class="headerlink" title="Grid and Block"></a>Grid and Block</h1><p>Gridå’ŒBlockæ˜¯CUDAç¼–ç¨‹ä¸­æœ€é‡è¦çš„æ¦‚å¿µä¹‹ä¸€ï¼Œä»¥ä¸‹å›¾[Reference 1]ä¸ºä¾‹ï¼Œä»£è¡¨ä¸€ä¸ªCUDAæ ¸å‡½æ•°kernelè°ƒç”¨çš„Gridå’ŒBlockå›¾è§£ã€‚</p><p><code>blockDim.x</code>æ˜¯æ¯ä¸€ä¸ªBlockå†…éƒ¨çš„xæ–¹å‘çš„ç»´åº¦ï¼Œå›¾ä¸­5ï¼Œå³æ¯è¡Œ5ä¸ªçº¿ç¨‹ã€‚<code>blockDim.y</code>æ˜¯Blockå†…éƒ¨çš„yæ–¹å‘çš„ç»´åº¦ï¼Œè¿™é‡Œæ˜¯3ï¼Œå³æ¯åˆ—3ä¸ªçº¿ç¨‹ã€‚<code>blockIdx.x</code>æ˜¯Blockåœ¨gridä¸­xæ–¹å‘çš„ä½ç½®ï¼Œå›¾ä¸­æ”¾å¤§çš„Blockæ˜¯Gridä¸­çš„2ï¼Œå³ä¸ºGridä¸­xæ–¹å‘çš„ç¬¬2ä¸ªã€‚<code>blockIdx.y</code>æ˜¯Blockåœ¨gridä¸­yå‘çš„ä½ç½®ï¼Œå›¾ä¸­æ”¾å¤§çš„Blockæ˜¯Gridä¸­çš„2ï¼Œå³ä¸ºGridä¸­yæ–¹å‘çš„ç¬¬2ä¸ªã€‚blockIdxä¸­çš„Idxæ˜¯è¡¨ç¤ºindexçš„ç¼©å†™ï¼Œè€Œä¸æ˜¯è¡¨ç¤ºxæ–¹å‘çš„IDã€‚</p><p><img src="/./2022/06/25/CUDA%E6%9E%81%E7%AE%80%E5%85%A5%E9%97%A8/GridAndBlock.png" alt="Grid And Block"></p><p>åœ¨CUDA kernelçš„ä½¿ç”¨æ—¶ï¼Œéœ€è¦ä¼ å…¥&lt;&lt;&lt;grid, block&gt;&gt;&gt;å‚æ•°ã€‚</p><h1 id="CUDA-C-Basic"><a href="#CUDA-C-Basic" class="headerlink" title="CUDA C++ Basic"></a>CUDA C++ Basic</h1><aside>ğŸ’¡ åœ¨è¿™ä¸€ç¯‡æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†ä¾æ®ä¸Šè¿°Sampleç®€è¦ä»‹ç»ä¸€äº›åŸºç¡€çš„Typeå’ŒFunction</aside><ul><li><code>cudaCreateChannelDesc</code>ï¼Œåˆ›å»ºcudaçš„é€šé“æè¿°ç¬¦ï¼Œåœ¨ä½¿ç”¨<code>cudaMallocArray</code>çš„æ—¶å€™éœ€è¦å°†æè¿°ç¬¦ä¸€åŒä¼ å…¥è¿›è¡Œ<code>cudaArray</code>çš„å†…å­˜ç”³è¯·ã€‚ä½¿ç”¨<code>cudaChannelFormatDesc dev_a_desc = cudaCreateChannelDesc&lt;uchar&gt;();</code>çš„ä½¿ç”¨æ–¹å¼ç”Ÿæˆé€šé“æè¿°ç¬¦</li><li><code>cudaArray_t, cudaSurfaceObject_t, cudaTextureObject_t</code>ä¸ºcudaä¸­å¸¸ç”¨çš„ä¸‰ç§æ•°æ®ç±»å‹æ ¼å¼ï¼Œåˆ†åˆ«ä¸ºæ•°ç»„ç±»å‹ã€è¡¨é¢å¯¹è±¡å’Œçº¹ç†å¯¹è±¡ã€‚è¡¨é¢å¯¹è±¡å’Œçº¹ç†å¯¹è±¡é€šå¸¸ä¼šç»‘å®šåˆ°cudaæ•°ç»„<ol><li>è‹¥å°†<code>cudaArray_t, cudaSurfaceObject_t, cudaTextureObject_t</code>åˆ©ç”¨<code>CreateCudaTextureAndSurfaceObject</code>çš„æ–¹å¼è¿›è¡Œç»‘å®šï¼Œå®é™…ä¸Šcudaæ•°ç»„ã€è¡¨é¢å¯¹è±¡å’Œçº¹ç†å¯¹è±¡éƒ½ç»‘å®šåœ¨åŒä¸€ä¸ªæ˜¾å­˜åŒºé—´ä¸­ï¼Œä»…æ˜¯å¯¹è±¡è¯»å†™æ–¹å¼ä¸åŒ</li><li><code>cudaArray_t</code>ä¸ºcudaæ•°ç»„å¯¹è±¡ï¼Œæ˜¯æœ€é‡è¦çš„ä¸€ä¸ªå¯¹è±¡ï¼Œåœ¨å®Œæˆcudaæ•°ç»„å¯¹è±¡çš„ç”³è¯·å’Œåˆ†é…åï¼Œæ‰å¯ä»¥å°†ç›¸åº”çš„çº¹ç†å¯¹è±¡ã€è¡¨é¢å¯¹è±¡ç­‰ç»‘å®šåˆ°æ•°ç»„å¯¹è±¡ä¸­ï¼Œå¹¶ä¸”ä½¿ç”¨cudaæ•°ç»„å¯¹è±¡èƒ½æ›´æ–¹ä¾¿åœ°ä¸Hostå¯¹è±¡è¿›è¡Œæ•°æ®åŒæ­¥</li><li><code>cudaTextureObject_t</code>å¯è¯»ä¸å¯å†™ï¼Œå…¶è¯»å–é€Ÿåº¦å¯èƒ½æ¯”<code>cudaSurfaceObject_t</code>çš„é€Ÿåº¦å¿«ï¼ˆæœªè¯å®ï¼‰ã€‚çº¹ç†å¯¹è±¡ä¼šè‡ªåŠ¨å®ç°æ’å€¼ï¼Œå³è‹¥å–å€¼ä¸ºuvä¸­æ²¡æœ‰æ°å¥½è½åœ¨æŸä¸ªåƒç´ çš„æ—¶å€™ï¼Œçº¹ç†å¯¹è±¡ä¼šè‡ªåŠ¨æ’å€¼ç”Ÿæˆå¯¹åº”å€¼</li><li><code>cudaSurfaceObject_t</code>å¯å†™ï¼Œåœ¨å¯¹<code>cudaArray_t</code>éœ€è¦è¿›è¡Œæ›´æ”¹çš„æƒ…å†µä¸‹ä¸€èˆ¬éƒ½ä¼šå°†æ•°ç»„å¯¹è±¡å’Œè¡¨é¢å¯¹è±¡è¿›è¡Œç»‘å®šï¼Œå¹¶é€šè¿‡cuda kernelä¸­<code>surf2Dwrite</code>å‡½æ•°å°†æ›´æ–°åçš„æ•°å€¼å†™å…¥è¡¨é¢å¯¹è±¡ä¸­ï¼Œç”±äºè¡¨é¢å¯¹è±¡å’Œæ•°ç»„å¯¹è±¡æ˜¯åŒä¸€ä¸ªç»‘å®šï¼Œå› æ­¤cudaæ•°ç»„å®Œæˆäº†æ›´æ–°</li></ol></li><li><code>cudaMallocArray</code>æ˜¯å°†æ•°ç»„å¯¹è±¡åœ¨GPUä¸­åˆ†é…å¯¹åº”æ˜¾å­˜ç©ºé—´çš„å‡½æ•°ï¼Œç±»ä¼¼äºCPUä¸­åˆ†é…å†…å­˜çš„å‡½æ•°<code>Malloc</code>ã€‚ä½†åœ¨å¯¹cudaå¯¹è±¡è¿›è¡Œæ˜¾å­˜åˆ†é…çš„è¿‡ç¨‹ä¸­ï¼Œé™¤äº†cudaæ•°ç»„å¯¹è±¡ã€é•¿å®½å’Œç±»å‹å¤–ï¼Œä½¿ç”¨é€šé“æè¿°ç¬¦æ¥å®Œæˆcudaæ•°ç»„å¯¹è±¡ç±»å‹çš„ä¼ å…¥ï¼Œå¦‚<code>uchar, float4</code>ç­‰</li><li><code>cudaCreateTextureObject, cudaCreateSurfaceObject</code>æ˜¯å°†cudaæ•°ç»„å¯¹è±¡ä¸è¡¨é¢å¯¹è±¡å’Œçº¹ç†å¯¹è±¡è¿›è¡Œç»‘å®šçš„å‡½æ•°ï¼Œå°†è¡¨é¢å¯¹è±¡å’Œçº¹ç†å¯¹è±¡ä¸cudaæ•°ç»„å¯¹è±¡ç»‘å®šåå°±èƒ½å¤Ÿä½¿ç”¨ç›¸åº”å¯¹è±¡å®Œæˆåç»­æ“ä½œ</li><li><code>cudaDestroyTextureObject, cudaDestroySurfaceObject</code>æ˜¯å°†è¡¨é¢å¯¹è±¡å’Œçº¹ç†å¯¹è±¡è¿›è¡Œé”€æ¯</li><li><code>cudaFreeArray</code>æ˜¯å°†cudaæ•°ç»„å¯¹è±¡ç”³è¯·çš„GPUæ˜¾å­˜è¿›è¡Œé‡Šæ”¾</li><li><code>cudaMemcpy2DToArray, cudaMemcpy2DFromArray</code>åˆ†åˆ«æ˜¯å°†Hostå¯¹è±¡æ‹·è´åˆ°Deviceå’ŒDeviceå¯¹è±¡æ‹·è´åˆ°Host</li><li><code>surf2Dwrite</code>æ˜¯å°†å¯¹åº”2Dç‚¹çš„å€¼å†™å…¥åˆ°<code>cudaSurfaceObject_t</code>çš„è¡¨é¢å¯¹è±¡ä¸­ï¼Œcudaæ•°ç»„å¯¹è±¡ä¸è¡¨é¢å¯¹è±¡ç»‘å®šåå¹¶åˆ›å»ºæ ¼å¼ä¸º<code>cudaArraySurfaceLoadStore</code>åå¯ä»¥ä½¿ç”¨æ­¤æ–¹å¼è¿›è¡Œæ›´æ”¹ï¼ŒåŒæ ·çš„è¡¨é¢å¯¹è±¡è¯»å–å¯ä»¥ä½¿ç”¨<code>surf2Dread</code>çš„æ–¹å¼å®Œæˆ</li><li><code>cudaSafeCall</code>ï¼Œæ£€æŸ¥cudaå‡½æ•°è¿”å›å€¼æ˜¯å¦æ­£ç¡®çš„åˆ¤å®šå®</li></ul><h1 id="CUDAæ ¸å‡½æ•°"><a href="#CUDAæ ¸å‡½æ•°" class="headerlink" title="CUDAæ ¸å‡½æ•°"></a>CUDAæ ¸å‡½æ•°</h1><p>åœ¨CUDA C++çš„<code>.cu</code>æ–‡ä»¶ä¸­ï¼Œå‡½æ•°å‰ç¼€åˆ†ä¸º<code>__host__, __global__, __device__</code>ä¸‰ç§</p><ul><li><code>__host__</code>ä¸ºHostè°ƒç”¨çš„å‡½æ•°ï¼Œæ­¤ç±»å‹å‡½æ•°æ— æ³•è¢«GPUè°ƒç”¨ï¼Œæ— æ³•è¢«<code>__global__</code>å’Œ<code>__device__</code>è°ƒç”¨ã€‚è‹¥å‡½æ•°æœªè¡¨æ˜å‰ç¼€ï¼Œé»˜è®¤ä¸ºæ­¤å‰ç¼€ç±»å‹</li><li><code>__global__</code>å‰ç¼€ä»£è¡¨æ­¤å‡½æ•°ä¸ºæ ¸å‡½æ•°ï¼Œå¯ä»¥åœ¨Hostä¸­è°ƒç”¨ï¼Œè¢«Deviceæ‰§è¡Œï¼Œå¹¶ä¸”æ­¤å‡½æ•°å¯ä»¥è°ƒç”¨<code>__device__</code>å‰ç¼€çš„å‡½æ•°ï¼Œå‡½æ•°ä½¿ç”¨ä¸¥æ ¼æŒ‰ç…§&lt;&lt;&lt;grid, block&gt;&gt;&gt;çš„æ–¹å¼è¿›è¡Œï¼Œå‡½æ•°è¿”å›ç±»å‹å¿…é¡»æ˜¯<code>void</code>ï¼Œä¸æ”¯æŒå¯å˜å‚æ•°å‚æ•°ï¼Œä¸èƒ½æˆä¸ºç±»æˆå‘˜å‡½æ•°ã€‚ç”¨<code>__global__</code>å®šä¹‰çš„kernelæ˜¯å¼‚æ­¥çš„ï¼Œè¿™æ„å‘³ç€Hostä¸ä¼šç­‰å¾…Kernelæ‰§è¡Œå®Œå°±æ‰§è¡Œä¸‹ä¸€æ­¥</li><li><code>__device__</code>å‰ç¼€è¡¨æ˜æ­¤å‡½æ•°æ˜¯åœ¨GPUä¸­è¿è¡Œçš„ï¼Œæ— æ³•ç›´æ¥è¢«CPUå‡½æ•°è°ƒç”¨</li><li><code>__host__</code>å’Œ<code>__device__</code>å¯ä»¥åŒæ—¶ä½¿ç”¨</li></ul><p>ç”±äºCUDAæ ¸å‡½æ•°ä¸­æœ‰ä¸åŒçš„çº¿ç¨‹ï¼Œå› æ­¤éœ€è¦ä¼ å…¥gridå’Œblockå‚æ•°ç»™CUDAæ ¸å‡½æ•°è¿›è¡Œä½¿ç”¨ã€‚åœ¨CUDAæ ¸å‡½æ•°ç¼–å†™çš„æ—¶å€™ï¼Œéœ€è¦å…ˆè®¡ç®—å‡ºå½“å‰æ‰€åœ¨çš„çº¿ç¨‹idxï¼Œç„¶ååœ¨å‚ä¸è®¡ç®—ã€‚ä¸€ä¸ªçº¿ç¨‹å—ä¸Šçš„çº¿ç¨‹æ˜¯æ”¾åœ¨åŒä¸€ä¸ªæµå¼å¤šå¤„ç†å™¨ï¼ˆStreaming Multiprocessorï¼ŒSMï¼‰ä¸Šçš„ï¼Œä½†æ˜¯å•ä¸ªSMçš„èµ„æºæœ‰é™ï¼Œè¿™å¯¼è‡´çº¿ç¨‹å—ä¸­çš„çº¿ç¨‹æ•°æ˜¯æœ‰é™åˆ¶çš„ï¼Œç°åœ¨çš„GPUçº¿ç¨‹å—å¯æ”¯æŒçš„çº¿ç¨‹æ•°å¯è¾¾1024ä¸ªã€‚å½“æˆ‘ä»¬è¦çŸ¥é“ä¸€ä¸ªçº¿ç¨‹åœ¨blcokä¸­çš„å…¨å±€IDï¼Œå°±å¿…é¡»è¿˜è¦çŸ¥é“blockçš„ç»„ç»‡ç»“æ„ï¼Œè¿™æ˜¯é€šè¿‡çº¿ç¨‹çš„å†…ç½®å˜é‡blockDimæ¥è·å¾—ã€‚å®ƒè·å–çº¿ç¨‹å—å„ä¸ªç»´åº¦çš„å¤§å°ã€‚å¯¹äºä¸€ä¸ª2-dimçš„block$(D_x,D_y)$ï¼Œçº¿ç¨‹$(x,y)$çš„IDå€¼ä¸º$x+y\cdot D_x$ï¼Œå¦‚æœæ˜¯3-dimçš„block$(D_x,D_y,D_z)$ï¼Œçº¿ç¨‹$(x,y,z)$çš„IDå€¼ä¸º$x+y\cdot D_x+z\cdot D_x\cdot D_y$ã€‚å¦å¤–çº¿ç¨‹è¿˜æœ‰å†…ç½®å˜é‡gridDimï¼Œç”¨äºè·å¾—ç½‘æ ¼å—å„ä¸ªç»´åº¦çš„å¤§å°ã€‚</p><p>å¦‚åœ¨2-dimçš„æ ¸å‡½æ•°ä¸­ï¼Œä¸€èˆ¬æœ‰</p><p>$$<br>int \ \ pidx &#x3D;  blockIdx.x * blockDim.x + threadIdx.x \ int \ \ pidy &#x3D;  blockIdx.y * blockDim.y + threadIdx.y<br>$$</p><p>CUDAçš„å†…å­˜æ¨¡å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚å¯ä»¥çœ‹åˆ°ï¼Œæ¯ä¸ªçº¿ç¨‹æœ‰è‡ªå·±çš„ç§æœ‰æœ¬åœ°å†…å­˜ï¼ˆLocal Memoryï¼‰ï¼Œè€Œæ¯ä¸ªçº¿ç¨‹å—æœ‰åŒ…å«å…±äº«å†…å­˜ï¼ˆShared Memoryï¼‰,å¯ä»¥è¢«çº¿ç¨‹å—ä¸­æ‰€æœ‰çº¿ç¨‹å…±äº«ï¼Œå…¶ç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹å—ä¸€è‡´ã€‚æ­¤å¤–ï¼Œæ‰€æœ‰çš„çº¿ç¨‹éƒ½å¯ä»¥è®¿é—®å…¨å±€å†…å­˜ï¼ˆGlobal Memoryï¼‰ã€‚è¿˜å¯ä»¥è®¿é—®ä¸€äº›åªè¯»å†…å­˜å—ï¼šå¸¸é‡å†…å­˜ï¼ˆConstant Memoryï¼‰å’Œçº¹ç†å†…å­˜ï¼ˆTexture Memoryï¼‰ã€‚</p><p><img src="/./2022/06/25/CUDA%E6%9E%81%E7%AE%80%E5%85%A5%E9%97%A8/CUDAMemModel.png" alt="CUDA Memory Model"></p><p>ä¸€ä¸ªSMçš„åŸºæœ¬æ‰§è¡Œå•å…ƒæ˜¯åŒ…å«32ä¸ªçº¿ç¨‹çš„çº¿ç¨‹æŸï¼Œå› æ­¤blockå¤§å°ä¸€èˆ¬è®¾ç½®ä¸º32çš„å€æ•°ã€‚</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://zhuanlan.zhihu.com/p/34587739">CUDAç¼–ç¨‹å…¥é—¨æç®€æ•™ç¨‹</a></p><p><a href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html">Programming Guide :: CUDA Toolkit Documentation</a></p>]]></content>
    
    
    <categories>
      
      <category>CUDA</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CUDA</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è‹ä¹‹å½¼æ–¹çš„å››é‡å¥</title>
    <link href="/2022/06/25/%E8%8B%8D%E4%B9%8B%E5%BD%BC%E6%96%B9%E7%9A%84%E5%9B%9B%E9%87%8D%E5%A5%8F/"/>
    <url>/2022/06/25/%E8%8B%8D%E4%B9%8B%E5%BD%BC%E6%96%B9%E7%9A%84%E5%9B%9B%E9%87%8D%E5%A5%8F/</url>
    
    <content type="html"><![CDATA[<h1 id="è‹ä¹‹å½¼æ–¹çš„å››é‡å¥"><a href="#è‹ä¹‹å½¼æ–¹çš„å››é‡å¥" class="headerlink" title="è‹ä¹‹å½¼æ–¹çš„å››é‡å¥"></a>è‹ä¹‹å½¼æ–¹çš„å››é‡å¥</h1><blockquote><p>ææƒ§ã€é€ƒé¿å¼ºè€…äººä¹‹å¸¸æƒ…ï¼Œä½†å¥‹åŠ›ä¸€æè‡³å°‘èƒ½æ”¶è·æ²¿é€”é£æ™¯ã€‚</p></blockquote><h1 id="æ¸¸æˆèƒŒæ™¯"><a href="#æ¸¸æˆèƒŒæ™¯" class="headerlink" title="æ¸¸æˆèƒŒæ™¯"></a>æ¸¸æˆèƒŒæ™¯</h1><ul><li>äººä»¬å‘ç°äº†åé‡åŠ›å­ï¼Œå¹¶ç”¨æ­¤åˆ¶ä½œäº†èƒ½è®©äººä»¬åœ¨ç©ºä¸­é£è¡Œçš„é£è¡Œé‹</li><li>Flying Circusï¼ˆFCï¼‰ï¼Œä½¿ç”¨é£è¡Œé‹è¿›è¡Œçš„ç«æŠ€è¿åŠ¨</li><li>è¿åŠ¨é‹åˆ†ä¸ºç«æŠ€å‹å’Œæ™®é€šå‹ï¼Œç«æŠ€å‹åˆåˆ†ä¸ºé€Ÿåº¦å‹ã€æˆ˜æ–—å‹å’Œå…¨èƒ½å‹ï¼Œå¯ä»¥é€šè¿‡è°ƒå‚æ¥æ”¹å˜ç«æŠ€å‹è¿åŠ¨é‹çš„æ¨¡å¼</li><li>åœ¨ä¹…å¥ˆå²›ï¼Œä½¿ç”¨é£è¡Œé‹å‡ºè¡Œè¾ƒä¸ºæ™®é</li></ul><hr><h1 id="æ•…äº‹èƒŒæ™¯"><a href="#æ•…äº‹èƒŒæ™¯" class="headerlink" title="æ•…äº‹èƒŒæ™¯"></a>æ•…äº‹èƒŒæ™¯</h1><p>æ›¾ç»çš„FCå¤©æ‰å°‘å¹´<strong>æ—¥å‘æ™¶ä¹Ÿ</strong>ï¼ˆç”·ä¸»ï¼‰åœ¨ä¸€æ¬¡é‡å¤§æŒ«æŠ˜åï¼Œé€‰æ‹©ç»“æŸè‡ªå·±FCç«æŠ€ç”Ÿæ¶¯ã€‚ä½†çªç„¶æœ‰ä¸€å¤©ä»–é‡åˆ°äº†ä¸€åè½¬æ ¡ç”Ÿ<strong>ä»“ç§‘æ˜æ—¥é¦™</strong>ï¼Œä¸ºäº†é¿å…è¿Ÿåˆ°æ™¶ä¹Ÿå¸¦ç€æ˜æ—¥é¦™ä½¿ç”¨é£è¡Œé‹é£åˆ°äº†å­¦æ ¡ï¼Œæ˜æ—¥é¦™å› æ­¤å¯¹é£è¡Œé‹äº§ç”Ÿäº†æµ“åšçš„å…´è¶£ã€‚è€å¸ˆ<strong>å„åŠ¡è‘µ</strong>å‘ç°æ™¶ä¹Ÿç«Ÿç„¶é‡‡ç”¨é£è¡Œé‹æ¥ä¸Šå­¦ï¼Œäºæ˜¯æ•™å”†æ™¶ä¹ŸæŒ‡å¯¼æ˜æ—¥é¦™ä½¿ç”¨é£è¡Œé‹ã€‚</p><p>åœ¨æ•™å­¦çš„è¿‡ç¨‹ä¸­å¶ç„¶ç¢°è§æœ‰äººè¿›è¡ŒFCå¯¹å†³ï¼Œæ˜æ—¥é¦™å¼€å§‹å¯¹FCäº§ç”Ÿæå¤§çš„å…´è¶£ã€‚æœºç¼˜å·§åˆä¸‹ï¼Œæ™¶ä¹Ÿä¸»å¼€å§‹æ‰§æ•™å­¦æ ¡FCéƒ¨ï¼Œä¸å†ä»¥å¤©æ‰å°‘å¹´è€Œæ˜¯ä»¥æ•™ç»ƒçš„èº«ä»½å¼€å§‹äº†æ–°çš„FCç”Ÿæ¶¯å±•å¼€çš„æ•…äº‹ã€‚</p><hr><h1 id="å‰§æƒ…æ„Ÿå—"><a href="#å‰§æƒ…æ„Ÿå—" class="headerlink" title="å‰§æƒ…æ„Ÿå—"></a>å‰§æƒ…æ„Ÿå—</h1><p><em><strong>ä»¥ä¸‹å†…å®¹åŒ…å«å‰§é€</strong></em></p><p>å„åŠ¡è‘µè€å¸ˆä¸ä»…ä»…æ˜¯ç°åœ¨æ™¶ä¹Ÿçš„ç­çº§æ•™å¸ˆï¼Œè€Œä¸”æ˜¯FCé¢†åŸŸéå¸¸çŸ¥åçš„ä¸€ä½äººç‰©ï¼Œå…·æœ‰é«˜è¶…çš„æŠ€å·§å’Œå‡ºè‰²çš„è¿åŠ¨èƒ½åŠ›ï¼Œå¥¹çœ‹ä¸­äº†æ™¶ä¹Ÿå‡ºè‰²çš„è¿åŠ¨èƒ½åŠ›å’ŒFCå¤©èµ‹ï¼Œå¹¶ä¸”åœ¨æ™¶ä¹Ÿå¯¹FCæœ‰æµ“åšå…´è¶£çš„åŒæ—¶æŒ‡å¯¼ä»–æˆä¸ºäº†åŒå¹´é¾„ä¸­éå¸¸å‡ºè‰²çš„ä¸€åFCé€‰æ‰‹ã€‚ä½†åœ¨æŸä¸€å¤©ï¼Œæ™¶ä¹Ÿåœ¨æ²™æ»©è¾¹é‡åˆ°äº†ä¸€åå’Œä»–å¹´é¾„å·®ä¸å¤šå¤§çš„äººï¼Œåœ¨æ•°æ¬¡çš„FCé£è¡Œåæ™¶ä¹Ÿå‘ç°è¿™ä¸ªäººæœ‰ç€éå¸¸æ°å‡ºçš„èƒ½åŠ›ï¼Œè‡ªå·±é•¿æœŸæ‰€å­¦éƒ½å¿«èµ¶ä¸ä¸Šè¿™äººçš„å¤©èµ‹ï¼Œäºæ˜¯ç”·ä¸»å¤±å»äº†ä¿¡å¿ƒå¹¶æ”¾å¼ƒäº†FCç«æŠ€ã€‚</p><p>åœ¨æ™¶ä¹Ÿç¬¬ä¸€æ¬¡é‡åˆ°æ˜æ—¥é¦™æ—¶ï¼Œç¬¬ä¸€ååº”æ˜¯æ˜æ—¥é¦™åº”è¯¥å°±æ˜¯ç”·ä¸»å½“å¹´é‡åˆ°çš„äººï¼Œä½†æ˜¯æ˜æ—¥é¦™å±•ç°å‡ºçš„å¯¹é£è¡Œé‹ä¸€æ— æ‰€çŸ¥å¯ä»¥å‘ç°å¹¶ä¸æ˜¯å¦‚æ­¤ã€‚è€Œåœ¨ç­çº§é‡Œï¼Œç”·ä¸»åŒçº§ç”Ÿ<strong>é¸¢æ³½ç¾å’²</strong>æ˜¯ä¸€ä½å¤©æ‰å°‘å¥³ï¼Œå¯¹äºå­¦ä¹ ã€è¿åŠ¨ä»¥åŠFCéƒ½æœ‰ç€å‡ºè‰²çš„èƒ½åŠ›ï¼Œåœ¨æ¯ä¸€é¡¹ä»»åŠ¡ä¸­ç¾å’²éƒ½ä¸éœ€è¦å‡ºå¾ˆå¤šçš„åŠ›æ°”å°±èƒ½å–å¾—å¾ˆå‡ºè‰²çš„æˆç»©ã€‚ä»è¿™å°±å¯ä»¥çœ‹å‡ºç¾å’²åº”è¯¥å°±æ˜¯å½“å¹´æ™¶ä¹Ÿé‡åˆ°çš„å­©å­ï¼Œè™½ç„¶åœ¨æ™¶ä¹Ÿçš„å°è±¡ä¸­æ˜¯ä¸€ä¸ªç”·å­©å­ä¸ä»–è¿›è¡Œçš„æ¯”è¯•ï¼Œä½†99.99%ï¼ˆè¯ä¸èƒ½è¯´æ­»ï¼‰ä¸€å®šæ˜¯ç”·ä¸»è®°é”™äº†ã€‚</p><p>ç¾å’²æœ‰ä¸€ä¸ªå–œæ¬¢å¥¹çš„å­¦å¦¹<strong>æœ‰å‚çœŸç™½</strong>ï¼Œè§†æ™¶ä¹Ÿä¸ºæ•Œäººå¹¶çˆ±ç©æ¸¸æˆã€‚æ™¶ä¹Ÿåœ¨æŸä¸€å¤©ä¸Šå­¦æ—¶è§åˆ°ä¸€ä½é£è¡Œå§¿åŠ¿ç‰¹åˆ«ä¼˜ç¾çš„å°‘å¥³ï¼Œè¿™åå°‘å¥³<strong>å¸‚ä¹‹æ¿‘è‰ä½³</strong>æ¬åˆ°äº†ä»–å®¶éš”å£å±…ä½ï¼Œå¥¹æ˜¯é«˜è—¤å­¦é™¢çš„FCéƒ¨æˆå‘˜ã€‚å°±æ­¤ï¼Œå››ä½å¯æ”»ç•¥çš„å¥³ä¸»è§’å…¨éƒ¨å‡ºç°ã€‚</p><p>åœ¨å…±é€šçº¿ï¼ˆç¬¬å…­ç« ç»“æŸå‰ï¼‰ä¸­ï¼Œæ™¶ä¹Ÿä»–ä»¬ä¸é«˜è—¤å­¦é™¢è¿›è¡Œäº†å­¦ä¹ äº¤æµï¼Œè€Œç¾å’²ä¸€ç›´æƒ³è¦å‡»è´¥çš„<strong>çœŸè—¤ä¸€æˆ</strong>ï¼ˆé«˜è—¤å­¦é™¢FCä¼šé•¿ï¼‰ï¼Œåœ¨å’Œç¾å’²çš„æ¯”æ‹¼ä¸­å¹¶æ²¡æœ‰ç”¨ä¸Šå…¨åŠ›ï¼Œåè€Œæ˜¯ä¸æ˜æ—¥é¦™çš„æ¯”èµ›ä¸­ç”¨å°½äº†å…¨åŠ›ã€‚åŒæ—¶åœ¨å¤å­£å¤§ä¼šä¸­ï¼ŒçœŸè—¤ä¸€æˆè¢«<strong>ä¹¾æ²™å¸Œ</strong>å‡»è´¥ï¼Œæ²™å¸Œåœ¨æ¯”èµ›ä¸­å®Œç¾æ“æ§äº†æ‰€æœ‰çš„èŠ‚å¥ï¼Œè¿™è®©ä¸€æˆæ„Ÿåˆ°éå¸¸æ— åŠ›ã€‚åŒæ—¶ï¼Œæ™¶ä¹Ÿå’Œç¾å’²éƒ½å¯¹è¿™ç§FCæ–¹å¼æ„Ÿåˆ°å¾ˆéœ‡æƒŠï¼Œè®¤ä¸ºè‡ªå·±æ‰€å­¦ä¹ çš„FCæ–¹å¼æ‰æ˜¯çœŸæ­£çš„FCï¼ŒæŒæ§åˆ«äººçš„æ¯”èµ›æ˜¾å¾—ä¸ä¼˜ç¾ã€‚ä½†æ˜æ—¥é¦™å´å¯¹æ²™å¸Œçš„æŠ€å·§æ„Ÿåˆ°ç”±è¡·çš„èµå¹ã€‚</p><p>åˆ°æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œè™½ç„¶æ™¶ä¹Ÿå’Œç¾å’²éƒ½è¢«ç§°ä½œå¤©æ‰ï¼Œä½†å’ŒçœŸæ­£æœ‰å¤©èµ‹çš„æ˜æ—¥é¦™æ¯”èµ·æ¥å´æ˜¾å¾—éå¸¸æ¸ºå°ã€‚æ˜æ—¥é¦™èƒ½å¤Ÿçœ‹å‡ºå…¶ä¸­çš„ä¹è¶£å¹¶å¸Œæœ›èƒ½å¤ŸæŒæ¡ç›¸å…³çš„æ–¹æ³•ã€‚è¿™æ—¶çš„æ™¶ä¹Ÿå’Œç¾å’²ï¼Œè™½ç„¶å·²ç»æ˜¯å¸¸äººçœ¼ä¸­çš„å¤©æ‰ï¼Œä½†åœ¨çœŸæ­£çš„å¤©æ‰é¢å‰å´å¦‚ç§‰çƒ›ä¹‹ç«ã€‚ä¸ºäº†ç»§ç»­è¿›è¡Œæ¯”èµ›ï¼Œä¸ºäº†èƒ½å¤Ÿä¸æ²™å¸Œä¸€å†³é«˜ä¸‹ï¼Œå¥³ä¸»ä»¬ä¼šæ¥é‚€è¯·æ™¶ä¹Ÿå½“å¥¹ä»¬çš„æŒ‡å¯¼è€å¸ˆï¼Œä»æ­¤å¼€å§‹ä¸åŒçš„äººç‰©çº¿ã€‚</p><p>æ•´ä¸ªæ•…äº‹èµ°å®Œä¸ªäººæœ€å–œæ¬¢çš„æ˜¯ç¾å’²çº¿ï¼Œç»™æˆ‘æœ€çœŸå®æ„Ÿå—çš„ä¹Ÿæ˜¯ç¾å’²çº¿ã€‚</p><p>åœ¨ç¾å’²çº¿ä¸­ï¼Œæ™¶ä¹ŸçŸ¥é“äº†å½“å¹´ä¸ä»–æ¯”è¯•çš„é‚£åå°‘å¹´ï¼Œé‚£åè®©ä»–æ”¾å¼ƒäº†FCæ¢¦æƒ³ï¼Œè®©ä»–æ”¾å¼ƒäº†åœ¨å¤©ç©ºä¸­è‡ªç”±é£ç¿”çš„å°‘å¹´ï¼Œå°±æ˜¯ç¾å’²ã€‚ä¸¤äººéƒ½æ˜¯åˆ«äººçœ¼ä¸­çš„å¤©æ‰ï¼Œå´åˆéƒ½åœ¨çœŸæ­£çš„å¤©æ‰é¢å‰é»¯ç„¶å¤±è‰²ã€‚æˆ‘æœ¬ä»¥ä¸ºç¾å’²çš„äººè®¾æ˜¯å¯¹ä»€ä¹ˆéƒ½å¾ˆå¿«ä¸Šæ‰‹èƒ½å–å¾—ä¼˜å¼‚çš„æˆç»©ï¼Œä½†æ²¡æœ‰å¾ˆå¥½çš„å¯¹æ‰‹è®©å¥¹èƒ½å¤Ÿåœ¨ä¸€ä»¶äº‹æƒ…ä¸Šä¿æŒé«˜åº¦çš„ä¸“æ³¨ã€‚ä½†æ˜¯åœ¨ã€Šè‹å½¼ã€‹ä¸­ï¼Œç¾å’²å’Œæ™¶ä¹Ÿä¸€æ ·ï¼Œéƒ½ä¼šå¯¹æœ‰çœŸæ­£æ°å‡ºæ‰èƒ½çš„äººæ„Ÿåˆ°ææƒ§ï¼Œæ„Ÿåˆ°å®³æ€•ã€‚</p><p>åœ¨ç¾å’²çº¿é‡Œï¼Œæ™¶ä¹Ÿå’Œç¾å’²ä¸¤ä¸ªç›¸ä¼¼çš„äººï¼Œéƒ½ä¼šå¯¹å¤©æ‰æ„Ÿåˆ°ææƒ§å®³æ€•çš„äººï¼Œäº’ç›¸æ‰¶æŒç€å¯¹æ–¹ï¼Œæˆä¸ºå¯¹æ–¹çš„åŠ©åŠ›ã€‚æ™¶ä¹Ÿå¯¹ç¾å’²çš„FCæ•™å­¦ä¸­ï¼Œå‘ç°äº†ç ´è§£æ²™å¸Œå¥—è·¯çš„æ–¹å¼ï¼Œè€Œç¾å’²è¿™æ¬¡æœ‰äº†æ™¶ä¹Ÿçš„é¼“åŠ±å’Œé™ªä¼´ä¹Ÿä¸å†ç•æ‰‹ç•è„šï¼Œå¸Œæœ›èƒ½å¤Ÿå®Œæˆæ™¶ä¹Ÿçš„æ¢¦æƒ³è€ŒåŠªåŠ›ç»ƒä¹ ï¼Œå¹¶æœ€ç»ˆå‡»è´¥äº†æ²™å¸Œå’Œæ˜æ—¥é¦™å–å¾—äº†å† å†›ã€‚</p><p>å¯¹å¤©æ‰ã€å¯¹æ¯”è‡ªå·±æ›´æœ‰æ‰èƒ½çš„äººæ„Ÿåˆ°ææƒ§ã€å«‰å¦’å¯¹æ™®é€šäººæ¥è¯´æ˜¯ä¸€ä»¶éå¸¸æ­£å¸¸çš„äº‹æƒ…ã€‚ä½œä¸ºæ¯”æ™®é€šäººæ›´å¼ºã€åœ¨å¾ˆå¤šäººä¸¥é‡éƒ½æ˜¯å¤©æ‰çš„æ™¶ä¹Ÿå’Œç¾å’²è€Œè¨€ï¼Œä»–ä»¬å¯¹æ˜æ—¥é¦™çš„æ„Ÿè§¦å°±å’Œæ™®é€šäººå¯¹ä»–ä»¬çš„æ„Ÿè§¦ä¸€æ ·ï¼Œåªæ˜¯å¯¹äºä»–ä»¬è€Œè¨€å¾ˆå°‘ä¼šæ„Ÿå—åˆ°è¿™ç§æƒ…æ„Ÿç½¢äº†ã€‚æ™¶ä¹Ÿåœ¨ç¾å’²é¢å‰é€‰æ‹©äº†é€€ç¼©ï¼Œç¾å’²åœ¨æ˜æ—¥é¦™é¢å‰ä¹Ÿé€‰æ‹©äº†é€€ç¼©ã€‚å½“äººä»¬å¯¹è‡ªå·±æ„Ÿåˆ°æ— æ³•ç™»ä¸Šçš„é«˜å³°æ—¶ï¼Œé€‰æ‹©æ”¾å¼ƒä¹Ÿæ˜¯å¾ˆæ­£å¸¸çš„ï¼ŒåšæŒå¯èƒ½ä¼šè®©ä½ éä½“é³ä¼¤å´ä¸èƒ½è¾¾åˆ°ç›®çš„ï¼Œä½†å¾ˆæœ‰å¯èƒ½ä¼šè®©ä½ å¾æœè¿™åº§å±±å³°ã€‚æ™¶ä¹Ÿåæ‚”äº†ï¼Œåæ‚”è‡ªå·±æ²¡æœ‰ç»§ç»­æ”¾æ‰‹ä¸€æï¼Œä»–ä¸æƒ³è®©è‡ªå·±å–œçˆ±çš„ç¾å’²ä¹Ÿèµ°ä¸Šä»–è¿™ä¸€æ¡è€è·¯ï¼Œæ¯•ç«Ÿæ”¾å¼ƒæ„å‘³ç€é—æ†¾è€Œä¸æ˜¯æ”¾ä¸‹ã€‚ç¾å’²ä¹Ÿä¸ºäº†å®Œæˆæ™¶ä¹Ÿæœªå®ç°çš„æ¢¦æƒ³è€Œç»§ç»­åŠªåŠ›æ‹¼æï¼Œé¢å¯¹å¤©æ‰ä»¬ä¹Ÿä¸éœ²æ€¯è‰²è¿éš¾è€Œä¸Šã€‚</p><p>å¾ˆå¤šäººè¯´ç¾å’²çº¿æ˜¯æ™®é€šäººçš„ä¸€æ¡çº¿ï¼Œå¥¹èƒ†æ€¯ï¼Œå¥¹é€€ç¼©ï¼Œä½†å¥¹é‡åˆ°äº†æ™¶ä¹Ÿèƒ½å¤Ÿè®©å¥¹è¿éš¾è€Œä¸Šã€‚ä½†æˆ‘è§‰å¾—ç¾å’²çº¿å¹¶ä¸æ˜¯æ™®é€šäººçš„çº¿ï¼Œå› ä¸ºå¥¹æ›¾æ˜¯å¤©æ‰ï¼Œå¥¹å¯¹å¾ˆå¤šäº‹ç‰©éƒ½èƒ½å¤Ÿä¸èŠ±è´¹åŠ›æ°”å°±å–å¾—å¾ˆå¥½çš„æˆæœã€‚åœ¨ä»–äººçš„çœ¼ä¸­å·²ç„¶æ˜¯ä¸ªå¤©æ‰çš„å¥¹ï¼Œå·²ç„¶æ˜¯ä¸ªå¤©æ‰çš„æ™¶ä¹Ÿä¹Ÿåªæ˜¯æ¯”æ™®é€šäººæ›´æœ‰ä¸€ä¸å¤©èµ‹ç½¢äº†ã€‚æˆ‘ä»¬è§åˆ°æ™¶ä¹Ÿã€ç¾å’²çš„æ—¶å€™éƒ½ä¼šè‡ªå˜²æ— æ³•è¿½èµ¶è€Œåœä¸‹åŠªåŠ›ï¼Œæ›´ä½•å†µé‡åˆ°çœŸæ­£çš„å¤©æ‰å‘¢ï¼Ÿè§‰å¾—ä¸å¤§ä½¬ä»¬ä¹‹é—´å·®è·å¾ˆå¤§æ˜¯ä¸å‡ï¼Œä½†å·¨æ“˜ä»¬ä¹Ÿæ˜¯é€šè¿‡ä¸€ç‚¹ä¸€æ»´çš„åŠªåŠ›æ”€ç™»åˆ°ç°åœ¨çš„ä½ç½®ã€‚å¯èƒ½åŠªåŠ›çš„ç»“æœä¼šè®©æˆ‘ä»¬å‘ç°è‡ªå·±çš„æ¸ºå°ï¼Œä½†è‡³å°‘åœ¨è¿‡ç¨‹ä¸­çœ‹åˆ°äº†é£æ™¯ï¼Œä¹Ÿèƒ½æœ‰ç¨è®¸è‡ªå·±çš„ç§¯æ·€ã€‚</p><p>åœ¨æ˜æ—¥é¦™çº¿ä¸­ï¼Œå¤©æ‰çš„å…‰è¾‰è®©æ™¶ä¹Ÿæœ‰äº†è¿›ä¸€æ­¥æ‰§æ•™çš„æœŸæœ›ã€‚ä½†æ–°çš„FCæ¨¡å¼ï¼ˆæ²™å¸Œå¸¦æ¥ï¼‰çš„å‡ºç°è®©æ™¶ä¹Ÿä»–ä»¬éƒ½å­˜åœ¨ä¸€äº›å¿ƒç»“ï¼Œè€Œæ˜æ—¥é¦™çš„è®­ç»ƒå’Œè¿›æ­¥å´è®©ä»–ä»¬ä¸€èµ·å°†è¿™ä¸ªéš¾é¢˜åŒ–è§£ã€‚å¯¹å¾…æ›´æ–°äº‹ç‰©çš„ä¹è§‚æ€åº¦ï¼Œå†…å¿ƒçš„å…´è¶£ä¸æ¸´æœ›æ‰æ˜¯åšæˆä¸€ä»¶äº‹çš„é‡ä¸­ä¹‹é‡ã€‚åœ¨æ„Ÿæƒ…çº¿ä¸­ï¼Œæ˜æ—¥é¦™å¯¹æ™¶ä¹Ÿçš„è¡¨ç™½ä¹Ÿæ˜¯å‰§æƒ…å‘å±•çš„äº§ç‰©ï¼ˆæ²¡é”™ï¼ŒçœŸç™½çº¿å’Œè‰ä½³çº¿æˆ‘éƒ½è§‰å¾—å¾ˆçªå…€ï¼‰ã€‚</p><p>ä½†å¯¹äºæ˜æ—¥é¦™çº¿ï¼Œä¸ªäººæ„Ÿè§¦åè€Œæ˜¯ï¼šçœ‹ï¼Œè¿™å°±æ˜¯å¤©èµ‹ã€‚æ˜æ—¥é¦™çš„FCå¤©èµ‹è¿‡äºè€€çœ¼ï¼Œåœ¨æœ€ç»ˆå¯¹æˆ˜æ²™å¸Œçš„æ—¶å€™ä¹Ÿèƒ½å¤Ÿè¾ƒä¸ºä»å®¹çš„åº”å¯¹ã€‚å…¨çº¿çš„æè¿°ä¹Ÿèƒ½å¤Ÿçœ‹å‡ºæ˜æ—¥é¦™è‡ªèº«ç»½æ”¾å‡ºçš„å…‰èŠ’ï¼Œä½†è¿™å´è®©æˆ‘æ€€ç–‘ï¼šæ²™å¸Œï¼Œå¤©æ‰çš„å¼ºå¤§ï¼Œåªæœ‰é çœŸæ­£çš„å¤©æ‰æ‰èƒ½å°†å…¶å‡»è´¥å—ï¼Ÿå½“ç„¶è‹¥æ˜¯åŠªåŠ›çš„å¤©æ‰èƒ½å¤Ÿè½»æ˜“çš„è¢«æ™®é€šäººå‡»è´¥å´ä¹Ÿæ˜¾å¾—å¾ˆä¸ç°å®ï¼Œä½†æ•´æ¡çº¿ç»™æˆ‘çš„æ„Ÿè§¦æ˜¯åªæœ‰çœŸæ­£éå¸¸å…·æœ‰å¤©èµ‹çš„äººæ‰èƒ½å¤ŸåŠªåŠ›å»è¶…è¶Šé‚£ä¸€é“é¸¿æ²Ÿã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œç¾å’²çº¿ç»™æœ¬äººçš„æ„Ÿè§¦è¦æ›´ä¸ºæ·±åˆ»ã€‚</p><p>è‡³äºçœŸç™½çº¿å’Œè‰ä½³çº¿ï¼Œæˆ‘åªæƒ³è¯´ï¼šçœŸç™½å¥½å¯çˆ±ï¼Œè‰ä½³ä¹Ÿå¯çˆ±ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>review</category>
      
    </categories>
    
    
    <tags>
      
      <tag>game</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ‹–æ²¹ç“¶</title>
    <link href="/2022/06/25/%E6%8B%96%E6%B2%B9%E7%93%B6/"/>
    <url>/2022/06/25/%E6%8B%96%E6%B2%B9%E7%93%B6/</url>
    
    <content type="html"><![CDATA[<h1 id="ç»§æ¯çš„æ‹–æ²¹ç“¶æ˜¯æˆ‘çš„å‰å¥³å‹"><a href="#ç»§æ¯çš„æ‹–æ²¹ç“¶æ˜¯æˆ‘çš„å‰å¥³å‹" class="headerlink" title="ç»§æ¯çš„æ‹–æ²¹ç“¶æ˜¯æˆ‘çš„å‰å¥³å‹"></a>ç»§æ¯çš„æ‹–æ²¹ç“¶æ˜¯æˆ‘çš„å‰å¥³å‹</h1><blockquote><p>ç”œç”œçš„æ‹çˆ±å–œå‰§è°ä¸å–œæ¬¢å‘¢ï¼</p></blockquote><h1 id="æ•…äº‹æ¦‚è¦"><a href="#æ•…äº‹æ¦‚è¦" class="headerlink" title="æ•…äº‹æ¦‚è¦"></a>æ•…äº‹æ¦‚è¦</h1><p><strong>ä¼Šç†æˆ·æ°´æ–—</strong>å’Œ<strong>ç»«äº•ç»“å¥³</strong>éƒ½æ˜¯é˜…è¯»çˆ±å¥½è€…ï¼Œä¸¤äººåˆä¸­æ—¶åœ¨å›¾ä¹¦é¦†ç›¸é‡ï¼Œæ°´æ–—å‘ç°ç»“å¥³æ­£åœ¨åŠªåŠ›åœ°è·å–ä¹¦æŸœæœ€ä¸Šä¸€å±‚çš„ä¸€æœ¬ä¹¦ï¼ˆå¥½è€çš„å¥—è·¯å²‚å¯ä¿®ï¼ï¼‰ï¼Œäºæ˜¯å¸®å¿™å°†ä¹¦æ‹¿ä¸‹å¹¶çŸ¥é“äº†ç»“å¥³æ˜¯ä¸€ä¸ªæ¨ç†å°è¯´çˆ±å¥½è€…ã€‚ä¸¤äººé€šè¿‡è¯»ä¹¦ç»“ç¼˜ï¼Œå¹¶æˆä¸ºäº†æƒ…ä¾£ï¼Œä½†æœ€ç»ˆå´å› å„ç§æ‘©æ“¦é€‰æ‹©äº†åˆ†æ‰‹ã€‚</p><p>ä¼Šç†æˆ·æ°´æ–—æ˜¯ä¸€ä¸ªå•äº²å®¶åº­ï¼Œæ¯äº²åœ¨åˆ†å¨©åå› è™šå¼±è€Œå»ä¸–ã€‚ç»«äº•ç»“å¥³çš„çˆ¶æ¯ä¸å’Œé€‰æ‹©äº†ç¦»å©šï¼Œå¥¹è·Ÿéšæ¯äº²ä¸€èµ·ç”Ÿæ´»ã€‚åœ¨ä¸­è€ƒå®Œåï¼Œæ°´æ–—çš„çˆ¶äº²å‘Šè¯‰æ°´æ–—è‡ªå·±å‡†å¤‡å†å©šï¼Œä½†å¯¹æ–¹æ˜¯ä¸€ä¸ªç¦»å¼‚å®¶åº­ï¼Œè¿˜æœ‰ä¸€ä¸ªåŒé¾„çš„å¥³ç”Ÿä¼šä¸€å—å„¿ç”Ÿæ´»ã€‚æ°´æ–—æ„è¯†åˆ°çˆ¶äº²é€šçŸ¥è‡ªå·±çš„æ—¶é—´ç‚¹ï¼Œå¸Œæœ›çˆ¶äº²åœ¨ä¹‹åèƒ½è¿‡çš„æ›´å¿«ä¹æ¬£ç„¶æ¥å—äº†è¿™ä¸ªäº‹å®ï¼ˆæ¯•ç«Ÿæ›´æœŸå¾…è½»å°è¯´ä¸­çš„ç¾å°‘å¥³æ¬æ¥æˆ‘å®¶çš„äº‹æƒ…å‘ç”Ÿåœ¨è‡ªå·±èº«ä¸Šï¼‰ã€‚ä½†éšä¹‹è€Œæ¥çš„ï¼Œå´æ˜¯ç»«äº•ç»“å¥³â€”â€”ä¸ï¼Œåº”è¯¥æ˜¯<strong>ä¼Šç†æˆ·ç»“å¥³</strong>å’Œå¥¹çš„æ¯äº²ã€‚äºæ˜¯å‰æƒ…ä¾£åœ¨å¸Œæœ›è‡ªå·±çˆ¶æ¯æœ‰å¹¸ç¦ç”Ÿæ´»çš„åŒæ—¶è¿‡ä¸Šäº†éº»çƒ¦çš„åŒå±…æ—¥å­ã€‚ï¼ˆåˆä¸­ç”Ÿæ‹çˆ±æ€ä¹ˆä¼šè®©å®¶é‡ŒçŸ¥é“ï¼ï¼‰</p><hr><h1 id="é˜…è¯»ä¸ç®€è¯„"><a href="#é˜…è¯»ä¸ç®€è¯„" class="headerlink" title="é˜…è¯»ä¸ç®€è¯„"></a>é˜…è¯»ä¸ç®€è¯„</h1><p><em>ä»¥ä¸‹å†…å®¹å°½é‡ä¸åŒ…å«å‰§é€ï¼ˆæ„æ€æ˜¯è‚¯å®šä¼šæœ‰ä¸€ç‚¹ï¼‰</em></p><p>æ°´æ–—ä¸ç»“å¥³å¹¶ä¸æ˜¯å› ä¸ºæ„Ÿæƒ…æ–­äº†è€Œé€‰æ‹©çš„åˆ†æ‰‹ï¼Œå´æ˜¯å› ä¸ºå„è‡ªæ€§æ ¼çš„ç¼ºé™·å’Œå¯¹è‡ªèº«è®¤è¯†è€Œæœ€ç»ˆèµ°ä¸Šäº†è¿™ä¸€æ¡è·¯ã€‚ä¸¤äººåœ¨ä¸€èµ·ç”Ÿæ´»åä¹Ÿæ›´è®¤è¯†åˆ°äº†è¿™ä¸€ç‚¹ï¼Œè™½ç„¶å¯¹å„è‡ªä»ç„¶ä¼šæµéœ²å‡ºåŒçƒ¦çš„æƒ…ç»ªï¼Œä½†è¿™ä»…ä»…æ˜¯ä¸€ç›´ç”Ÿæ´»ç€çš„ä¸¤äººç¨€æ¾å¹³æ·¡çš„æ—¥å¸¸ç½¢äº†ã€‚</p><p>ç»“å¥³ä¸æ°´æ–—ä¸ºäº†ä¸è¿›å…¥åŒä¸€æ‰€é«˜ä¸­è€ŒåŠªåŠ›ï¼Œå´åŒæ—¶é€‰æ‹©äº†åå·®å€¼å¾ˆé«˜çš„å­¦æ ¡ï¼Œè·å¾—äº†ä¸¤ä¸ªæ•°é‡æœ‰é™çš„å…è´¹ç”Ÿåé¢ã€‚ç»“å¥³åœ¨è¿™ä¸€å¹´ä¸­æœ‰äº†å¾ˆå¤§çš„å˜åŒ–ï¼Œæ¢³å¦†æ‰“æ‰®ä¸åˆä¸­æ—¶æœ‰ç€å¤©å·®åœ°åˆ«ï¼Œè€Œå¹´çº§ç¬¬ä¸€ç¾å°‘å¥³çš„èº«ä»½ä¹Ÿè®©å¥¹åœ¨åˆšè¿›å…¥é«˜ä¸­æ—¶æ”¶è´§åˆ°äº†å¾ˆå¤§çš„å…³æ³¨ã€‚åœ¨é«˜ä¸­å¼€å­¦å<strong>å·æ³¢å°æš®</strong>å’Œ<strong>å—æ™“æœˆ</strong>æˆä¸ºäº†ä¼Šç†æˆ·å…„å¦¹ï¼ˆå§å¼Ÿï¼‰çš„å¥½å‹ã€‚å·æ³¢ä¸å—æ˜¯é‚»å±…ï¼Œæ˜¯é’æ¢…ç«¹é©¬ï¼Œä¸¤äººçš„å…³ç³»ä¹Ÿå’Œä¼Šç†æˆ·ä¸¤äººç±»ä¼¼ã€‚åœ¨ä¸¤äººçš„è§è¯å’Œå¸®å¿™ï¼ˆæœ‰æ—¶å¸®å€’å¿™ï¼‰ä¸‹ï¼Œæ°´æ–—ä¸ç»“å¥³æ›´è¿›ä¸€æ­¥è®¤è¯†åˆ°äº†è‡ªå·±çš„å†…å¿ƒã€‚</p><p><strong>ä¸œå¤´ä¼Šä½å¥ˆ</strong>æ˜¯åŒçº§ç”Ÿï¼Œä¹Ÿæ˜¯ä¸€ä¸ªé˜…è¯»çˆ±å¥½è€…ï¼Œä¸ç»“å¥³ä¸åŒçš„æ˜¯å¥¹å–œæ¬¢çš„æ˜¯è½»å°è¯´ç±»å‹ã€‚åœ¨ç›¸ä¼¼çš„åœºæ™¯ä¸‹ï¼Œæ°´æ–—ç»“è¯†äº†ä¸œå¤´å¹¶å¦‚å½“åˆè§åˆ°ç»“å¥³ä¸€èˆ¬å¸®åŠ©ä¸œå¤´æ‹¿åˆ°äº†ç›¸å…³çš„ä¹¦ç±ï¼ˆå“¦è±è¿™ä¸€å¹•è¢«ç»“å¥³çœ‹åˆ°äº†èƒƒç–¼èƒƒç–¼èƒƒç–¼ï¼‰ã€‚åœ¨å—ä¸ç»“å¥³çš„é¼“åŠ¨ä¸‹ï¼Œä¸œå¤´å‘æ°´æ–—è¡¨ç™½äº†ï¼Œæ°´æ–—**********ã€‚åœ¨æå†™ä¸œå¤´ä¸æ°´æ–—ï¼Œæ°´æ–—ä¸ç»“å¥³è¿™ä¸€æ®µçš„æ—¶å€™ï¼Œè™½ç„¶é€šè¿‡ç‰‡æ®µçš„æç»˜å°±èƒ½å¤ŸçŸ¥é“æ°´æ–—å’Œç»“å¥³ä¸¤äººçš„æƒ³æ³•ï¼Œä½†ä»ç„¶èƒ½å¤Ÿè®©æˆ‘æ€€æœ‰æœŸå¾…çš„å¿ƒæƒ…çœ‹ä¸‹å»ï¼Œå¹¶ä¸”ä»æ­¤åˆ»å¼€å§‹æˆ‘è®¤ä¸ºæ°´æ–—çœŸæ­£å¼€å§‹ç›´é¢è‡ªå·±çš„å†…å¿ƒã€‚åœ¨è¿™ä¸ªäº‹ä»¶ä¹‹åä¸œå¤´ç»å¸¸è·‘å»æ°´æ–—å®¶å¹¶æˆåŠŸè®©ä¼Šç†æˆ·å®¶çš„çˆ¶æ¯é”™è¯¯çš„çŸ¥é“äº†ä»–ä»¬çš„å…³ç³»ã€‚</p><p>ã€Šæ‹–æ²¹ç“¶ã€‹ä¸€ä¹¦ä¸­å¯¹äºæ°´æ–—ä¸ç»“å¥³ã€å·æ³¢ä¸å—çš„æå†™æºè‡ªç”Ÿæ´»ä¹Ÿè¶…è„±äºç”Ÿæ´»ã€‚ä¸¤äººçš„æƒ…æ„Ÿæ˜¯çœŸå®çš„ï¼Œä¸¤äººçš„æ€§æ ¼æ˜¯çœŸå®çš„ï¼Œä¸¤äººçš„æ‰€ä½œæ‰€ä¸ºä¹Ÿæ˜¯çœŸå®çš„ã€‚å½“ç„¶ç°å®å¯èƒ½ä¸å­˜åœ¨è¿™ä¹ˆå¤šçš„å·§åˆï¼Œä½†â€œæˆ‘ä»¬æ‰€åº¦è¿‡çš„æ¯ä¸€ä¸ªæ—¥å¸¸ï¼Œä¹Ÿè®¸å°±æ˜¯è¿ç»­å‘ç”Ÿçš„å¥‡è¿¹â€ã€‚è®©æˆ‘è®¤è¯†åˆ°è¶…è„±äºç”Ÿæ´»å´æ˜¯æ¥è‡ªäºä¸œå¤´ä¸€è§’è‰²ã€‚ä½œä¸ºä¸ç»“å¥³æœ‰ç€éƒ¨åˆ†é‡å çš„å¦ä¸€ä¸ªä¸ªä½“ï¼Œä¸€ä¸ªåŒæ ·å–œæ¬¢æ°´æ–—çš„äººï¼Œåœ¨ä¹‹åå´èƒ½å¤Ÿä¸æ°´æ–—åšå‡ºè¶…è„±äºæ™®é€šæœ‹å‹çš„ä¸¾åŠ¨ï¼Œç»“å¥³åªæ˜¯æ„Ÿåˆ°æ— å¥ˆè€Œæ°´æ–—å´çœŸå¿ƒè§‰å¾—åªæ˜¯å› ä¸ºå¥¹æ˜¯ä¸œå¤´è€Œå·²ã€‚åœ¨ç°å®ç”Ÿæ´»å½“ä¸­å‡ ä¹ä¸ä¼šå‡ºç°è¿™æ ·çš„åœºæ™¯ï¼Œæ— è®ºæ˜¯æ°´æ–—è¿˜æ˜¯ç»“å¥³åŸºæœ¬ä¸Šéƒ½ä¸ä¼šåœ¨ç°å®ç”Ÿæ´»å‡ºç°ç±»ä¼¼çš„è¡¨ç°ã€‚ä½†ã€Šæ‹–æ²¹ç“¶ã€‹ä»…ä»…æ˜¯ä¸€ä¸ªè½»å°è¯´ï¼Œä¸€æœ¬ç»™æˆ‘ä»¬å¸¦æ¥ä¹è¶£çš„å°è¯´ï¼Œå¢åŠ äº†ä¸œå¤´è¿™æ ·ä¸€ä½æ€§æ ¼é²œæ˜ã€è¡ŒåŠ¨é¥±æ»¡çš„è§’è‰²ä¼šè®©æ•´ä¸ªå‰§æƒ…æ›´åŠ ç”ŸåŠ¨ï¼Œçº¸åŸçš„å†™ä½œå’Œå¤§ä½¬ä»¬çš„ç¿»è¯‘èƒ½å¤Ÿè®©è¯»è€…åœ¨æ•´ä¸ªçœ‹ä¹¦çš„è¿‡ç¨‹ä¸­å¹¶ä¸ä¼šå‡ºç°å¤ªå¤§çš„å’Œç°å®ä¸–ç•Œæœ‰å†²çªçš„è¿å’Œæ„Ÿã€‚</p><p>èµ°è¿›è‡ªå·±çš„å†…å¿ƒï¼Œä¸ä»–äººæ²Ÿé€šæ‰ä¼šåšå‡ºä¸ä¼šåæ‚”çš„å†³å®šå‘ã€‚</p><p>å½“ç„¶åªè¦äººè¿˜æ´»ç€éƒ½èƒ½å¤Ÿå°½é‡å»å¼¥è¡¥å‘¢ã€‚</p><p>æ€»ä¹‹å°±æ˜¯éå¸¸å¥½çœ‹ï¼ï¼ˆè€å¤«çš„å°‘å¥³å¿ƒï¼‰</p><p>å¹¶ä¸”å…¨æ–‡æœ‰å¾ˆå¤šçš„ä¼ç¬”ï¼Œæ€»ä½“è§‚æ„Ÿéå¸¸æ£’ï¼Œä¸æ„§æ˜¯æ‹çˆ±å–œå‰§éƒ¨é—¨å¤§èµå‘¢ï¼æœŸå¾…ç»è´¹æ­£å¸¸çš„åŠ¨ç”»åŒ–ã€‚å³ä½¿ä½ æ¢ç›‘ç£ï¼Œä¸­é€”ç¼ºäººï¼Œæˆ‘ä¹Ÿè§‰å¾—æŒ‰ç…§å°è¯´åŸæ¡ˆä¹Ÿèƒ½åšå¾—éå¸¸ä¼˜ç§€äº†ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>review</category>
      
    </categories>
    
    
    <tags>
      
      <tag>light novel</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>æ¨±èŠ±åº„çš„å® ç‰©å¥³å­©</title>
    <link href="/2022/06/25/%E6%A8%B1%E8%8A%B1%E5%BA%84%E7%9A%84%E5%AE%A0%E7%89%A9%E5%A5%B3%E5%AD%A9/"/>
    <url>/2022/06/25/%E6%A8%B1%E8%8A%B1%E5%BA%84%E7%9A%84%E5%AE%A0%E7%89%A9%E5%A5%B3%E5%AD%A9/</url>
    
    <content type="html"><![CDATA[<h1 id="æ¨±èŠ±åº„çš„å® ç‰©å¥³å­©"><a href="#æ¨±èŠ±åº„çš„å® ç‰©å¥³å­©" class="headerlink" title="æ¨±èŠ±åº„çš„å® ç‰©å¥³å­©"></a>æ¨±èŠ±åº„çš„å® ç‰©å¥³å­©</h1><br /><blockquote><p>å¤©æ‰èº«è¾¹æ€»ä¼´éšç€é£æš´ï¼Œé è¿‘è€…æˆ–ä¸è‡ªçŸ¥æˆ–éä½“é³ä¼¤ã€‚</p></blockquote><h1 id="æ•…äº‹æ¦‚è¦"><a href="#æ•…äº‹æ¦‚è¦" class="headerlink" title="æ•…äº‹æ¦‚è¦"></a>æ•…äº‹æ¦‚è¦</h1><p>å°±è¯»äºæ°´æ˜è‰ºæœ¯å¤§å­¦é™„å±é«˜ä¸­çš„<strong>ç¥ç”°ç©ºå¤ª</strong>ï¼Œç”±äºå¤å¤©æ—¶åœ¨å®¿èˆä¸­å…»çŒ«ï¼Œè€Œè¢«æ ¡é•¿å«å»è°ˆè¯ï¼Œæ ¡é•¿è®©ä»–åœ¨ä¸¢æ‰çŒ«ä¸ä»æ­¤æ¬åˆ°â€æ¨±èŠ±åº„â€ä¸­ä½œé€‰æ‹©ã€‚èº«ä¸ºçˆ±çŒ«ä¸€æ—çš„ç©ºå¤ªï¼Œæš‚æ—¶é€‰æ‹©äº†æµè½åˆ°å› èšé›†å„ç§æ€ªäººè€Œæ¶åæ˜­è‘—çš„â€œæ¨±èŠ±åº„â€ã€‚ éšåï¼Œå¤©æ‰ç”»å®¶<strong>æ¤åçœŸç™½</strong>è½¬æ ¡åä½è¿›äº†æ¨±èŠ±åº„ï¼Œå® ç‰©å¥³å­©çš„åˆ°æ¥è®©ç©ºå¤ªå˜å¾—å¿™ç¢Œäº†èµ·æ¥ã€‚</p><p>æ¨±èŠ±åº„ï¼Œè™½æ˜¯å­¦æ ¡ä¸­è¢«èª‰ä¸ºâ€œæ€ªäººèšé›†åœ°â€çš„å®¿èˆï¼Œä½†åœ¨ä¸­å±…ä½çš„å´éƒ½æ˜¯åœ¨æŸæ–¹é¢æœ‰ååˆ†æ°å‡ºæ‰èƒ½çš„äººã€‚â€œæ€ªäººèšé›†åœ°â€æˆ–ç§°ä¹‹ä¸ºâ€œå¤©æ‰èšé›†åœ°â€æ›´ä¸ºè´´åˆ‡ï¼Œä¸è¿‡å¤©æ‰ä»¬æ€»ä¼šæœ‰ç‰¹æ®Šçš„æ€§æ ¼ï¼Œè€Œç”·ä¸»ç¡®å®æ˜¯ä½œä¸ºä¸€ä¸ªæ™®é€šäººåœ¨é‡Œé¢æ‹¼æç€ã€‚</p><ul><li><strong>ç¥ç”°ç©ºå¤ª</strong>ï¼Œç›®æ ‡æ¸¸æˆåˆ¶ä½œäººï¼Œæ™®é€šäºº</li><li><strong>æ¤åçœŸç™½</strong>ï¼Œè½¬å‹æ¼«ç”»ï¼Œç”»å®¶ï¼Œå¤©æ‰</li><li><strong>é’å±±ä¸ƒæµ·</strong>ï¼Œç›®æ ‡å£°ä¼˜ï¼Œæ™®é€šäºº</li><li><strong>ä¸Šäº•è‰ç¾å’²</strong>ï¼ŒåŠ¨ç”»åˆ¶ä½œäººï¼Œå¤©æ‰</li><li><strong>ä¸‰é¹°ä»</strong>ï¼Œè„šæœ¬ï¼Œæ™®é€šäººä»¥ä¸Šï¼Œå¤©æ‰ä»¥ä¸‹</li><li><strong>èµ¤å‚é¾™ä¹‹ä»‹</strong>ï¼Œç¨‹åºå‘˜ï¼Œ<del>å¤©æ‰</del>ï¼Œç¥</li></ul><hr><h1 id="è§‚çœ‹ä¸æ„Ÿå—"><a href="#è§‚çœ‹ä¸æ„Ÿå—" class="headerlink" title="è§‚çœ‹ä¸æ„Ÿå—"></a>è§‚çœ‹ä¸æ„Ÿå—</h1><p><em><strong>ä»¥ä¸‹å†…å®¹åŒ…å«å‰§é€</strong></em></p><p>çœ‹äº†æ¨±èŠ±åº„æ‰æ˜ç™½ï¼Œæœ‰æ‰èƒ½çš„äººå°±åœ¨æˆ‘ä»¬èº«è¾¹ï¼Œæˆ‘ä»¬åªæ˜¯è§‰å¾—å¯¹æˆ‘ä»¬æ™®é€šäººæ¥è¯´å¤ªè¿‡é¥è¿œè€Œæ— æ³•æ¥è¿‘ç½¢äº†ã€‚è€Œåœ¨æ¨±èŠ±åº„é‡Œï¼Œåœ¨å¤©æ‰ä»¬å’Œä»–ä»¬èº«è¾¹çš„äººä»¬çš„æ•…äº‹é‡Œï¼Œç©ºå¤ªè¿™ç±»æ™®é€šäººçš„å†…å¿ƒæ´»åŠ¨ä»¥åŠå¤©æ‰ä»¬è¶…è¶Šæˆ‘ä»¬æƒ³è±¡çš„åŠªåŠ›å´æ˜¯åœ¨è¿™éƒ¨ä½œå“ä¸­å¾ˆå¥½åœ°å‘ˆçŒ®ç»™äº†è¯»è€…ã€‚</p><p>ç»™æˆ‘å°è±¡æœ€æ·±çš„çº¿å¹¶ä¸æ˜¯çœŸç™½ï¼Œç©ºå¤ªæˆ–æ˜¯ä¸ƒæµ·ï¼Œè€Œæ˜¯ç¾å’²å’Œä»ã€‚ç¾å’²å’Œä»äº’ç›¸å–œæ¬¢ï¼Œä½†ä»–ä»¬çš„æ„Ÿæƒ…çº¿å¹¶ä¸èƒ½å¤Ÿç»™äººå¾ˆæ·±çš„å°è±¡ã€‚ç¾å’²æ˜¯ä¸€ä¸ªå¤©é©¬è¡Œç©ºçš„åŠ¨ç”»åˆ¶ä½œè€…ï¼Œå¥¹åšå‡ºçš„åŠ¨ç”»éƒ½ç‰¹åˆ«æœ‰å¼ åŠ›æœ‰è¡¨ç°åŠ›ï¼Œå¹¶ä¸”æœ‰éå¸¸ä¸°å¯Œçš„æƒ³è±¡åŠ›ã€‚ä»åˆ™æ˜¯ä¸€ä¸ªå‰§æœ¬æ’°å†™è€…ï¼Œä¸ºç¾å’²çš„åŠ¨ç”»å†™ä¸Šèƒ½å¤Ÿä¸ä¹‹åŒ¹é…æ•…äº‹ã€‚ä¸¤äººåˆ¶ä½œçš„åŠ¨ç”»éƒ½èƒ½å¤Ÿæœ‰éå¸¸å¥½çš„è¡¨ç°ã€‚ç¾å’²è™½ç„¶æ€§æ ¼å¤§å¤§å’§å’§ï¼Œä½†ä¸€æ¶‰åŠåˆ°åŠ¨ç”»å°±ä¼šè¡¨ç°å¾—éå¸¸ä¸“ä¸šï¼›ä»å¹¶ä¸æ˜¯ä¸€ä¸ªå‰§æœ¬å¤©æ‰ï¼Œä»–åªæ˜¯åŠªåŠ›è®©å†™çš„å‰§æœ¬èƒ½å¤Ÿè¿½ä¸Šç¾å’²çš„åŠ¨ç”»ç½¢äº†ã€‚ä»–åŠªåŠ›ï¼ŒåŠªåŠ›å†™å‡ºä¼˜ç§€çš„å‰§æœ¬ï¼›ä»–æ‡Šæ‚”ï¼Œæ‡Šæ‚”è‡ªå·±å†™çš„å‰§æœ¬æ€»ä¸èƒ½é…ä¸Šç¾å’²çš„åŠ¨ç”»ï¼›ä»–å®³æ€•ï¼Œå®³æ€•å› ä¸ºè‡ªå·±çš„å‰§æœ¬è€Œæ‹–äº†æ•´ä¸ªåŠ¨ç”»çš„åè…¿ã€‚ä»åœ¨ä»–äººçœ¼ä¸­æ˜¯ä¸€ä¸ªå¤©æ‰ï¼Œå…‰èŠ’ä¸‡ä¸ˆï¼Œä½†åªæœ‰ä»–è‡ªå·±è§‰å¾—è‡ªå·±åœ¨ç¾å’²é¢å‰ä»…ä»…æ˜¯ä¸ªæ™®é€šäººï¼Œæ˜¯ä¸ªå¥‹åŠ›å»è¿½èµ¶å´åˆæ— æ³•è·Ÿä¸Šå¤©æ‰çš„æ™®é€šäººç½¢äº†ã€‚ä»ä»£è¡¨ç€æœ‰æ‰èƒ½çš„æ™®é€šäººï¼Œä»–ä»¬å¾ˆæœ‰èƒ½åŠ›ï¼Œéä½“é³ä¼¤è¿½èµ¶å¤©æ‰çš„è„šæ­¥ä¼šè®©äººä»¬è§‰å¾—ä»–ä»¬ä¹Ÿæ˜¯å¤©æ‰çš„ä¸€å‘˜ï¼Œå´ä¸çŸ¥ä»–ä»¬çš„å†…å¿ƒå·²æ–‘é©³ä¸å ªã€‚ä½†è‹¥ä»–ä»¬æ²¡é‡åˆ°å¤©æ‰ï¼Œæ²¡æœ‰å¥‹åŠ›å»è¿½èµ¶ï¼Œè·å–å°±æ˜¯ç¨å¥½ä¸€äº›çš„æ™®é€šäººç¢Œç¢Œä¸€ç”Ÿå§ã€‚</p><p>ä¸ƒæµ·å’Œç©ºå¤ªåˆ™æ˜¯å…¸å‹çš„æ™®é€šäººçš„ä»£è¡¨ï¼Œåœ¨ä¸ƒæµ·è¿½æ±‚å£°ä¼˜çš„é“è·¯ä¸Šå’Œç©ºå¤ªæ¸¸æˆåˆ¶ä½œçš„é“è·¯ä¸Šéƒ½é‡åˆ°äº†æ™®é€šäººä¸€æ ·çš„åå·ã€‚ä¸æ°å‡ºï¼Œæ²¡æœ‰ç‰¹è‰²ï¼Œç¼ºä¹äº®ç‚¹ï¼Œæ€»æœ‰æ›´å¥½çš„äººèƒ½å¤Ÿæ›¿ä»£ã€‚ç©ºå¤ªçš„æ¸¸æˆåˆ¶ä½œè·¯ä¸Šåœ¨çœŸç™½ç»™ä»–ä½œç”»åï¼Œäººä»¬çœ‹ä¸­çš„ç¡®å®çœŸç™½çš„ä½œç”»è€Œä¸å…¶è°ˆåˆä½œï¼Œè¿™å¯¹äººçš„å†…å¿ƒä¼šæœ‰éå¸¸å¤§çš„æ‰“å‡»ã€‚ä½†çœŸç™½å´ä¹Ÿç¦»ä¸å¼€ç©ºå¤ªï¼Œå¤©æ‰ç”»å®¶è½¬å˜ä¸ºæ¼«ç”»å®¶å´ä¹Ÿæ²¡æœ‰é‚£ä¹ˆé¡ºåˆ©ã€‚å¤©æ‰ä¹Ÿè®¸ä¸å–œæ¬¢è‡ªå·±çš„é¢†åŸŸï¼Œè½¬å˜ä¹Ÿå¹¶ä¸æ˜¯å¾ˆé¡ºåˆ©ï¼Œè€Œç©ºå¤ªåˆ™æ˜¯ä¸€æ­¥æ­¥å¸¦é¢†ç©ºç™½èµ°å‘äº†æˆåŠŸã€‚åœ¨é‡åˆ°è¿™äº›å¤©æ‰ä»¬åï¼Œç©ºå¤ªå‘ç°äº†è‡ªå·±å·®è·çš„å·¨å¤§ï¼Œä½†å’Œä¸ƒæµ·ä¸€æ ·ä»–ä»¬ä¸€æ­¥ä¸€ä¸ªè„šå°æœç€è‡ªå·±çš„æ¢¦æƒ³è¿›å‘ã€‚</p><p>æ¨±èŠ±åº„æè¿°çš„æ˜¯å¤©æ‰ä»¬å’Œä»–ä»¬èº«è¾¹çš„äººçš„æ•…äº‹ï¼Œå¯¹æ™®é€šäººã€å¤©æ‰çš„æå†™å’Œæ•…äº‹æƒ…èŠ‚éƒ½æœ‰å¾ˆå¥½çš„æè¿°å’ŒæŒæ§ï¼Œå¯¹ä¸åŒäººçš„åˆ»ç”»ä¹Ÿå¾ˆåˆ°ä½ï¼Œè®©æˆ‘è®¤è¯†åˆ°å¤©æ‰ä»¬çœŸæ­£å¼ºå¤§çš„åœ°æ–¹ä»¥åŠé‚£äº›ä¸€ç›´è¿½é€å¤©æ‰è„šæ­¥çš„äººä»¬å†…å¿ƒçš„å¼ºå¤§ã€‚æƒ³èµ·æ›¾ç»å’Œè‡ªå·±æœ‰è¿‡äº›è®¸äº¤é›†çš„é‚£äº›æœ‰æ‰èƒ½çš„äººä»¬ï¼Œä½†æˆ‘å¹¶ä¸åƒç©ºå¤ªä»–ä»¬ä¸€æ ·æœ‰ç€èƒ½ç«™åœ¨å¤©æ‰ä»¬èº«è¾¹çš„æƒ³æ³•ï¼Œæƒ³çš„æ˜¯å¤©æ‰ä»¬å’Œæˆ‘æœ‰ä»€ä¹ˆå…³ç³»ï¼Œæˆ‘åªæ˜¯æƒ³å®‰ç¨³è¿‡äº†ä¸€ç”Ÿæ‹”äº†ï¼Œæˆ–è®¸è¿™æ‰æ˜¯æˆ‘ä»¬è¿™äº›æ™®é€šäººçš„æƒ³æ³•å§ã€‚</p><p>å½“ç„¶å°è¯´ã€åŠ¨ç”»çš„ä¸–ç•Œè¿˜æ˜¯è¿‡äºç†æƒ³ç”»çš„ï¼Œä¸è¿‡æ•´éƒ¨ä½œå“èƒ½å¤Ÿè®©æˆ‘åœ¨å…¶ä¸­å¿˜æ‰ç°å®å¹¶èƒ½ä¹åœ¨å…¶ä¸­å°±è¶³å¤Ÿäº†ã€‚</p><p>é¾™ä¹‹ä»‹æ°¸è¿œæ»´ç¥ï¼</p><p>æœ€åå¿ƒç–¼ä¸ƒæµ·ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>review</category>
      
    </categories>
    
    
    <tags>
      
      <tag>anime</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PIFu/PIFuHD</title>
    <link href="/2022/06/25/PIFu-PIFuHD/"/>
    <url>/2022/06/25/PIFu-PIFuHD/</url>
    
    <content type="html"><![CDATA[<h1 id="PIFu-x2F-PIFuHD"><a href="#PIFu-x2F-PIFuHD" class="headerlink" title="PIFu&#x2F;PIFuHD"></a>PIFu&#x2F;PIFuHD</h1><blockquote><p>PIFu: Pixel-Aligned Implicit Function for High-Resolution Clothed Human Digitization</p></blockquote><blockquote><p>PIFuHD: Multi-Level Pixel-Aligned Implicit Function for High-Resolution 3D Human Digitization</p></blockquote><h1 id="Target"><a href="#Target" class="headerlink" title="Target"></a>Target</h1><p>ä»å•å¼ æˆ–å¤šå¼ RGBå›¾åƒå’Œå›¾åƒä¸­å¯¹åº”çš„äººä½“maskä¿¡æ¯ï¼Œé‡å»ºå‡ºå›¾ç‰‡æˆ–å›¾ç‰‡ç»„ä¸­çš„äººä½“ä¸‰ç»´æ¨¡å‹å’Œçº¹ç†ä¿¡æ¯ã€‚</p><blockquote><p>PIFuHDæ²¡æœ‰çº¹ç†ä¿¡æ¯ï¼Œä½†å¯ä»¥ä½¿ç”¨PIFuçš„æ–¹å¼åŒæ ·ç”Ÿæˆ</p></blockquote><h1 id="Pixel-Aligned-Implicit-Function"><a href="#Pixel-Aligned-Implicit-Function" class="headerlink" title="Pixel-Aligned Implicit Function"></a>Pixel-Aligned Implicit Function</h1><p>Implicit Functionæ˜¯ç”¨äºè¡¨è¾¾ç‰©ä½“è¡¨é¢çš„å‡½æ•°ï¼Œå¦‚$f(\cdot)$ï¼Œå…¶ä¸­$f(x)&#x3D;0$ä»£è¡¨xåœ¨ç‰©ä½“è¡¨é¢ï¼Œ$f(x)&lt;0$ä»£è¡¨$x$åœ¨ç‰©ä½“å†…éƒ¨ï¼Œ$f(x)&gt;0$ä»£è¡¨$x$åœ¨ç‰©ä½“å¤–éƒ¨ã€‚</p><p>PIFuæ–¹æ³•ä¸­æå‡ºçš„ PIFuåˆ™æ˜¯è®²2Då›¾åƒä¸­çš„Pixelä¹Ÿå¼•å…¥è¿›æ¥ï¼Œæ‰€ä»¥å«åš Pixel-Alignedï¼Œå…¶å‡½æ•°å½¢å¼å¦‚ä¸‹ï¼š</p><p>$f(F(x),z(X))&#x3D;s,s \in R \ \ \ \ \ \ \ (1)$</p><p>$x&#x3D;\pi(X)$ä¸º3Dç‚¹Xåœ¨2Då›¾åƒä¸Šçš„æŠ•å½±ï¼Œ$z(X)$è¡¨ç¤ºåœ¨æ­¤2Då›¾ç‰‡ä¸­å¯¹åº”çš„ç›¸æœºåæ ‡ç³»ä¸‹çš„æ·±åº¦å€¼ã€‚$F(x)&#x3D;g(I(x))$è¡¨ç¤º2Då›¾ç‰‡åœ¨[å…¬å¼]å¤„çš„æ·±åº¦å­¦ä¹ çš„ç‰¹å¾å‘é‡ï¼Œ$g(\cdot)$æ˜¯ç”±ä¸€ä¸ªå…¨å·ç§¯ç½‘ç»œç»„æˆã€‚</p><p>PIFuï¼Œå°±æ˜¯å¯¹äºä»»æ„ä¸€ä¸ª3Dç‚¹$X_i$ï¼Œå…ˆæ ¹æ®ç›¸æœºå‚æ•°æŠ•å½±å¾—åˆ°è¯¥ç‚¹çš„2Dç‚¹ä½ç½®$x_i$ä»¥åŠåœ¨è¯¥ç›¸æœºä¸‹çš„æ·±åº¦$d_i$ï¼ŒåŒæ—¶æ‰¾åˆ°è¯¥2Dç‚¹ä½ç½®çš„å›¾åƒç‰¹å¾å‘é‡$v_{x_i}$ï¼Œ PIFuè¾“å‡º$f(v_{x_i},d_i)$è¡¨ç¤ºè¯¥ç‚¹æ˜¯å¦åœ¨ç‰©ä½“è¡¨é¢ã€‚</p><p>è®ºæ–‡è¡¨ç¤ºPIFuå…³é”®åœ¨äºè¾“å…¥çš„Pixel-Alignedå›¾åƒç‰¹å¾å‘é‡$v_{x_i}$ï¼Œå­¦ä¹ å¾—åˆ°çš„$f(\cdot)$å¯ä»¥åœ¨é‡å»ºçš„æ¨¡å‹ä¸­å¾ˆå¥½åœ°ä¿ç•™å›¾ç‰‡å½“ä¸­å‘ˆç°çš„ä¸€äº›ç»†èŠ‚ã€‚åŒæ—¶PIFuè¿™ç§è¿ç»­æ€§åœ°æœ¬è´¨å¯ä»¥ç”¨ä¸€ç§ä½¿ç”¨å†…å­˜è¾ƒå°‘çš„æ–¹å¼é‡å»ºä»»æ„æ‹“æ‰‘ç»“æ„çš„å‡ ä½•ä¿¡æ¯ï¼Œå¹¶ä¸”å…¬å¼ï¼ˆ1ï¼‰ä¸­$s$å¯ä»¥æ›¿æ¢ä¸ºå¦‚rgbç­‰æ•°æ®ã€‚</p><h1 id="æ•´ä½“æµç¨‹"><a href="#æ•´ä½“æµç¨‹" class="headerlink" title="æ•´ä½“æµç¨‹"></a>æ•´ä½“æµç¨‹</h1><p><img src="/./2022/06/25/PIFu-PIFuHD/PIFu.png" alt="PIFu"></p><h2 id="å•è§†è§’é‡å»º"><a href="#å•è§†è§’é‡å»º" class="headerlink" title="å•è§†è§’é‡å»º"></a>å•è§†è§’é‡å»º</h2><p>PIFuæ–‡ç« ä½¿ç”¨çš„è¡¨é¢GT Implicit Function:</p><p>$$<br>f_v^*(x)&#x3D;\left{\begin{aligned}1&amp;,\ if\ X\ is\ inside\ mesh\ surface\0&amp;,\ otherwise\end{aligned}\right.<br>$$</p><p>$f_v^*&gt;0.5$è¡¨ç¤ºè¯¥ç‚¹åœ¨ç‰©ä½“å†…éƒ¨ï¼›$f_v^*&lt;0.5$è¡¨ç¤ºè¯¥ç‚¹åœ¨ç‰©ä½“å¤–éƒ¨ã€‚è¿™æ ·çš„èƒ½å°†Implicit Functionçš„å€¼è½¬å˜æˆäº†è¯¥3Dç‚¹è¢«ç‰©ä½“å ç”¨çš„æ¦‚ç‡ï¼Œå€¼è¶Šé è¿‘1è¡¨ç¤ºè¢«å æœ‰çš„æ¦‚ç‡è¶Šå¤§ï¼Œå€¼è¶Šé è¿‘0ï¼Œåˆ™æ˜¯ç©ºç™½åŒºåŸŸçš„å‡ ç‡ä¹Ÿè¶Šå¤§ï¼Œæ–¹ä¾¿ç½‘ç»œæœ€åSigmoidè¾“å‡ºã€‚</p><p>æœ‰çš„è®­ç»ƒæ•°æ®ï¼šmä¸ªå¯¹åº”çš„pairï¼Œ(2Då›¾åƒï¼Œ3Dæ¨¡å‹)ã€‚</p><p>æ ¹æ®ä¸Šå›¾ä¸­PIFu è¡¨é¢é‡å»ºçš„æµç¨‹ï¼š å¯¹äºæ¯ä¸€ä¸ª(2Då›¾åƒï¼Œ3Dæ¨¡å‹)ï¼Œ2Då›¾åƒä¼šå…ˆè¾“å…¥åˆ°ä¸€ä¸ªç”±å…¨å·ç§¯ç»„æˆçš„image encoder $g$ï¼Œå¾—åˆ°ä¸åŸ2Då›¾å¤§å°ä¸€è‡´çš„æ·±åº¦ç‰¹å¾$F_V\in R^{h\times w\times c}$ã€‚å¯¹äº3Dæ¨¡å‹ï¼Œå¯ä»¥é‡‡æ ·å¾—åˆ°nä¸ª3Dç‚¹${X_1,X_2,â€¦,X_n}$ï¼Œ åŒæ—¶å¯ä»¥çŸ¥é“å…¶å¯¹åº”çš„Implicit Functionçš„GT${f_v^*(X_1),f_v^*(X_2),â€¦,f_v^*(X_n)}$</p><p>äºæ˜¯è®ºæ–‡æ„å»ºæŸå¤±å‡½æ•°:</p><p>$$<br>L_v&#x3D;\frac{1}{n}\sum_{i&#x3D;1}^{n}{|f_v(F_V(x_i),z(X_i))-f_v^*(X_i)|}^2<br>$$</p><p>è®ºæ–‡ä½¿ç”¨MLPå»æ‹Ÿåˆä¸Šè¿°çš„æ–¹ç¨‹$f_v(\cdot)$ã€‚åœ¨æ¢¯åº¦ä¸‹é™è¿‡ç¨‹ä¸­ï¼Œimage encoder $g$å’Œ$f_v(\cdot)$æ˜¯åŒæ—¶è”åˆä¼˜åŒ–çš„ï¼ˆSurface Reconstructionï¼‰ã€‚image encoder $g$å’Œ$f_v(\cdot)$è®­ç»ƒå¥½ä¹‹åï¼Œåœ¨æ¨ç†é˜¶æ®µï¼Œè¾“å…¥å°±æ˜¯ä¸€å¼ å›¾ç‰‡å’Œå¯¹åº”çš„ç›¸æœºå‚æ•°ï¼Œä»¥åŠè¯¥å›¾ç‰‡ä¸­äººä½“æ‰€å¤„çš„ä¸€ä¸ªå¤§è‡´èŒƒå›´ï¼ˆBounding Boxï¼Œ$[x_{min},x_{max},y_{min},y_{max},z_{min},z_{max}]$ï¼‰ã€‚å¯¹äºBounding Boxï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸‰ä¸ªç»´åº¦ä¸Šè¿›è¡Œç¦»æ•£åŒ–ï¼Œæ¯”å¦‚æ¯ä¸ªç»´åº¦512ï¼Œå°±å¯ä»¥å¾—åˆ°$512\times512\times512$ä¸ªç‚¹$X_i$ï¼Œå¯¹æ‰€æœ‰çš„ç‚¹è¾“å…¥åˆ°$f_v(\cdot)$å‡½æ•°ä¸­ï¼Œé‚£å°±å¯ä»¥å¾—åˆ°3D Occupacyä¿¡æ¯ï¼Œç„¶åè·‘ä¸€éMarching Cubeå°±å¯ä»¥å¾—åˆ°ç‰©ä½“çš„æ¨¡å‹ã€‚</p><h2 id="é¢œè‰²é‡å»º"><a href="#é¢œè‰²é‡å»º" class="headerlink" title="é¢œè‰²é‡å»º"></a>é¢œè‰²é‡å»º</h2><p>å°†å…¬å¼ï¼ˆ1ï¼‰ä¸­çš„$s$æ”¹æˆ$rgb$ï¼Œæ¥è·å–3Dç‚¹å¯¹åº”çš„é¢œè‰²é¢„æµ‹ã€‚</p><p>æŸå¤±å‡½æ•°ä¸º:</p><p>$$<br>L_c&#x3D;\frac{1}{n}\sum_{i&#x3D;1}^{n}{|f_c(F_C(x_i),z(X_i))-C(X_i)|}<br>$$</p><p>å…¶ä¸­$C(X_i)$è¡¨ç¤ºçš„æ˜¯3Dç‚¹$X_i$åœ¨2Då›¾åƒä¸­æŠ•å½±çš„é¢œè‰²ã€‚åŒæ ·çš„ä¹Ÿå¯ä»¥é‡‡ç”¨å’Œè¡¨é¢å‡ ä½•é‡å»ºçš„æ–¹å¼ï¼ŒåŒæ—¶ä¼˜åŒ–image encoder å’Œ implicit function $f_c(\cdot)$ï¼ˆTexture Inferenceï¼‰ã€‚æ–‡ç« ä¸­æå‡ºï¼Œæ˜¯ç”¨è¿™ç§æ–¹å¼è¿™æ ·ä¼šå¾ˆå®¹æ˜“è¿‡æ‹Ÿåˆï¼Œè¿™æ˜¯å› ä¸ºåœ¨è¿™ç§æƒ…å†µä¸‹$f_c(\cdot)$æ—¢è¦é¢„æµ‹è¡¨é¢é¡¶ç‚¹çš„é¢œè‰²ï¼Œåˆè¦å»å­¦ä¹ ç‰©ä½“æ½œåœ¨çš„3Dä¿¡æ¯ï¼Œè¿™æ ·å®ƒæ‰å¯ä»¥æ¨æ–­ä¸åŒposeå’Œä¸åŒå½¢çŠ¶çš„äººä½“çš„ä¸å¯è§éƒ¨åˆ†ï¼ˆæ¯”å¦‚èƒŒé¢é¡¶ç‚¹ï¼‰çš„é¢œè‰²ä¿¡æ¯ã€‚äºæ˜¯æ–‡ç« æå‡ºäº†å¦å¤–ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯åŸºäºä¸Šä¸€æ­¥éª¤ä¸­çš„åˆ°ç”¨äºé‡å»ºçš„æ·±åº¦ç‰¹å¾$F_V$ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹$f_c(\cdot)$åªéœ€è¦å…³æ³¨é¡¶ç‚¹çš„é¢œè‰²ï¼Œè€Œä¸éœ€è¦å»å…³æ³¨æ½œåœ¨çš„3Dä¿¡æ¯ï¼Œæ‰€ä»¥ä¸Šé¢çš„æŸå¤±å‡½æ•°å˜æˆï¼š</p><p>$$<br>L_c&#x3D;\frac{1}{n}\sum_{i&#x3D;1}^{n}{|f_c(F_C(x_i^{â€˜},F_V),z(X_{i,z}^{â€˜}))-C(X_i)|}<br>$$</p><p>è¡¨é¢é¡¶ç‚¹çš„$X_i^{â€˜}&#x3D;X_i+\epsilon \cdot N_i$ï¼Œå…¶ä¸­$\epsilon \sim N(0,d)$ï¼Œæ·»åŠ äº†ä¸€ä¸ªåç§»é‡ä½¿å¾—è¯¥ç‚¹çš„å‘¨å›´éƒ½æ˜¯è¯¥é¢œè‰²ï¼Œèƒ½å¤Ÿè®©ç½‘ç»œæ›´å¥½çš„å­¦ä¹ å‡ºç›¸å…³çš„ç‰¹å¾ã€‚</p><h2 id="å¤šè§†è§’é‡å»º"><a href="#å¤šè§†è§’é‡å»º" class="headerlink" title="å¤šè§†è§’é‡å»º"></a>å¤šè§†è§’é‡å»º</h2><p><img src="/./2022/06/25/PIFu-PIFuHD/pixelalign.png" alt="multiview"></p><p>å¤šè§†è§’ä¸‹ï¼ŒPIFuå˜æˆ$f(mean(\Phi_{view_1},\Phi_{view_2},â€¦,\Phi_{view_n}))&#x3D;s$ï¼Œå³æ¯ä¸€ä¸ªç‚¹çš„ç‰¹å¾ä¸ºæ‰€æœ‰è§†è§’ä¸‹è¯¥ç‚¹ç‰¹å¾çš„å¹³å‡ã€‚</p><h2 id="PIFuHD"><a href="#PIFuHD" class="headerlink" title="PIFuHD"></a>PIFuHD</h2><p>ç”±äºæ˜¾å¡å†…å­˜çš„é™åˆ¶ï¼ŒPIFuçš„è¾“å…¥å›¾ç‰‡çš„å¤§å°ä¸º$512\times512$ï¼Œè¾“å‡ºçš„ç‰¹å¾ä¸º$128\times128$ï¼Œä¸”ä½¿ç”¨çš„æ˜¯HourGlassä½œä¸ºimage encoderï¼Œè¯¥ç½‘ç»œç»“æœå¯ä»¥è¾¾åˆ°æ•´å¼ å›¾ç‰‡çš„æ„Ÿå—é‡ï¼Œå¹¶ä¸”å¤šå¯¹ä¸­é—´é˜¶æ®µè¾“å‡ºçš„ç›‘ç£å¯ä»¥å¾—åˆ°æ¯”è¾ƒé²æ£’çš„3Dé‡å»ºç»“æœï¼Œä½†æ˜¯è¿™æ ·çš„ç½‘ç»œç»“æ„ä¹Ÿé™åˆ¶äº†è¯¥æ–¹æ³•è¾“å…¥æ›´å¤§åˆ†è¾¨ç‡çš„è¾“å…¥å›¾ç‰‡ï¼ŒåŒæ—¶ä¹Ÿä¸èƒ½å¾—åˆ°æ›´é«˜ç»´åº¦çš„ç‰¹å¾ã€‚</p><p><img src="/./2022/06/25/PIFu-PIFuHD/PIFuHD.png" alt="PIFuHD"></p><p>å¤šå±‚PIFuï¼Œè¾“å…¥æ˜¯$1024\times1024$çš„å›¾ç‰‡$I_H$ï¼Œè¾“å‡ºæ˜¯é«˜ç²¾åº¦çš„äººä½“ä¸‰ç»´æ¨¡å‹ã€‚</p><ul><li><p>Coarse Level</p><p>  ä¸PIFuç›¸åŒï¼Œè¾“å…¥çš„å›¾ç‰‡å¤§å°ä¸º$512\times512$ï¼Œä¸ºåŸå›¾ç»è¿‡ä¸‹é‡‡æ ·åå¾—åˆ°çš„å›¾ç‰‡ï¼ˆ$I_L$ï¼‰ï¼Œè¾“å‡ºç‰¹å¾ä¸º$128\times128$ã€‚é€”ä¸­è¾“å…¥éƒ¨åˆ†è¿˜æ·»åŠ äº†$512\times512$å›¾ç‰‡é¢„æµ‹å¾—åˆ°çš„æ­£é¢ã€åé¢æ³•ç›¸å›¾$F_L,B_L$ï¼Œæ­¤æ¨¡å—ä¸º:</p><p>  $$<br>  f^L(X)&#x3D;g^L(\Phi^L(x_L,I_L,F_L,B_L,),Z)<br>  $$</p><p>  å…¶ä¸­$x_L\in R^2$æ˜¯3Dç‚¹$X$åœ¨$I_L$å›¾ç‰‡ä¸­2Dçš„æŠ•å½±ä½ç½®ï¼Œ$Z$ä¸ºè¯¥ç›¸æœºè§†è§’ä¸‹çš„æ·±åº¦ï¼Œ$\Phi^L$æ˜¯æå–å›¾åƒç‰¹å¾çš„ç¥ç»ç½‘ç»œï¼Œ$g^L$æ˜¯MLPï¼Œä»$X$çš„ç‰¹å¾å’ŒæŠ•å½±æ·±åº¦$Z$åˆ¤æ–­è¯¥3Dç‚¹æ˜¯å¦åœ¨éœ€è¦å»ºæ¨¡çš„äººä½“å†…éƒ¨</p></li><li><p>Fine Level</p><p>  è¿™ä¸ªéƒ¨åˆ†æ˜¯çš„ä¸»å¹²ç½‘ç»œè¾“å…¥æ˜¯åŸå§‹çš„$1024\times1024$çš„å›¾ç‰‡$I_H$ï¼Œè¾“å‡º$512\times512$å¤§å°çš„å›¾åƒç‰¹å¾ï¼Œå¾—åˆ°å¤§åˆ†è¾¨ç‡çš„ç‰¹å¾å›¾æ˜¯ä¸ºäº†èƒ½å¤Ÿå¾—åˆ°ä¸‰ç»´æ¨¡å‹ä¸Šçš„ç²¾ç»†ç»†èŠ‚ã€‚åŒæ ·è¿™ä¸ªæ¨¡å—ä¹Ÿè¾“å…¥äº†é«˜åˆ†è¾¨ç‡çš„æ­£é¢ã€åé¢æ³•å‘å›¾$F_H,B_H$:</p><p>  $$<br>  f^H(X)&#x3D;g^H(\Phi^H(x_H,I_H,F_H,B_H,),\Omega(X))<br>  $$</p><p>  å…¶ä¸­$x_H\in R^2$æ˜¯3Dç‚¹$X$åœ¨$I_H$å›¾ç‰‡ä¸­2Dçš„æŠ•å½±ä½ç½®ï¼Œä¸”$x_H&#x3D;2x_L$ã€‚</p><p>  $\Phi^H$å’Œ$\Phi^L$æœ‰ç€ç›¸ä¼¼çš„ç½‘ç»œç»“æ„ï¼Œä¸»è¦çš„ä¸åŒåœ¨äº$\Phi^H$æ„Ÿå—é‡æ²¡æœ‰è¦†ç›–è¿™ä¸ªå›¾ç‰‡ï¼Œä½†æ˜¯ç”±äºå·ç§¯ç½‘ç»œçš„ç‰¹æ€§ï¼Œå¯ä»¥é€šè¿‡æ»‘åŠ¨çª—å£çš„æ–¹å¼æå–æ•´å¼ å›¾åƒçš„ç‰¹å¾ã€‚é€šè¿‡è¿™ç§æ–¹å¼å¾—åˆ°çš„ç‰¹å¾å°±æ²¡æœ‰å…¨å±€çš„ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨$g^H$ä¸­ï¼Œæ²¡æœ‰ç›´æ¥è¾“å…¥æŠ•å½±çš„æ·±åº¦$Z$ï¼Œè€Œæ˜¯å°†coarse levelä¸­çš„å…¨å±€ç‰¹å¾$\Omega(X)$å¼•å…¥ï¼Œä»¥è·å–å…¨å±€çš„ç‰¹å¾ä¿¡æ¯ã€‚</p></li></ul><p>ç”±äºFine Levelè¾“å…¥äº†Coarse Levelçš„3Då…¨å±€ç‰¹å¾ï¼Œæ‰€ä»¥ç»è¿‡Fine Levelé‡å»ºå‡ºæ¥çš„ç»“æœä¸ä¼šå·®äºCoarse Levelå•ç‹¬çš„è¾“å‡ºç»“æœã€‚å¦‚æœç½‘ç»œè®¾è®¡èƒ½å¤Ÿå¾ˆå¥½åˆ©ç”¨é«˜åˆ†è¾¨ç‡çš„å›¾åƒä¿¡æ¯ï¼Œå¯ä»¥ç”Ÿæˆæ›´å¥½çš„ä¸‰ç»´æ¨¡å‹ã€‚ å¦å¤–ï¼ŒFine Levelä¸éœ€è¦å½’ä¸€åŒ–å¯ä»¥è®©è¿™ä¸€éƒ¨åˆ†ç½‘ç»œä½¿ç”¨å›¾ç‰‡cropå»è¿›è¡Œè®­ç»ƒï¼ŒèŠ‚çœäº†æ˜¾å­˜ã€‚</p><ul><li><p>Front-to-Backæ¨ç†</p><p>  åœ¨Coarse Levelå’ŒFine Leveléƒ½æ˜¯ç”¨äº†å›¾ç‰‡çš„æ­£é¢ã€åé¢æ³•ç›¸å›¾ï¼Œè®ºæ–‡ä½¿ç”¨pix2pixHDç½‘ç»œå°†RGBå›¾åƒé¢„æµ‹å‡ºå›¾ç‰‡çš„æ­£é¢å’Œåé¢æ³•ç›¸å›¾ã€‚</p></li></ul><p>åœ¨PIFuHDä¸­ä½¿ç”¨äº†æ‰©å±•BCEæŸå¤±å‡½æ•°ï¼Œå³</p><p>![extbce][.&#x2F;2022&#x2F;06&#x2F;25&#x2F;PIFu-PIFuHD&#x2F;extbce.png]</p><p>åœ¨in&#x2F;outé‡‡æ ·æ•°é‡ä¸åŒçš„æ—¶å€™ï¼Œä¼šç»™æ•°é‡è¾ƒå°‘çš„ä¸€æ–¹æœ‰æ›´å¤§çš„æƒé‡ï¼ˆç±»ä¼¼focal lossï¼‰ã€‚</p><ul><li>pix2pix</li></ul><p>pix2pixç†è§£æˆimage translateï¼Œåœ¨PIGFuHDä¸­ï¼Œåˆ©ç”¨ä¸€ä¸ªGenerator</p><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://zhuanlan.zhihu.com/p/148509062">è®ºæ–‡è§£è¯» | PIFu: Pixel-Aligned Implicit Function for High-Resolution Clothed Human Digitization</a></p><p><a href="https://zhuanlan.zhihu.com/p/149657262">è®ºæ–‡è§£è¯» | PIFuHD: Multi-Level Pixel-Aligned Implicit Function for High-Resolution 3D Human Digitization</a></p><p><a href="https://arxiv.org/pdf/1611.07004.pdf"></a></p>]]></content>
    
    
    <categories>
      
      <category>paper reading</category>
      
    </categories>
    
    
    <tags>
      
      <tag>volume reconstruction</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>TSDF</title>
    <link href="/2022/06/25/TSDF/"/>
    <url>/2022/06/25/TSDF/</url>
    
    <content type="html"><![CDATA[<h1 id="TSDF"><a href="#TSDF" class="headerlink" title="TSDF"></a>TSDF</h1><p>TSDF ï¼Œå³Truncated Signed Distance Functionï¼ŒåŸºäºæˆªæ–­çš„å¸¦ç¬¦å·è·ç¦»å‡½æ•°ï¼Œæ˜¯ä¸€ç§å¸¸è§çš„åœ¨3Dé‡å»ºä¸­è®¡ç®—éšåŠ¿é¢çš„æ–¹æ³•ã€‚TSDFæ˜¯åœ¨SDFè¿›è¡Œæ”¹è¿›çš„ï¼Œåœ¨æ‹¥æœ‰å¤§å†…å­˜çš„æ˜¾å¡å¹¶è¡Œè®¡ç®—çš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨TSDFå¯ä»¥åšåˆ°å®æ—¶çš„é‡å»ºæ•ˆæœï¼Œè·å¾—äº†å¾ˆå¤šæ–¹é¢çš„è½åœ°ä½¿ç”¨ã€‚</p><h1 id="ç®—æ³•æ€æƒ³"><a href="#ç®—æ³•æ€æƒ³" class="headerlink" title="ç®—æ³•æ€æƒ³"></a>ç®—æ³•æ€æƒ³</h1><p>TSDFçš„ç®—æ³•çš„æ€è·¯å°±æ˜¯ç”¨ä¸€ä¸ªå¤§çš„ç©ºé—´ï¼ˆVolumeï¼‰ä½œä¸ºè¦å»ºç«‹çš„ä¸‰ç»´æ¨¡å‹ï¼Œè¿™ä¸ªç©ºé—´å¯ä»¥å®Œå…¨åŒ…æ‹¬æˆ‘ä»¬çš„æ¨¡å‹ï¼ŒVolumeç”±è®¸å¤šä¸ªå°çš„ä½“ç´ ï¼ˆVoxelï¼‰ç»„æˆã€‚</p><p>æ¯ä¸ªVoxelå¯¹åº”ç©ºé—´ä¸­ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹æˆ‘ä»¬ç”¨ä¸¤ä¸ªé‡æ¥è¯„ä»·ï¼š</p><ol><li>è¯¥Voxelåˆ°æœ€è¿‘çš„Surfaceï¼ˆä¸€èˆ¬ç§°ä½œZero Crossingï¼‰çš„è·ç¦»ï¼Œè®°ä½œTSDF(x)ï¼Œå³å¸¦ç¬¦å·è·ç¦»</li><li>Voxelæ›´æ–°æ—¶çš„æƒé‡ï¼Œè®°ä½œw</li></ol><p><img src="/./2022/06/25/TSDF/distance.png" alt="distance"></p><p>å‡è®¾æˆ‘ä»¬çœŸå®çš„é¢åˆ°ç›¸æœºçš„æ·±åº¦æ˜¯dsï¼Œç›¸æœºé‡‡é›†åˆ°çš„æ·±åº¦dvï¼Œé‚£ä¹ˆç¬¦å·è·ç¦»å€¼å°±æ˜¯ï¼š</p><p>$d(x)&#x3D;ds-dv$</p><p>å½“d(x)&gt;0 æ—¶è¯´æ˜è¯¥ä½“ç´ åœ¨çœŸå®çš„é¢çš„å‰é¢ï¼Œå°äº0 ï¼Œåˆ™è¯´æ˜è¯¥ä½“ç´ åœ¨çœŸå®çš„é¢çš„åé¢</p><p>æ¯ä¸€æ¬¡ç›¸æœºé‡‡é›†å‡ºæ¥çš„æ•°å€¼ï¼Œæˆ‘ä»¬éƒ½è®¤ä¸ºæ˜¯æœ€å¤§å¯èƒ½çœŸå®é¢ï¼Œåœ¨ç›¸æœºå‰åä¹Ÿæœ‰å¯èƒ½æ˜¯çœŸå®é¢ï¼Œä½†æ˜¯æ¦‚ç‡è¦å°ã€‚è¿™ä¸ªå‰åè·ç¦»æˆ‘ä»¬å¯¹å®ƒè¿›è¡Œä¸€å®šçš„é™åˆ¶ï¼Œå› ä¸ºç¦»å¾—ç‰¹åˆ«è¿œçš„è¯ï¼Œå…¶æ¦‚ç‡ä¹Ÿæ˜¯å¾ˆå°ï¼Œæˆ‘ä»¬å°±å¿½ç•¥äº†ã€‚</p><p><img src="/./2022/06/25/TSDF/TSDF.png" alt="TSDF"></p><p>åœ¨è®¡ç®—æ–°çš„æ‹æ‘„å¸§çš„ä½“ç´ çš„ç¬¦å·è·ç¦»å€¼å’Œä½“ç´ æ›´æ–°çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¸æ˜¯æ‰€æœ‰çš„ä½“ç´ éƒ½æŸ¥æ‰¾å’Œæ›´æ–°ï¼Œè€Œæ˜¯åªæŸ¥æ‰¾æ›´æ–°æˆªæ–­è·ç¦»å†…çš„ä½“ç´ ï¼Œè¿™ä¹Ÿæ˜¯TSDFä¸SDFä¸åŒçš„ä¸€ç‚¹ï¼Œå¤§å¤§ç¼©çŸ­äº†è®¡ç®—é‡ï¼Œå¹¶æé«˜äº†ç²¾åº¦</p><h1 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h1><ol><li><p>å‡†å¤‡å·¥ä½œ</p><ul><li>å»ºç«‹é•¿æ–¹ä½“åŒ…å›´ç›’ï¼Œèƒ½å¤Ÿå®Œå…¨åŒ…å›´è¦é‡å»ºçš„ç‰©ä½“</li><li>åˆ’åˆ†ç½‘æ ¼ä½“ç´ ï¼Œå¯¹åŒ…å›´ç›’åˆ’åˆ†nç­‰åˆ†ï¼Œä½“ç´ çš„å¤§å°å–å†³äºåŒ…å›´ç›’å’Œåˆ’åˆ†ä½“ç´ çš„æ•°ç›®å†³å®šã€‚æˆ‘ä»¬å°†æ•´ä¸ªç©ºé—´çš„ä½“ç´ å…¨éƒ¨å­˜å…¥GPUè¿ç®—ï¼Œæ¯ä¸ªçº¿ç¨‹å¤„ç†ä¸€æ¡(x,y)ã€‚å³å¯¹äº(x,y,z)çš„æ™¶æ ¼åæ ‡ï¼Œæ¯ä¸ªGPUè¿›ç¨‹æ‰«æå¤„ç†ä¸€ä¸ª(x,y)åæ ‡ä¸‹çš„æ™¶æ ¼æŸ±</li><li>å¯¹äºæ„é€ çš„ç«‹ä½“ä¸­çš„æ¯ä¸ªä½“ç´ gï¼Œè½¬åŒ–gä¸ºä¸–ç•Œåæ ‡ç³»ä¸‹å¾—ä¸‰ç»´ä½ç½®ç‚¹ pï¼ˆæ ¹æ®ä½“ç´ çš„å¤§å°ï¼Œä»¥åŠä½“ç´ çš„æ•°ç›®ï¼‰</li></ul></li><li><p>è®¡ç®—å½“å‰å¸§çš„TSDFå€¼ä»¥åŠæƒé‡</p><p> è¿™ä¸€æ­¥æˆ‘ä»¬éå†æ‰€æœ‰çš„ä½“ç´ ï¼Œä»¥ä¸€ä¸ªä½“ç´ åœ¨ä¸–ç•Œåæ ‡ç³»ä¸‰ç»´ä½ç½®ç‚¹pä¸ºä¾‹</p><ul><li>ç”±æ·±åº¦æ•°æ®çš„ç›¸æœºä½å§¿çŸ©é˜µï¼Œæ±‚ä¸–ç•Œåæ ‡ç³»ä¸‹ç‚¹påœ¨ç›¸æœºåæ ‡ç³»ä¸‹å¾—æ˜ å°„ç‚¹vï¼Œå¹¶ç”±ç›¸æœºå†…å‚çŸ©é˜µï¼ŒåæŠ•å½±vç‚¹æ±‚æ·±åº¦å›¾åƒä¸­çš„å¯¹åº”åƒç´ ç‚¹xï¼Œåƒç´ ç‚¹xçš„æ·±åº¦å€¼ä¸ºvalue(x)ï¼Œç‚¹våˆ°ç›¸æœºåæ ‡åŸç‚¹çš„è·ç¦»ä¸ºdistance(v)</li><li>ä½ç½®ç‚¹$p$çš„SDFå€¼ä¸º$SDF(p)&#x3D;value(x)-distance(v)$ã€‚ç°åœ¨æˆ‘ä»¬å°±è¦å¼•å…¥æˆªæ–­è·ç¦»äº†ï¼Œè®¡ç®—å‡º$TSDF(p)$, å…¬å¼å†™å‡ºæ¥æ¯”è¾ƒå¤æ‚ï¼Œç›´æ¥æè¿°å°±æ˜¯åœ¨æˆªæ–­è·ç¦»$u$ä»¥å†…ï¼Œ$TSDF(p)&#x3D;\frac{SDF(p)}{|u|}$ï¼Œ å¦åˆ™ï¼Œå¦‚æœ$SDF(p) &gt;0$ï¼Œ$TSDF(p)  &#x3D; 1$ï¼›$SDF(p) &lt;0$ï¼Œ$TSDF(p)  &#x3D; -1$</li><li>æƒé‡$w(p)$çš„è®¡ç®—å…¬å¼ï¼š$w(p) &#x3D; \frac{cos(\theta)}{distance(v)}$ï¼Œå…¶ä¸­Î¸ä¸ºæŠ•å½±å…‰çº¿ä¸è¡¨é¢æ³•å‘é‡çš„å¤¹è§’</li></ul><p> ç»è¿‡æˆ‘ä»¬è¿™ä¸€æ­¥å°±ç®—å‡ºè¿™ä¸€å¸§çš„æ‰€æœ‰ä½“ç´ çš„TSDFå€¼ä»¥åŠæƒé‡å€¼ </p></li><li><p>å½“å‰å¸§ä¸å…¨å±€èåˆç»“æœè¿›è¡Œèåˆ</p><p> å¦‚æœå½“å‰å¸§æ˜¯ç¬¬ä¸€å¸§ï¼Œåˆ™ç¬¬ä¸€å¸§å³æ˜¯èåˆç»“æœï¼Œå¦åˆ™éœ€è¦å½“å‰å¸§ä¸ä¹‹å‰çš„èåˆç»“æœåœ¨è¿›è¡Œèåˆã€‚å‡è®¾TSDFâ€˜(p)ä¸ºä½“ç´ pçš„èåˆTSDFå€¼ï¼Œwâ€™(p)ä¸ºèåˆæƒé‡å€¼ï¼ŒTSDF(p)ä¸ºä½“ç´ på½“å‰å¸§çš„TSDFå€¼ï¼Œw(p)ä¸ºå½“å‰å¸§æƒé‡å€¼ã€‚ç°åœ¨æˆ‘ä»¬è¦é€šè¿‡TSDF(p)æ›´æ–°TSDFâ€™(p)ã€‚å…¬å¼å¦‚ä¸‹</p><p> $$<br> \begin{aligned}TSDFâ€™(p)&amp;&#x3D;\frac{wâ€™(p)\cdot TSDFâ€™(P)+w(p)\cdot TSDF(p)}{wâ€™(p)+w(p)}\wâ€™(p)&amp;&#x3D;wâ€™(p)+w(p)\end{aligned}<br> $$</p><p> é€šè¿‡ä¸Šè¿°å…¬å¼å°±å¯ä»¥å°†æ–°çš„å¸§èåˆè¿›èåˆå¸§å†…ã€‚</p><p> ç¬¬ä¸€éƒ¨åˆ†å®Œæˆåï¼Œå°±æ˜¯æ¯æ·»åŠ ä¸€å¸§æ·±åº¦æ•°æ®ï¼Œæ‰§è¡Œä¸€é2ã€3æ­¥çš„è®¡ç®—ï¼ŒçŸ¥é“æœ€åè¾“å‡ºç»“æœç»™Marching Cubeè®¡ç®—æå‡ºä¸‰è§’é¢</p></li></ol><h1 id="ç®—æ³•ç‰¹ç‚¹"><a href="#ç®—æ³•ç‰¹ç‚¹" class="headerlink" title="ç®—æ³•ç‰¹ç‚¹"></a>ç®—æ³•ç‰¹ç‚¹</h1><ul><li>è®¡ç®—ç®€å•</li><li>éœ€è¦å¤§é‡å¹¶è¡Œè®¡ç®—åŠ å¿«é€Ÿåº¦</li><li>ç”Ÿæˆçš„ç½‘æ ¼çš„ç»†èŠ‚ä¿æŒæ¯”è¾ƒå¥½ï¼Œè€Œä¸”ç²¾ç¡®åº¦ä¹Ÿæ¯”è¾ƒå¥½ï¼Œä½†æ˜¯åœ¨è¾¹ç¼˜å¤„ä»¥åŠå‰åæ™¯äº¤ç•Œå¤„ï¼Œä¼šå‡ºç°è¾ƒå¤§çš„æ‹–å°¾ç°è±¡</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://www.jianshu.com/p/462fe75753f7">ç½‘æ ¼ç”Ÿæˆä¹‹TSDFç®—æ³•å­¦ä¹ ç¬”è®°</a></p><p><a href="https://zhuanlan.zhihu.com/p/42112101">ä¸‰ç»´é‡å»ºä¸­çš„è¡¨é¢æ¨¡å‹æ„å»ºâ€“TSDFç®—æ³•</a></p>]]></content>
    
    
    <categories>
      
      <category>3D Basic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>volume</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç‚¹äº‘é…å‡†ä¸ICP</title>
    <link href="/2022/06/25/%E7%82%B9%E4%BA%91%E9%85%8D%E5%87%86%E4%B8%8EICP/"/>
    <url>/2022/06/25/%E7%82%B9%E4%BA%91%E9%85%8D%E5%87%86%E4%B8%8EICP/</url>
    
    <content type="html"><![CDATA[<h1 id="ç‚¹äº‘é…å‡†ä¸ICP"><a href="#ç‚¹äº‘é…å‡†ä¸ICP" class="headerlink" title="ç‚¹äº‘é…å‡†ä¸ICP"></a>ç‚¹äº‘é…å‡†ä¸ICP</h1><h1 id="å…³äºç‚¹äº‘"><a href="#å…³äºç‚¹äº‘" class="headerlink" title="å…³äºç‚¹äº‘"></a>å…³äºç‚¹äº‘</h1><ul><li>ç‚¹äº‘æ˜¯åœ¨åŒä¸€ç©ºé—´å‚è€ƒç³»ä¸‹è¡¨è¾¾ç›®æ ‡ç©ºé—´åˆ†å¸ƒå’Œç›®æ ‡è¡¨é¢ç‰¹æ€§çš„æµ·é‡ç‚¹é›†åˆï¼Œåœ¨è·å–ç‰©ä½“è¡¨é¢æ¯ä¸ªé‡‡æ ·ç‚¹çš„ç©ºé—´åæ ‡åï¼Œå¾—åˆ°çš„æ˜¯ç‚¹çš„é›†åˆï¼Œç§°ä¹‹ä¸ºç‚¹äº‘ï¼ˆPoint Cloudï¼‰</li><li>ç‚¹äº‘ä¸€èˆ¬åŒ…æ‹¬æ ¹æ®æ¿€å…‰æµ‹é‡å¾—åˆ°çš„ç‚¹äº‘å’Œæ ¹ç»æ‘„å½±æµ‹é‡å¾—åˆ°çš„ç‚¹äº‘<ul><li>æ¿€å…‰æµ‹é‡çš„ç‚¹äº‘åŒ…æ‹¬ä¸‰ç»´åæ ‡ï¼ˆXYZï¼‰å’Œæ¿€å…‰åå°„å¼ºåº¦ï¼ˆIntensityï¼‰ã€‚å¼ºåº¦ä¿¡æ¯ä¸ç›®æ ‡çš„è¡¨é¢æè´¨ã€ç²—ç³™åº¦ã€å…¥å°„è§’æ–¹å‘ï¼Œä»¥åŠä»ªå™¨çš„å‘å°„èƒ½é‡ï¼Œæ¿€å…‰æ³¢é•¿æœ‰å…³</li><li>æ‘„å½±æµ‹é‡åŸç†å¾—åˆ°çš„ç‚¹äº‘ï¼ŒåŒ…æ‹¬ä¸‰ç»´åæ ‡ï¼ˆXYZï¼‰å’Œé¢œè‰²ä¿¡æ¯ï¼ˆRGBï¼‰</li><li>ä¹Ÿæœ‰æŠŠæ¿€å…‰å’Œæ‘„å½±ç›¸ç»“åˆåœ¨ä¸€èµ·çš„ï¼ˆå¤šä¼ æ„Ÿå™¨èåˆæŠ€æœ¯ï¼‰ï¼Œè¿™ç§ç»“åˆæ¿€å…‰æµ‹é‡å’Œæ‘„å½±æµ‹é‡åŸç†å¾—åˆ°ç‚¹äº‘ï¼ŒåŒ…æ‹¬ä¸‰ç»´åæ ‡ï¼ˆXYZï¼‰ã€æ¿€å…‰åå°„å¼ºåº¦ï¼ˆIntensityï¼‰å’Œé¢œè‰²ä¿¡æ¯ï¼ˆRGBï¼‰</li></ul></li></ul><h1 id="ä»€ä¹ˆæ˜¯ç‚¹äº‘é…å‡†"><a href="#ä»€ä¹ˆæ˜¯ç‚¹äº‘é…å‡†" class="headerlink" title="ä»€ä¹ˆæ˜¯ç‚¹äº‘é…å‡†"></a>ä»€ä¹ˆæ˜¯ç‚¹äº‘é…å‡†</h1><p>ç‚¹äº‘é…å‡†ï¼ˆPoint Cloud Registrationï¼‰æŒ‡çš„æ˜¯è¾“å…¥ä¸¤å¹…ç‚¹äº‘$P_s$ï¼ˆSourceï¼‰å’Œ$P_t$ï¼ˆTargetï¼‰ ï¼Œè¾“å‡ºä¸€ä¸ªå˜æ¢$T$ä½¿å¾—$T(P_s)$å’Œ$P_t$çš„é‡åˆç¨‹åº¦å°½å¯èƒ½é«˜ã€‚å˜æ¢$T$å¯ä»¥æ˜¯åˆšæ€§çš„ï¼ˆRigidï¼‰ï¼Œä¹Ÿå¯ä»¥ä¸æ˜¯ï¼Œä¸‹é¢åªè€ƒè™‘åˆšæ€§å˜æ¢ï¼Œå³å˜æ¢åªåŒ…æ‹¬æ—‹è½¬ï¼ˆ$R$ï¼‰ã€å¹³ç§»ï¼ˆ$t$ï¼‰ã€‚</p><p>ç‚¹äº‘é…å‡†å¯ä»¥åˆ†ä¸ºç²—é…å‡†ï¼ˆCoarse Registrationï¼‰å’Œç²¾é…å‡†ï¼ˆFine Registrationï¼‰ä¸¤æ­¥ã€‚ç²—é…å‡†æŒ‡çš„æ˜¯åœ¨ä¸¤å¹…ç‚¹äº‘ä¹‹é—´çš„å˜æ¢å®Œå…¨æœªçŸ¥çš„æƒ…å†µä¸‹è¿›è¡Œè¾ƒä¸ºç²—ç³™çš„é…å‡†ï¼Œç›®çš„ä¸»è¦æ˜¯ä¸ºç²¾é…å‡†æä¾›è¾ƒå¥½çš„å˜æ¢åˆå€¼ï¼›ç²¾é…å‡†åˆ™æ˜¯ç»™å®šä¸€ä¸ªåˆå§‹å˜æ¢ï¼Œè¿›ä¸€æ­¥ä¼˜åŒ–å¾—åˆ°æ›´ç²¾ç¡®çš„å˜æ¢ã€‚</p><p>ç›®å‰åº”ç”¨æœ€å¹¿æ³›çš„ç‚¹äº‘ç²¾é…å‡†ç®—æ³•æ˜¯è¿­ä»£æœ€è¿‘ç‚¹ç®—æ³•ï¼ˆIterative Closest Pointï¼ŒICPï¼‰åŠå„ç§å˜ç§ICPç®—æ³•ã€‚</p><h1 id="ICPï¼Œå±€éƒ¨ç‚¹äº‘é…å‡†"><a href="#ICPï¼Œå±€éƒ¨ç‚¹äº‘é…å‡†" class="headerlink" title="ICPï¼Œå±€éƒ¨ç‚¹äº‘é…å‡†"></a>ICPï¼Œå±€éƒ¨ç‚¹äº‘é…å‡†</h1><p>ICPï¼ŒIterative Closest Pointï¼Œå³è¿­ä»£æœ€è¿‘ç‚¹ç®—æ³•ï¼Œæ˜¯åº”ç”¨æœ€å¹¿æ³›çš„3Dç‚¹äº‘é…å‡†ç®—æ³•ä¹‹ä¸€ï¼Œ å…¶é€šè¿‡æ¬§å¼å˜æ¢æ±‚è§£å‡ºä¸¤ç‰‡ç‚¹äº‘çš„æ—‹è½¬å¹³ç§»çŸ©é˜µåŠå¯¹åº”çš„é…å‡†è¯¯å·®ã€‚</p><h2 id="ç®—æ³•æè¿°"><a href="#ç®—æ³•æè¿°" class="headerlink" title="ç®—æ³•æè¿°"></a>ç®—æ³•æè¿°</h2><p>å¯¹äº$T$æ˜¯åˆšæ€§å˜æ¢çš„æƒ…å½¢ï¼Œç‚¹äº‘é…å‡†é—®é¢˜å¯ä»¥æè¿°ä¸º</p><p>$$<br>R^*,t^*&#x3D;\mathop{arg\ min}\limits_{R,t}\frac{1}{|P_s|}\sum_{i&#x3D;1}^{|P_s|}||p_t^i-(R\cdotp_s^i+t)||^2<br>$$</p><p>å…¶ä¸­$p_s,p_t$æ˜¯æºç‚¹äº‘å’Œç›®æ ‡ç‚¹äº‘ä¸­çš„å¯¹åº”ç‚¹</p><h2 id="ç®—æ³•æµç¨‹"><a href="#ç®—æ³•æµç¨‹" class="headerlink" title="ç®—æ³•æµç¨‹"></a>ç®—æ³•æµç¨‹</h2><ol><li>ç‚¹äº‘é¢„å¤„ç†ï¼Œå¦‚æ»¤æ³¢ã€æ¸…æ´—ç­‰</li><li>åˆ©ç”¨ä¸€äº›ç‚¹è§£å‡ºçš„å˜æ¢ï¼Œå¯»æ‰¾æœ€è¿‘ç‚¹</li><li>è°ƒæ•´éƒ¨åˆ†å¯¹åº”ç‚¹çš„æƒé‡</li><li>åˆ é™¤ä¸åˆç†å¯¹åº”ç‚¹</li><li>è®¡ç®—Lossï¼Œæœ€å°åŒ–Losså¹¶æ±‚è§£å½“å‰æœ€ä¼˜å˜æ¢</li><li>é‡å¤2-6ï¼Œè¿­ä»£æ”¶æ•›</li></ol><h2 id="å¯»æ‰¾æœ€è¿‘ç‚¹"><a href="#å¯»æ‰¾æœ€è¿‘ç‚¹" class="headerlink" title="å¯»æ‰¾æœ€è¿‘ç‚¹"></a>å¯»æ‰¾æœ€è¿‘ç‚¹</h2><p>åˆ©ç”¨åˆå§‹$R_0,t_0$æˆ–ä¸Šä¸€æ¬¡è¿­ä»£å¾—åˆ°çš„$R_{k-1},t_{k-1}$å¯¹åˆå§‹ç‚¹äº‘è¿›è¡Œå˜æ¢ï¼Œå¾—åˆ°ä¸€ä¸ªä¸´æ—¶çš„å˜æ¢ç‚¹äº‘ï¼Œç„¶åç”¨è¿™ä¸ªç‚¹äº‘å’Œç›®æ ‡ç‚¹äº‘è¿›è¡Œæ¯”è¾ƒï¼Œæ‰¾å‡ºæºç‚¹äº‘ä¸­æ¯ä¸€ä¸ªç‚¹åœ¨ç›®æ ‡ç‚¹äº‘ä¸­çš„æœ€è¿‘é‚»ç‚¹ã€‚</p><p>å¦‚æœç›´æ¥è¿›è¡Œæ¯”è¾ƒæ‰¾æœ€è¿‘é‚»ç‚¹ï¼Œéœ€è¦è¿›è¡Œä¸¤é‡å¾ªç¯ï¼Œè®¡ç®—å¤æ‚åº¦ä¸º $O(|P_s|\cdot |P_t|)$ï¼Œè¿™ä¸€æ­¥ä¼šæ¯”è¾ƒè€—æ—¶ï¼Œå¸¸è§çš„åŠ é€Ÿæ–¹æ³•æœ‰</p><ul><li>è®¾ç½®è·ç¦»é˜ˆå€¼ï¼Œå½“ç‚¹ä¸ç‚¹è·ç¦»å°äºä¸€å®šé˜ˆå€¼å°±è®¤ä¸ºæ‰¾åˆ°äº†å¯¹åº”ç‚¹ï¼Œä¸ç”¨éå†å®Œæ•´ä¸ªç‚¹é›†</li><li>ä½¿ç”¨ ANN(Approximate Nearest Neighbor) åŠ é€ŸæŸ¥æ‰¾ï¼Œå¸¸ç”¨çš„æœ‰ KD-treeï¼›KD-tree å»ºæ ‘çš„è®¡ç®—å¤æ‚åº¦ä¸º$O(N\log(N))$ï¼ŒæŸ¥æ‰¾é€šå¸¸å¤æ‚åº¦ä¸º$O(\log(N))$ï¼Œæœ€åæƒ…å†µä¸‹$O(N)$</li></ul><h2 id="æ±‚è§£æœ€ä¼˜å˜æ¢"><a href="#æ±‚è§£æœ€ä¼˜å˜æ¢" class="headerlink" title="æ±‚è§£æœ€ä¼˜å˜æ¢"></a>æ±‚è§£æœ€ä¼˜å˜æ¢</h2><p>å¯¹äºPoint-to-Point ICPé—®é¢˜ï¼Œæ±‚æœ€ä¼˜å˜æ¢æ˜¯æœ‰é—­å½¢å¼è§£ï¼ˆClosed-Form Solutionï¼‰çš„ï¼Œå¯ä»¥å€ŸåŠ©SVDåˆ†è§£æ¥è®¡ç®—ã€‚</p><ul><li><p>ç»“è®º</p><p>  åœ¨å·²çŸ¥ç‚¹çš„å¯¹åº”å…³ç³»çš„æƒ…å†µä¸‹ï¼Œè®¾$\overline{p}_s,\overline{p}_t$åˆ†åˆ«è¡¨ç¤ºæºç‚¹äº‘å’Œç›®æ ‡ç‚¹äº‘çš„è´¨å¿ƒï¼Œä»¤$\hat{p}_s^i&#x3D;p_s^i-\overline{p}_s^i\ ,\ \ \hat{p}_t^i&#x3D;p_t^i-\overline{p}<em>t^i\ ,\ \ H&#x3D;\sum</em>{i&#x3D;1}^{|P_s|}\hat{p}_s^i{\hat{p}_t^i}^T$ï¼Œè¿™æ˜¯ä¸€ä¸ª$3\times 3$çŸ©é˜µï¼Œå¯¹$H$è¿›è¡ŒSVDåˆ†è§£å¾—åˆ°$H&#x3D;U\Sigma V^T$ï¼Œåˆ™Point-to-Point ICPçš„æœ€ä¼˜è§£ä¸º</p><p>  $$<br>  R^*&#x3D;VU^T<br>  $$</p><p>  æœ€ä¼˜å¹³ç§»ä¸º</p><p>  $$<br>  t^*&#x3D;\overline{p}_t-R^*\cdot\overline{p}_s<br>  $$</p></li><li><p>æœ€ä¼˜å¹³ç§»</p><p>  ä»¤$N&#x3D;|P_s|$ï¼Œè®¾$F(t)&#x3D;\sum_{i&#x3D;1}^N||(R\cdot p_s^i+t)-p_t^i||^2$ï¼Œå¯¹å…¶è¿›è¡Œæ±‚å¯¼ï¼Œåˆ™æœ‰</p><p>  $$<br>  \begin{aligned}\frac{\partial F}{\partial t}&amp;&#x3D;\sum_{i&#x3D;1}^N2(R\cdotp_s^i+t-p_t^i)\&amp;&#x3D;2nt+2R\sum_{i&#x3D;1}^Np_s^i-2\sum_{i&#x3D;1}^Np_t^i\end{aligned}<br>  $$</p><p>  ä»¤å¯¼æ•°ä¸º0ï¼Œå¾—</p><p>  $$<br>  \begin{aligned}t&amp;&#x3D;\frac{1}{N}\sum_{i&#x3D;1}^Np_t^i-R\frac{1}{N}\sum_{i&#x3D;1}^Np_s^i\&amp;&#x3D;\overline{p}_t^i-R\cdot\overline{p}_s^i\end{aligned}<br>  $$</p><p>  æ— è®º$R$å–å€¼å¦‚ä½•ï¼Œæ ¹æ®ä¸Šå¼æˆ‘ä»¬éƒ½å¯ä»¥æ±‚å¾—æœ€ä¼˜çš„ tï¼Œä½¿å¾— loss æœ€å°</p></li><li><p>æœ€ä¼˜æ—‹è½¬</p><p>  ç»è¿‡æœ€ä¼˜å¹³ç§»çš„æ¨å¯¼ï¼Œæˆ‘ä»¬çŸ¥é“æ— è®ºæ—‹è½¬å¦‚ä½•å–å€¼ï¼Œéƒ½å¯ä»¥é€šè¿‡è®¡ç®—ç‚¹äº‘çš„è´¨å¿ƒæ¥å¾—åˆ°æœ€ä¼˜å¹³ç§»ï¼Œä¸ºäº†ä¸‹é¢è®¡ç®—ä¸Šçš„ç®€ä¾¿ï¼Œæˆ‘ä»¬ä¸å¦¨ä¸è€ƒè™‘å¹³ç§»çš„å½±å“ï¼Œå…ˆå°†æºç‚¹äº‘å’Œç›®æ ‡ç‚¹äº‘éƒ½è½¬æ¢åˆ°è´¨å¿ƒåæ ‡ä¸‹ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¹‹å‰ä»¤$\hat{p}_s^i&#x3D;p_s^i-\overline{p}_s^i\ ,\ \ \hat{p}_t^i&#x3D;p_t^i-\overline{p}_t^i$çš„æ„ä¹‰ã€‚</p><p>  ä¸è€ƒè™‘å¹³ç§»ï¼Œåˆ™Losså¯ä»¥å†™æˆ</p><p>  $$<br>  F(R)&#x3D;\sum_{i&#x3D;1}^N||R\cdot \hat{p}_s^i-\hat{p}_t^i||^2<br>  $$</p><p>  åŒ–ç®€æœ‰</p><p>  $$<br>  \begin{aligned}||R\cdot \hat{p}_s^i-\hat{p}_t^i||^2&amp;&#x3D;(R\cdot \hat{p}_s^i-\hat{p}_t^i)^T(R\cdot \hat{p}_s^i-\hat{p}_t^i)\&amp;&#x3D;({\hat{p}_s^i}^TR^T-{\hat{p}_t^i}^T)(R\cdot \hat{p}_s^i-\hat{p}_t^i)\&amp;&#x3D;{\hat{p}_s^i}^TR^TR\hat{p}_s^i-{\hat{p}_t^i}^TR{\hat{p}_s^i}-{\hat{p}_s^i}^TR^T{\hat{p}_t^i}+{\hat{p}_t^i}^T{\hat{p}_t^i}\&amp;&#x3D;||{\hat{p}_s^i}||^2+||{\hat{p}_t^i}||^2-{\hat{p}_t^i}^TR{\hat{p}_s^i}-{\hat{p}_s^i}^TR^T{\hat{p}_t^i}\&amp;&#x3D;||{\hat{p}_s^i}||^2+||{\hat{p}_t^i}||^2-2{\hat{p}_t^i}^TR{\hat{p}_s^i}\end{aligned}<br>  $$</p><p>  å…¶ä¸­ï¼Œ$R^TR&#x3D;I,{\hat{p}_t^i}^TR{\hat{p}_s^i}&#x3D;{\hat{p}_s^i}^TR^T{\hat{p}_t^i}$</p><p>  ç”±äºç‚¹çš„åæ ‡æ˜¯ç¡®å®šçš„ï¼ˆå’Œ$R$æ— å…³ï¼‰ï¼Œæ‰€ä»¥æœ€å°åŒ–åŸLossç­‰ä»·äºæ±‚</p><p>  $$<br>  R^*&#x3D;\mathop{arg \ min}\limits_{R}(-2\sum_{i&#x3D;1}^N{\hat{p}_t^i}^TR{\hat{p}_s^i})<br>  $$</p><p>  ç”±äº$trace(AB)&#x3D;trace(BA)$ï¼Œå³æœ‰</p><p>  $$<br>  \begin{aligned}R^*&amp;&#x3D;\mathop{arg \ max}\limits_{R}(\sum_{i&#x3D;1}^N{\hat{p}<em>t^i}^TR{\hat{p}<em>s^i})\&amp;&#x3D;\mathop{arg \ max}\limits</em>{R} \ trace(P_t^TRP_s)\&amp;&#x3D;\mathop{arg \ max}\limits</em>{R} \ trace(RP_sP_t^T)\end{aligned}<br>  $$</p><p>  å¸¦å…¥SVDåˆ†è§£ï¼Œå¾—</p><p>  $$<br>  \begin{aligned}trace(RP_sP_t^T)&amp;&#x3D;trace(RH)\&amp;&#x3D;trace(RU\Sigma V^T)\&amp;&#x3D;trace(\Sigma V^TRU)\end{aligned}<br>  $$</p><p>  ç”±äº$V,U,R$éƒ½æ˜¯æ­£äº¤çŸ©é˜µï¼Œæ‰€ä»¥$V^TRU$ä¹Ÿæ˜¯æ­£äº¤çŸ©é˜µï¼Œä»¤</p><p>  $$<br>  M&#x3D;V^TRU&#x3D;\left[\begin{aligned}m_{11}&amp; &amp;m_{12}&amp; &amp;m_{13}\m_{21}&amp; &amp;m_{22}&amp; &amp;m_{23}\m_{31}&amp; &amp;m_{32}&amp; &amp;m_{33}\end{aligned}\right]<br>  $$</p><p>  åˆ™æœ‰</p><p>  $$<br>  \begin{aligned}trace(\Sigma V^TRU)&amp;&#x3D;trace(\Sigma M)\&amp;&#x3D;\sigma_1m_{11}+\sigma_2m_{22}+\sigma_1m_{33}\end{aligned}<br>  $$</p><p>  æ ¹æ®å¥‡å¼‚å€¼éè´Ÿçš„æ€§è´¨å’Œæ­£äº¤çŸ©é˜µçš„æ€§è´¨ï¼ˆæ­£äº¤çŸ©é˜µä¸­çš„å…ƒç´ ç»å¯¹å€¼ä¸å¤§äº 1ï¼‰ï¼Œå®¹æ˜“è¯å¾—åªæœ‰å½“$M$ä¸ºå•ä½é˜µæ—¶$trace(\Sigma M)$æœ€å¤§ï¼Œå³</p><p>  $$<br>  V^TRU&#x3D;I\R&#x3D;VU^T<br>  $$</p><p>  æ‰€ä»¥æœ‰$R^*&#x3D;VU^T$</p><p>  æœ€åè¿˜éœ€è¦è¿›è¡Œ Orientation rectificationï¼Œå³éªŒè¯$R^*&#x3D;VU^T$æ˜¯ä¸æ˜¯ä¸€ä¸ªæ—‹è½¬çŸ©é˜µï¼ˆæ£€æŸ¥æ˜¯å¦æœ‰$|R|&#x3D;1$ï¼‰ï¼Œå› ä¸ºå­˜åœ¨$|R|&#x3D;-1$çš„å¯èƒ½ï¼Œæ­¤æ—¶$R$è¡¨ç¤ºçš„ä¸æ˜¯æ—‹è½¬è€Œæ˜¯ä¸€ä¸ªReflectionï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜è¦ç»™ä¸Šè¿°ä¼˜åŒ–æ±‚è§£åŠ ä¸Šä¸€ä¸ª$|R|&#x3D;1$çš„çº¦æŸï¼Œè¯¦è§<a href="https://www.notion.so/ICP-6b09499500b747c98ce5d0ed770e7f6b">Reference</a></p><p>  è®¡ç®—æ­¥éª¤ä¸º</p><ol><li>è®¡ç®—æºç‚¹äº‘å’Œç›®æ ‡ç‚¹äº‘è´¨å¿ƒ</li><li>å°†æºç‚¹äº‘å’Œç›®æ ‡ç‚¹äº‘è½¬æ¢åˆ°è´¨å¿ƒåæ ‡ç³»</li><li>è®¡ç®—çŸ©é˜µ$H$</li><li>å¯¹$H$æ±‚ SVD åˆ†è§£ï¼Œæ ¹æ®å…¬å¼æ±‚å¾—$R^*$</li><li>æ ¹æ®å…¬å¼è®¡ç®—$t^*$</li></ol></li><li><p>è¿­ä»£</p><p>  æ¯ä¸€æ¬¡è¿­ä»£æˆ‘ä»¬éƒ½ä¼šå¾—åˆ°å½“å‰çš„æœ€ä¼˜å˜æ¢å‚æ•°$R_k,t_k$ï¼Œç„¶åå°†è¯¥å˜æ¢ä½œç”¨äºå½“å‰æºç‚¹äº‘ã€‚æ‰¾æœ€è¿‘å¯¹åº”ç‚¹å’Œæ±‚è§£æœ€ä¼˜å˜æ¢è¿™ä¸¤æ­¥ä¸åœè¿­ä»£è¿›è¡Œï¼Œç›´åˆ°æ»¡è¶³è¿­ä»£ç»ˆæ­¢æ¡ä»¶ï¼Œå¸¸ç”¨çš„ç»ˆæ­¢æ¡ä»¶æœ‰</p><ul><li>$R_k,t_k$çš„å˜åŒ–é‡å°äºä¸€å®šå€¼</li><li>Losså˜åŒ–é‡å°äºä¸€å®šå€¼</li><li>è¾¾åˆ°æœ€å¤§è¿­ä»£æ¬¡æ•°</li></ul></li></ul><h2 id="ä¼˜ç¼ºç‚¹"><a href="#ä¼˜ç¼ºç‚¹" class="headerlink" title="ä¼˜ç¼ºç‚¹"></a>ä¼˜ç¼ºç‚¹</h2><p>ä¼˜ç‚¹</p><ul><li>ç®€å•ï¼Œä¸å¿…å¯¹ç‚¹äº‘è¿›è¡Œåˆ†å‰²å’Œç‰¹å¾æå–</li><li>åˆå€¼è¾ƒå¥½æƒ…å†µä¸‹ï¼Œç²¾åº¦å’Œæ”¶æ•›æ€§éƒ½ä¸é”™</li></ul><p>ç¼ºç‚¹</p><ul><li>æ‰¾æœ€è¿‘å¯¹åº”ç‚¹çš„è®¡ç®—å¼€é”€è¾ƒå¤§</li><li>åªè€ƒè™‘äº†ç‚¹ä¸ç‚¹è·ç¦»ï¼Œç¼ºå°‘å¯¹ç‚¹äº‘ç»“æ„ä¿¡æ¯çš„åˆ©ç”¨</li></ul><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://zhuanlan.zhihu.com/p/91275450">ç‚¹äº‘é…å‡†ç»¼è¿°</a></p><p><a href="https://yilingui.xyz/2019/11/20/191120_point_cloud_registration_icp/">ä¸‰ç»´ç‚¹äº‘é…å‡† â€“ ICP ç®—æ³•</a></p><p><a href="https://www.math.pku.edu.cn/teachers/yaoy/Fall2011/arun.pdf"></a></p>]]></content>
    
    
    <categories>
      
      <category>3D Basic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>point cloud</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ç›¸æœºæ ‡å®š</title>
    <link href="/2022/06/24/%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A/"/>
    <url>/2022/06/24/%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A/</url>
    
    <content type="html"><![CDATA[<h1 id="ç›¸æœºæ ‡å®š"><a href="#ç›¸æœºæ ‡å®š" class="headerlink" title="ç›¸æœºæ ‡å®š"></a>ç›¸æœºæ ‡å®š</h1><h1 id="ç›¸æœºæ ‡å®šæ˜¯ä»€ä¹ˆ"><a href="#ç›¸æœºæ ‡å®šæ˜¯ä»€ä¹ˆ" class="headerlink" title="ç›¸æœºæ ‡å®šæ˜¯ä»€ä¹ˆ"></a>ç›¸æœºæ ‡å®šæ˜¯ä»€ä¹ˆ</h1><p>ç›¸æœºçš„æ“ä½œæ˜¯å°†æˆ‘ä»¬æ‰€å¤„çš„ä¸‰ç»´ç©ºé—´ä¸­çš„æŸä¸ªåœºæ™¯é€šè¿‡æŸä¸ªæ¨¡å‹è½¬æ¢æˆäºŒç»´å›¾åƒï¼Œå¹¶ä¸”è¿™ä¸ª3Dâ†’2Dçš„è¿‡ç¨‹æ˜¯ä¸å¯é€†çš„ã€‚è€Œç›¸æœºæ ‡å®šçš„ç›®æ ‡æ˜¯å¯»æ‰¾ä¸€ä¸ªåˆé€‚çš„æ•°å­¦æ¨¡å‹ï¼Œæ±‚å‡ºè¿™ä¸ªæ¨¡å‹çš„å‚æ•°ï¼Œè¿™æ ·æˆ‘ä»¬èƒ½å¤Ÿè¿‘ä¼¼è¿™ä¸ªä¸‰ç»´åˆ°äºŒç»´çš„è¿‡ç¨‹ï¼Œä½¿è¿™ä¸ªä¸‰ç»´åˆ°äºŒç»´çš„è¿‡ç¨‹çš„å‡½æ•°æ‰¾åˆ°åå‡½æ•°ã€‚æ•´ä¸ªé€¼è¿‘çš„è¿‡ç¨‹å°±æ˜¯ç›¸æœºæ ‡å®šï¼Œç”¨ç®€å•çš„æ•°å­¦æ¨¡å‹æ¥è¡¨è¾¾å¤æ‚çš„æˆåƒè¿‡ç¨‹ï¼Œå¹¶ä¸”æ±‚å‡ºæˆåƒçš„åè¿‡ç¨‹ã€‚æ ‡å®šä¹‹åçš„ç›¸æœºï¼Œå¯ä»¥è¿›è¡Œä¸‰ç»´åœºæ™¯çš„é‡å»ºï¼Œå³æ·±åº¦çš„æ„ŸçŸ¥ã€‚</p><p>åœ¨å›¾åƒæµ‹é‡è¿‡ç¨‹ä»¥åŠæœºå™¨è§†è§‰åº”ç”¨ä¸­ï¼Œä¸ºç¡®å®šç©ºé—´ç‰©ä½“è¡¨é¢æŸç‚¹çš„ä¸‰ç»´å‡ ä½•ä½ç½®ä¸å…¶åœ¨å›¾åƒä¸­å¯¹åº”ç‚¹ä¹‹é—´çš„ç›¸äº’å…³ç³»ï¼Œå¿…é¡»å»ºç«‹ç›¸æœºæˆåƒçš„å‡ ä½•æ¨¡å‹ï¼Œè¿™äº›å‡ ä½•æ¨¡å‹å‚æ•°å°±æ˜¯ç›¸æœºå‚æ•°ã€‚åœ¨å¤§å¤šæ•°æ¡ä»¶ä¸‹è¿™äº›å‚æ•°å¿…é¡»é€šè¿‡å®éªŒä¸è®¡ç®—æ‰èƒ½å¾—åˆ°ï¼Œè¿™ä¸ªæ±‚è§£å‚æ•°çš„è¿‡ç¨‹å°±æ˜¯ç›¸æœºæ ‡å®šã€‚æ— è®ºæ˜¯åœ¨å›¾åƒæµ‹é‡æˆ–è€…æœºå™¨è§†è§‰åº”ç”¨ä¸­ï¼Œç›¸æœºå‚æ•°çš„æ ‡å®šéƒ½æ˜¯éå¸¸å…³é”®çš„ç¯èŠ‚ï¼Œå…¶æ ‡å®šç»“æœçš„ç²¾åº¦åŠç®—æ³•çš„ç¨³å®šæ€§ç›´æ¥å½±å“ç›¸æœºå·¥ä½œäº§ç”Ÿç»“æœçš„å‡†ç¡®æ€§ã€‚</p><h1 id="åæ ‡ç³»"><a href="#åæ ‡ç³»" class="headerlink" title="åæ ‡ç³»"></a>åæ ‡ç³»</h1><ul><li><p>ä¸–ç•Œåæ ‡ç³»</p><p>  ä¸–ç•Œåæ ‡ç³»ï¼ˆWorld Coordinateï¼‰$(x_w,y_w,z_w)$ï¼Œä¹Ÿç§°ä¸ºæµ‹é‡åæ ‡ç³»ï¼Œä¸‰ç»´ç›´è§’åæ ‡ç³»ï¼Œä»¥å…¶ä¸ºåŸºå‡†å¯ä»¥æè¿°ç›¸æœºå’Œå¾…æµ‹ç‰©ä½“çš„ç©ºé—´ä½ç½®ã€‚ä¸–ç•Œåæ ‡ç³»çš„ä½ç½®å¯ä»¥æ ¹æ®å®é™…æƒ…å†µè‡ªç”±ç¡®å®š</p></li><li><p>ç›¸æœºåæ ‡ç³»</p><p>  ç›¸æœºåæ ‡ç³»ï¼ˆCamera Coordinateï¼‰$(x_c,y_c,z_c)$ï¼Œä¸‰ç»´ç›´è§’åæ ‡ç³»ï¼ŒåŸç‚¹ä½äºé•œå¤´å…‰å¿ƒå¤„ï¼Œ$x,y$è½´åˆ†åˆ«ä¸ç›¸é¢çš„ä¸¤è¾¹å¹³è¡Œï¼Œ$z$è½´ä¸ºé•œå¤´å…‰è½´ï¼Œä¸åƒå¹³é¢å‚ç›´</p></li><li><p>åƒç´ åæ ‡ç³»</p><p>  åƒç´ åæ ‡ç³»$uov$æ˜¯ä¸€ä¸ªäºŒç»´ç›´è§’åæ ‡ç³»ï¼Œåæ˜ äº†ç›¸æœºCCD&#x2F;CMOSèŠ¯ç‰‡ä¸­åƒç´ çš„æ’åˆ—æƒ…å†µã€‚åŸç‚¹$o$ä½äºå›¾åƒçš„å·¦ä¸Šè§’ï¼Œ$u,v$è½´åˆ†åˆ«äºåƒé¢çš„ä¸¤è¾¹å¹³è¡Œã€‚åƒç´ åæ ‡ç³»ä¸­åæ ‡è½´çš„å•ä½æ˜¯åƒç´ ï¼ˆæ•´æ•°ï¼‰</p></li><li><p>å›¾åƒåæ ‡ç³»</p><p>  åƒç´ åæ ‡ç³»ä¸åˆ©äºåæ ‡å˜æ¢ï¼Œå› æ­¤éœ€è¦å»ºç«‹å›¾åƒåæ ‡ç³»$XOY$ï¼Œå…¶åæ ‡è½´çš„å•ä½é€šå¸¸ä¸ºæ¯«ç±³ï¼ŒåŸç‚¹æ˜¯ç›¸æœºå…‰è½´ä¸ç›¸é¢çš„äº¤ç‚¹ï¼ˆç§°ä¸ºä¸»ç‚¹ï¼‰ï¼Œå³å›¾åƒçš„ä¸­å¿ƒç‚¹ï¼Œ$X,Y$è½´åˆ†åˆ«ä¸$u,v$è½´å¹³è¡Œã€‚æ•…ä¸¤ä¸ªåæ ‡ç³»å®é™…æ˜¯å¹³ç§»å…³ç³»ï¼Œå³å¯ä»¥é€šè¿‡å¹³ç§»å°±å¯å¾—åˆ°</p></li><li><p>ä¸–ç•Œåæ ‡ç³»è½¬æ¢ä¸ºç›¸æœºåæ ‡ç³»</p><p>  $$<br>  \left[\begin{aligned}&amp;x_c\&amp;y_c\&amp;z_c\&amp;1\end{aligned}\right]&#x3D;\left[\begin{aligned}&amp;R &amp;t\&amp;0 &amp;1\end{aligned}\right]\left[\begin{aligned}&amp;x_w\&amp;y_w\&amp;z_w\&amp;1\end{aligned}\right]<br>  $$</p><p>  å…¶ä¸­$R$ä¸º$3\times3$çš„æ—‹è½¬çŸ©é˜µï¼Œ$t$ä¸º$3\times1$çš„å¹³ç§»çŸ¢é‡ï¼Œ$[x_c,y_c,z_c,1]^T$ä¸ºç›¸æœºåæ ‡ç³»çš„é½æ¬¡åæ ‡ï¼Œ$[x_w,y_w,z_w,1]^T$ä¸ºä¸–ç•Œåæ ‡ç³»çš„é½æ¬¡åæ ‡</p></li><li><p>å›¾åƒåæ ‡ç³»è½¬æ¢ä¸ºåƒç´ åæ ‡ç³»</p><p>  $$<br>  \left[\begin{aligned}&amp;u\&amp;v\&amp;1\end{aligned}\right]&#x3D;\left[\begin{aligned}&amp;\frac{1}{dX} &amp;0&amp; \ &amp;u_0\&amp;0 &amp;\frac{1}{dY}&amp; \ &amp;v_0\&amp;0 &amp;0&amp; \ &amp;1\end{aligned}\right]\left[\begin{aligned}&amp;X\&amp;Y\&amp;1\end{aligned}\right]<br>  $$</p><p>  å…¶ä¸­ï¼Œ$dX,dY$åˆ†åˆ«ä¸ºåƒç´ åœ¨$X,Y$è½´æ–¹å‘ä¸Šçš„ç‰©ç†å°ºå¯¸ï¼Œ$u_0,v_0$ä¸ºä¸»ç‚¹ï¼ˆå›¾åƒåŸç‚¹ï¼‰åæ ‡</p></li><li><p>é’ˆå­”ç›¸æœºæ¨¡å‹</p><p>  ç›¸æœºæˆåƒæ¨¡å‹ç®€åŒ–ä¸ºé’ˆå­”æ¨¡å‹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p>  <img src="/./2022/06/24/%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A/pinhole.png" alt="pinhole"></p><p>  ç©ºé—´ä»»æ„ä¸€ç‚¹$P$ä¸å…¶å›¾åƒç‚¹$p$ä¹‹é—´çš„å…³ç³»ï¼Œ$P$ä¸ç›¸æœºå…‰å¿ƒ$o$çš„è¿çº¿ä¸º$oP$ï¼Œ$oP$ä¸åƒé¢çš„äº¤ç‚¹$p$å³ä¸ºç©ºé—´ç‚¹$P$åœ¨å›¾åƒå¹³é¢ä¸Šçš„æŠ•å½±ã€‚è¯¥è¿‡ç¨‹ä¸ºé€è§†æŠ•å½±ï¼Œå¦‚ä¸‹çŸ©é˜µè¡¨ç¤º</p><p>  $$<br>  s\left[\begin{aligned}&amp;X\&amp;Y\&amp;1\end{aligned}\right]&#x3D;\left[\begin{aligned}&amp;f &amp;0&amp; &amp;0&amp; &amp;0\&amp;0 &amp;f&amp; &amp;0&amp; &amp;0 \&amp;0 &amp;0&amp; &amp;1&amp; &amp;0\end{aligned}\right]\left[\begin{aligned}&amp;x\&amp;y\&amp;z\&amp;1\end{aligned}\right]<br>  $$</p><p>  å…¶ä¸­$s$ä¸ºç¼©æ”¾å› å­ï¼Œ$f$ä¸ºæœ‰æ•ˆç„¦è·ï¼ˆå…‰å¿ƒåˆ°å›¾åƒå¹³é¢çš„è·ç¦»ï¼‰ï¼Œ$[x,y,z,1]^T$æ˜¯ç©ºé—´ç‚¹$P$åœ¨ç›¸æœºåæ ‡ç³»$oxyz$ä¸­çš„é½æ¬¡ï¼Œ$[X,Y,1]^T$æ˜¯å›¾åƒç‚¹$p$åœ¨å›¾åƒåæ ‡ç³»$OXY$ä¸­çš„é½æ¬¡åæ ‡</p></li><li><p>ä¸–ç•Œåæ ‡ç³»è½¬æ¢ä¸ºåƒç´ åæ ‡ç³»</p><p>  $$<br>  s\left[\begin{aligned}&amp;u\&amp;v\&amp;1\end{aligned}\right]&#x3D;\left[\begin{aligned}&amp;\frac{1}{dX} &amp;0&amp; \ &amp;u_0\&amp;0 &amp;\frac{1}{dY}&amp; \ &amp;v_0\&amp;0 &amp;0&amp; \ &amp;1\end{aligned}\right]\left[\begin{aligned}&amp;f &amp;0&amp; &amp;0&amp; &amp;0\&amp;0 &amp;f&amp; &amp;0&amp; &amp;0 \&amp;0 &amp;0&amp; &amp;1&amp; &amp;0\end{aligned}\right]\left[\begin{aligned}&amp;R &amp;t\&amp;0 &amp;1\end{aligned}\right]\left[\begin{aligned}&amp;x_w\&amp;y_w\&amp;z_w\&amp;1\end{aligned}\right]\&#x3D;\left[\begin{aligned}&amp;\alpha_x &amp;0&amp; &amp;u_0&amp; &amp;0\&amp;0 &amp;\alpha_y&amp; &amp;v_0&amp; &amp;0 \&amp;0 &amp;0&amp; &amp;1&amp; &amp;0\end{aligned}\right]\left[\begin{aligned}&amp;R &amp;t\&amp;0 &amp;1\end{aligned}\right]\left[\begin{aligned}&amp;x_w\&amp;y_w\&amp;z_w\&amp;1\end{aligned}\right]&#x3D;M_1M_2X_w&#x3D;MX_w<br>  $$</p><p>  å…¶ä¸­ï¼Œ$\alpha_x&#x3D;f&#x2F;dX,\alpha_y&#x3D;f&#x2F;dY$ï¼Œç§°ä¸º$u,v$è½´çš„å°ºåº¦å› å­ï¼Œ$M_1$ç§°ä¸ºç›¸æœºçš„å†…éƒ¨å‚æ•°çŸ©é˜µï¼Œ$M_2$ç§°ä¸ºç›¸æœºçš„å¤–éƒ¨å‚æ•°çŸ©é˜µï¼Œ$M$ç§°ä¸ºæŠ•å½±çŸ©é˜µ</p></li></ul><h1 id="ç•¸å˜å‚æ•°"><a href="#ç•¸å˜å‚æ•°" class="headerlink" title="ç•¸å˜å‚æ•°"></a>ç•¸å˜å‚æ•°</h1><p>ç•¸å˜ï¼ˆdistortionï¼‰æ˜¯å¯¹ç›´çº¿æŠ•å½±ï¼ˆrectilinear projectionï¼‰çš„ä¸€ç§åç§»ã€‚ç®€å•æ¥è¯´ç›´çº¿æŠ•å½±æ˜¯åœºæ™¯å†…çš„ä¸€æ¡ç›´çº¿æŠ•å½±åˆ°å›¾ç‰‡ä¸Šä¹Ÿä¿æŒä¸ºä¸€æ¡ç›´çº¿ã€‚ç•¸å˜ç®€å•æ¥è¯´å°±æ˜¯ä¸€æ¡ç›´çº¿æŠ•å½±åˆ°å›¾ç‰‡ä¸Šä¸èƒ½ä¿æŒä¸ºä¸€æ¡ç›´çº¿äº†ï¼Œè¿™æ˜¯ä¸€ç§å…‰å­¦ç•¸å˜ï¼ˆoptical aberrationï¼‰ã€‚</p><p>ç•¸å˜ä¸€èˆ¬å¯ä»¥åˆ†ä¸ºå¾„å‘ç•¸å˜å’Œåˆ‡å‘ç•¸å˜ã€‚å¾„å‘ç•¸å˜æ¥è‡ªäºé€é•œå½¢çŠ¶ï¼Œåˆ‡å‘ç•¸å˜æ¥è‡ªäºæ•´ä¸ªæ‘„åƒæœºçš„ç»„è£…è¿‡ç¨‹ã€‚ç•¸å˜è¿˜æœ‰å…¶ä»–ç±»å‹çš„ç•¸å˜ï¼Œä½†æ˜¯æ²¡æœ‰å¾„å‘ç•¸å˜ã€åˆ‡å‘ç•¸å˜æ˜¾è‘—ã€‚</p><p>å®é™…æ‘„åƒæœºçš„é€é•œæ€»æ˜¯åœ¨æˆåƒä»ªçš„è¾¹ç¼˜äº§ç”Ÿæ˜¾è‘—çš„ç•¸å˜ï¼Œè¿™ç§ç°è±¡æ¥æºäºâ€œç­’å½¢â€æˆ–â€œé±¼çœ¼â€çš„å½±å“ã€‚å…‰çº¿åœ¨åŸç†é€é•œä¸­å¿ƒçš„åœ°æ–¹æ¯”é è¿‘ä¸­å¿ƒçš„åœ°æ–¹æ›´åŠ å¼¯æ›²ã€‚å¯¹äºå¸¸ç”¨çš„æ™®é€šé€é•œæ¥è¯´ï¼Œè¿™ç§ç°è±¡æ›´åŠ ä¸¥é‡ã€‚å¯¹äºå¾„å‘ç•¸å˜ï¼Œæˆåƒä»ªä¸­å¿ƒï¼ˆå…‰å­¦ä¸­å¿ƒï¼‰çš„ç•¸å˜ä¸º0ï¼Œéšç€å‘è¾¹ç¼˜ç§»åŠ¨ï¼Œç•¸å˜è¶Šæ¥è¶Šä¸¥é‡ã€‚</p><p><img src="/./2022/06/24/%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A/distortion1.png" alt="distortion1"></p><p>åˆ‡å‘ç•¸å˜æ˜¯ç”±äºé€é•œåˆ¶é€ ä¸Šçš„ç¼ºé™·ä½¿å¾—é€é•œæœ¬èº«ä¸å›¾åƒå¹³é¢ä¸å¹³è¡Œè€Œäº§ç”Ÿçš„ã€‚</p><p><img src="/./2022/06/24/%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A/distortion2.png" alt="distortion2"></p><h1 id="å¼ æ­£å‹æ ‡å®šæ³•"><a href="#å¼ æ­£å‹æ ‡å®šæ³•" class="headerlink" title="å¼ æ­£å‹æ ‡å®šæ³•"></a>å¼ æ­£å‹æ ‡å®šæ³•</h1><p>å¼ æ­£å‹æ ‡å®šæ³•åˆ©ç”¨å¦‚ä¸‹å›¾æ‰€ç¤ºçš„æ£‹ç›˜æ ¼æ ‡å®šæ¿ï¼Œåœ¨å¾—åˆ°ä¸€å¼ æ ‡å®šæ¿çš„å›¾åƒä¹‹åï¼Œå¯ä»¥åˆ©ç”¨ç›¸åº”çš„å›¾åƒæ£€æµ‹ç®—æ³•å¾—åˆ°æ¯ä¸€ä¸ªè§’ç‚¹çš„åƒç´ åæ ‡$(u,v)$ã€‚</p><p><img src="/./2022/06/24/%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A/zhang.png" alt="zhang"></p><p>å¼ æ­£å‹æ ‡å®šæ³•å°†ä¸–ç•Œåæ ‡ç³»å›ºå®šäºæ£‹ç›˜æ ¼ä¸Šï¼Œåˆ™æ£‹ç›˜æ ¼ä¸Šä»»ä¸€ç‚¹çš„ç‰©ç†åæ ‡$W&#x3D;0$ï¼Œç”±äºæ ‡å®šæ¿çš„ä¸–ç•Œåæ ‡ç³»æ˜¯äººä¸ºäº‹å…ˆå®šä¹‰å¥½çš„ï¼Œæ ‡å®šæ¿ä¸Šæ¯ä¸€ä¸ªæ ¼å­çš„å¤§å°æ˜¯å·²çŸ¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å¾—åˆ°æ¯ä¸€ä¸ªè§’ç‚¹åœ¨ä¸–ç•Œåæ ‡ç³»ä¸‹çš„ç‰©ç†åæ ‡$(U,V,W&#x3D;0)$ã€‚</p><p>æˆ‘ä»¬å°†åˆ©ç”¨è¿™äº›ä¿¡æ¯ï¼šæ¯ä¸€ä¸ªè§’ç‚¹çš„åƒç´ åæ ‡$(u,v)$ ã€æ¯ä¸€ä¸ªè§’ç‚¹åœ¨ä¸–ç•Œåæ ‡ç³»ä¸‹çš„ç‰©ç†åæ ‡$(U,V,W&#x3D;0)$ï¼Œæ¥è¿›è¡Œç›¸æœºçš„æ ‡å®šï¼Œè·å¾—ç›¸æœºçš„å†…å¤–å‚çŸ©é˜µã€ç•¸å˜å‚æ•°ã€‚</p><h2 id="æ ‡å®šç›¸æœºçš„å†…å¤–å‚æ•°çš„æ€è·¯"><a href="#æ ‡å®šç›¸æœºçš„å†…å¤–å‚æ•°çš„æ€è·¯" class="headerlink" title="æ ‡å®šç›¸æœºçš„å†…å¤–å‚æ•°çš„æ€è·¯"></a>æ ‡å®šç›¸æœºçš„å†…å¤–å‚æ•°çš„æ€è·¯</h2><ol><li>æ±‚è§£å†…å‚çŸ©é˜µä¸å¤–å‚çŸ©é˜µçš„ç§¯</li><li>æ±‚è§£å†…å‚çŸ©é˜µ</li><li>æ±‚è§£å¤–å‚çŸ©é˜µ</li></ol><ul><li><p>æ±‚è§£å†…å‚çŸ©é˜µä¸å¤–å‚çŸ©é˜µçš„ç§¯</p><p>  å°†ä¸–ç•Œåæ ‡ç³»å›ºå®šäºæ£‹ç›˜æ ¼ä¸Šï¼Œåˆ™æ£‹ç›˜æ ¼ä¸Šä»»ä¸€ç‚¹çš„ç‰©ç†åæ ‡$W&#x3D;0$ï¼Œå› æ­¤ï¼ŒåŸå•ç‚¹æ— ç•¸å˜çš„æˆåƒæ¨¡å‹å¯ä»¥åŒ–ä¸ºä¸‹å¼ã€‚å…¶ä¸­ï¼Œ $R_1,R_2$ä¸ºæ—‹è½¬çŸ©é˜µ$R$çš„å‰ä¸¤åˆ—ã€‚ä¸ºäº†ç®€ä¾¿ï¼Œå°†å†…å‚çŸ©é˜µè®°ä¸º$A$</p><p>  $$<br>  s\left[\begin{aligned}&amp;u\&amp;v\&amp;1\end{aligned}\right]&#x3D;\left[\begin{aligned}&amp;\frac{f}{dX} &amp;-\frac{f\cot\theta}{dX}&amp; \ &amp;u_0\&amp;0 &amp;\frac{f}{dY\sin\theta}&amp; \ &amp;v_0\&amp;0 &amp;0&amp; \ &amp;1\end{aligned}\right]\left[\begin{aligned}&amp;R_1&amp; R_2&amp;&amp;T\end{aligned}\right]\left[\begin{aligned}&amp;U\&amp;V\&amp;1\end{aligned}\right]&#x3D;A[R_1\ \ R_2\ \ T]\left[\begin{aligned}&amp;U\&amp;V\&amp;1\end{aligned}\right]<br>  $$</p><p>  å¯¹äºä¸åŒçš„å›¾ç‰‡ï¼Œå†…å‚çŸ©é˜µ$A$ä¸ºå®šå€¼ï¼›å¯¹äºåŒä¸€å¼ å›¾ç‰‡ï¼Œå†…å‚çŸ©é˜µ$A$ï¼Œå¤–å‚çŸ©é˜µ$[R_1\ \ R_2\ \ T]$ä¸ºå®šå€¼ï¼›å¯¹äºåŒä¸€å¼ å›¾ç‰‡ä¸Šçš„å•ç‚¹ï¼Œå†…å‚çŸ©é˜µ$A$ï¼Œå¤–å‚çŸ©é˜µï¼Œå°ºåº¦å› å­$s$ä¸ºå®šå€¼</p><p>  æˆ‘ä»¬å°†$A[R_1\ \ R_2\ \ T]$è®°ä¸ºçŸ©é˜µ$H$ï¼Œ $H$å³ä¸ºå†…å‚çŸ©é˜µå’Œå¤–å‚çŸ©é˜µçš„ç§¯ï¼Œè®°çŸ©é˜µ$H$çš„ä¸‰åˆ—ä¸º$[H_1,H_2,H_3]$ï¼Œåˆ™æœ‰</p><p>  $$<br>  \left[\begin{aligned}&amp;u\&amp;v\&amp;1\end{aligned}\right]&#x3D;\frac{1}{s}H\left[\begin{aligned}&amp;U\&amp;V\&amp;1\end{aligned}\right]&#x3D;\frac{1}{s}\left[\begin{aligned}&amp;H_{11} &amp;H_{12}&amp; &amp;H_{13}\&amp;H_{21} &amp;H_{22}&amp; &amp;H_{23}\&amp;H_{31} &amp;H_{32}&amp; &amp;H_{33}\end{aligned}\right]\left[\begin{aligned}&amp;U\&amp;V\&amp;1\end{aligned}\right]<br>  $$</p><p>  åˆ©ç”¨ä¸Šå¼ï¼Œæ¶ˆå»å°ºåº¦å› å­$s$ï¼Œå¯å¾—</p><p>  $$<br>  \begin{aligned}u&amp;&#x3D;\frac{H_{11}U+H_{12}V+H_{13}}{H_{31}U+H_{32}V+H_{33}}\v&amp;&#x3D;\frac{H_{21}U+H_{22}V+H_{23}}{H_{31}U+H_{32}V+H_{33}}\end{aligned}<br>  $$</p><p>  æ­¤æ—¶ï¼Œå°ºåº¦å› å­$s$å·²ç»è¢«æ¶ˆå»ï¼Œå› æ­¤ä¸Šå¼å¯¹äºåŒä¸€å¼ å›¾ç‰‡ä¸Šæ‰€æœ‰çš„è§’ç‚¹å‡æˆç«‹ã€‚$(u,v)$æ˜¯åƒç´ åæ ‡ç³»ä¸‹çš„æ ‡å®šæ¿è§’ç‚¹çš„åæ ‡ï¼Œ$(U,V)$æ˜¯ä¸–ç•Œåæ ‡ç³»ä¸‹çš„æ ‡å®šæ¿è§’ç‚¹çš„åæ ‡ã€‚é€šè¿‡å›¾åƒè¯†åˆ«ç®—æ³•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°æ ‡å®šæ¿è§’ç‚¹çš„åƒç´ åæ ‡$(u,v)$ï¼Œåˆç”±äºæ ‡å®šæ¿çš„ä¸–ç•Œåæ ‡ç³»æ˜¯äººä¸ºå®šä¹‰å¥½çš„ï¼Œæ ‡å®šæ¿ä¸Šæ¯ä¸€ä¸ªæ ¼å­çš„å¤§å°æ˜¯å·²çŸ¥çš„ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—å¾—åˆ°ä¸–ç•Œåæ ‡ç³»ä¸‹çš„$(U,V)$</p><p>  ç”±è¿™é‡Œçš„$H$æ˜¯é½æ¬¡çŸ©é˜µï¼Œæœ‰8ä¸ªç‹¬ç«‹æœªçŸ¥å…ƒç´ ã€‚æ¯ä¸€ä¸ªæ ‡å®šæ¿è§’ç‚¹å¯ä»¥æä¾›ä¸¤ä¸ªçº¦æŸæ–¹ç¨‹ï¼ˆ$v,U,V$çš„å¯¹åº”å…³ç³»ã€$u,U,V$çš„å¯¹åº”å…³ç³»æä¾›äº†ä¸¤ä¸ªçº¦æŸæ–¹ç¨‹ï¼‰ï¼Œå› æ­¤ï¼Œå½“ä¸€å¼ å›¾ç‰‡ä¸Šçš„æ ‡å®šæ¿è§’ç‚¹æ•°é‡ç­‰äº4æ—¶ï¼Œå³å¯æ±‚å¾—è¯¥å›¾ç‰‡å¯¹åº”çš„çŸ©é˜µ$H$ã€‚å½“ä¸€å¼ å›¾ç‰‡ä¸Šçš„æ ‡å®šæ¿è§’ç‚¹æ•°é‡å¤§äº4æ—¶ï¼Œåˆ©ç”¨æœ€å°äºŒä¹˜æ³•å›å½’æœ€ä½³çš„çŸ©é˜µ$H$</p></li><li><p>æ±‚è§£å†…å‚çŸ©é˜µ</p><p>  æˆ‘ä»¬å·²çŸ¥äº†çŸ©é˜µ$H<br>  &#x3D;A[R_1\ \ R_2\ \ T]$ï¼Œæ¥ä¸‹æ¥éœ€è¦æ±‚è§£ç›¸æœºçš„å†…å‚çŸ©é˜µ$A$ã€‚</p><p>  æˆ‘ä»¬åˆ©ç”¨$R_1,R_2$ä½œä¸ºæ—‹è½¬çŸ©é˜µ$R$çš„ä¸¤åˆ—ï¼Œå­˜åœ¨å•ä½æ­£äº¤çš„å…³ç³»ï¼Œå³ï¼š</p><p>  $$<br>  R_1^TR_2&#x3D;0\R_1^TR_1&#x3D;R_2^TR_2&#x3D;I<br>  $$</p><p>  åˆ™ç”±$H$å’Œ$R_1,R_2$çš„å…³ç³»ï¼Œå¯çŸ¥</p><p>  $$<br>  R_1&#x3D;A^{-1}H_1\R_2&#x3D;A^{-1}H_2<br>  $$</p><p>  å¸¦å…¥å¾—åˆ°</p><p>  $$<br>  H_1^TA^{-T}A^{-1}H_2&#x3D;0\H_1^TA^{-T}A^{-1}H_1&#x3D;H_2^TA^{-T}A^{-1}H_2&#x3D;I<br>  $$</p><p>  å¦å¤–ï¼Œæˆ‘ä»¬å‘ç°ï¼Œä¸Šè¿°ä¸¤ä¸ªçº¦æŸæ–¹ç¨‹ä¸­å‡å­˜åœ¨çŸ©é˜µ$A^{-T}A^{-1}$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®°$A^{-T}A^{-1}&#x3D;B$ï¼Œåˆ™$B$ä¸ºå¯¹ç§°é˜µã€‚æˆ‘ä»¬è¯•å›¾å…ˆæ±‚è§£å‡ºçŸ©é˜µÂ $B$ï¼Œé€šè¿‡çŸ©é˜µÂ $B$å†æ±‚è§£ç›¸æœºçš„å†…å‚çŸ©é˜µÂ $A$ã€‚åŒæ—¶ï¼Œä¸ºäº†ç®€ä¾¿ï¼Œæˆ‘ä»¬è®°ç›¸æœºå†…å‚çŸ©é˜µ$A$ä¸º</p><p>  $$<br>  A&#x3D;\left[\begin{aligned}&amp;\frac{f}{dX} &amp;-\frac{f\cot\theta}{dX}&amp; \ &amp;u_0&amp; &amp;0\&amp;0 &amp;\frac{f}{dY\sin\theta}&amp; \ &amp;v_0&amp; &amp;0\&amp;0 &amp;0&amp; \ &amp;1&amp; &amp;0\end{aligned}\right]&#x3D;\left[\begin{aligned}&amp;\alpha &amp;\gamma&amp; &amp;u_0\&amp;0 &amp;\beta&amp; &amp;v_0\&amp;0 &amp;0&amp; &amp;1\end{aligned}\right]<br>  $$</p><p>  åˆ™æœ‰</p><p>  $$<br>  A^{-1}&#x3D;\left[\begin{aligned}&amp;\frac{1}{\alpha} &amp;-\frac{\gamma}{\alpha\beta}&amp; &amp;\frac{\gamma v_0-\beta u_0}{\alpha\beta}\&amp;0 &amp;\frac{1}{\beta}&amp; &amp;-\frac{v_0}{\beta}\&amp;0 &amp;0&amp; &amp;1\end{aligned}\right]<br>  $$</p><p>  è€Œ$B$ä¸º</p><p>  $$<br>  B&#x3D;A^{-T}A^{-1}&#x3D;\left[\begin{aligned}&amp;B_{11} &amp;B_{12}&amp; &amp;B_{13}\&amp;B_{21} &amp;B_{22}&amp; &amp;B_{23}\&amp;B_{31} &amp;B_{32}&amp; &amp;B_{33}\end{aligned}\right]<br>  $$</p><p>  é€šè¿‡$R_1,R_2$æ­£äº¤çš„å…³ç³»ï¼Œéœ€è¦è®¡ç®—$H_i^TBH_j$æ¥å¾—åˆ°æœ€ç»ˆçš„çŸ©é˜µ$B$ï¼Œä»¤</p><p>  $$<br>  \begin{aligned}v_{ij}&amp;&#x3D;[H_{1i}H_{1j}\ \ H_{1i}H_{2j}+H_{2i}H_{1j}\ \ H_{1i}H_{3j}+H_{3i}H_{1j}\ \ H_{2i}H_{3j}+H_{3i}H_{2j}\ \ H_{3i}H_{3j}]^T\ b&amp;&#x3D;[B_{11}\ \ B_{12}\ \ B_{22}\ \ B_{13}\ \ B_{23}\ \ B_{33}]^T\end{aligned}<br>  $$</p><p>  æœ‰$H_i^TBH_j&#x3D;v_{ij}b$ï¼Œ$R_1,R_2$æ­£äº¤æ–¹ç¨‹ç®€åŒ–ä¸º</p><p>  $$<br>  v_{12}^Tb&#x3D;0\v_{11}^Tb&#x3D;v_{22}^Tb&#x3D;I<br>  $$</p><p>  å³</p><p>  $$<br>  \left[\begin{aligned}v_{12}^T&amp;\v_{11}^T-&amp;v_{22}^T\end{aligned}\right]b&#x3D;0<br>  $$</p><p>  ç”±äºçŸ©é˜µ$H$å·²çŸ¥ï¼ŒçŸ©é˜µ$v&#x3D;\left[\begin{aligned}v_{12}^T&amp;\v_{11}^T-&amp;v_{22}^T\end{aligned}\right]$$\left[\begin{aligned}v_{12}^T&amp;\v_{11}^T-&amp;v_{22}^T\end{aligned}\right]$åˆå…¨éƒ¨ç”±çŸ©é˜µ$H$çš„å…ƒç´ æ„æˆï¼Œå› æ­¤çŸ©é˜µ$v$å·²çŸ¥ã€‚</p><p>  æ­¤æ—¶ï¼Œæˆ‘ä»¬åªè¦æ±‚è§£å‡ºå‘é‡$b$ï¼Œå³å¯å¾—åˆ°çŸ©é˜µ$B$ã€‚æ¯å¼ æ ‡å®šæ¿å›¾ç‰‡å¯ä»¥æä¾›ä¸€ä¸ª$vb&#x3D;0$çš„çº¦æŸå…³ç³»ï¼Œè¯¥çº¦æŸå…³ç³»å«æœ‰ä¸¤ä¸ªçº¦æŸæ–¹ç¨‹ã€‚ä½†æ˜¯ï¼Œå‘é‡$b$æœ‰6ä¸ªæœªçŸ¥å…ƒç´ ã€‚å› æ­¤ï¼Œå•å¼ å›¾ç‰‡æä¾›çš„ä¸¤ä¸ªçº¦æŸæ–¹ç¨‹æ˜¯ä¸è¶³ä»¥è§£å‡ºæ¥å‘é‡$b$ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªè¦å–3å¼ æ ‡å®šæ¿ç…§ç‰‡ï¼Œå¾—åˆ°3ä¸ª$vb&#x3D;0$çš„çº¦æŸå…³ç³»ï¼Œå³6ä¸ªæ–¹ç¨‹ï¼Œå³å¯æ±‚è§£å‘é‡$b$ã€‚å½“æ ‡å®šæ¿å›¾ç‰‡çš„ä¸ªæ•°å¤§äº3æ—¶ï¼ˆäº‹å®ä¸Šä¸€èˆ¬éœ€è¦15åˆ°20å¼ æ ‡å®šæ¿å›¾ç‰‡ï¼‰ï¼Œå¯é‡‡ç”¨æœ€å°äºŒä¹˜æ‹Ÿåˆæœ€ä½³çš„å‘é‡$b$ï¼Œå¹¶å¾—åˆ°çŸ©é˜µ$B$ã€‚</p><p>  <img src="/./2022/06/24/%E7%9B%B8%E6%9C%BA%E6%A0%87%E5%AE%9A/latex.png" alt="function"></p><p>  æ ¹æ®çŸ©é˜µ$B$çš„å…ƒç´ å’Œç›¸æœºå†…å‚$\alpha,\beta,\gamma,u_0,v_0$çš„å¯¹åº”å…³ç³»ï¼Œå¯å¾—åˆ°</p><p>  $$<br>  v_0&#x3D;\frac{B_{12}B_{13}-B_{11}B_{23}}{B_{11}B_{22}-B_{12}^2}\ \alpha&#x3D;\sqrt{\frac{1}{B_{11}}}\ \beta&#x3D;\sqrt{\frac{B_{11}}{B_{11}B_{22}-B_{12}^2}}\ \gamma&#x3D;-B_{12}\alpha^2\beta \ u_0&#x3D;\frac{\gamma v_0}{\beta}-B_{13}\alpha^2<br>  $$</p><p>  å³å¯æ±‚å¾—å†…å‚çŸ©é˜µ$A&#x3D;\left[\begin{aligned}&amp;\frac{1}{dX} &amp;-\frac{f\cot\theta}{dX}&amp; \ &amp;u_0&amp; &amp;0\&amp;0 &amp;\frac{1}{dY\sin\theta}&amp; \ &amp;v_0&amp; &amp;0\&amp;0 &amp;0&amp; \ &amp;1&amp; &amp;0\end{aligned}\right]&#x3D;\left[\begin{aligned}&amp;\alpha &amp;\gamma&amp; &amp;u_0\&amp;0 &amp;\beta&amp; &amp;v_0\&amp;0 &amp;0&amp; &amp;1\end{aligned}\right]$</p></li><li><p>æ±‚è§£å¤–å‚çŸ©é˜µ</p><p>  å¯¹äºåŒä¸€ä¸ªç›¸æœºï¼Œç›¸æœºçš„å†…å‚çŸ©é˜µå–å†³äºç›¸æœºçš„å†…éƒ¨å‚æ•°ï¼Œæ— è®ºæ ‡å®šæ¿å’Œç›¸æœºçš„ä½ç½®å…³ç³»æ˜¯æ€ä¹ˆæ ·çš„ï¼Œç›¸æœºçš„å†…å‚çŸ©é˜µä¸å˜ã€‚è¿™ä¹Ÿæ­£æ˜¯åœ¨æ±‚è§£å†…å‚çŸ©é˜µä¸­ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ä¸åŒçš„å›¾ç‰‡ï¼ˆæ ‡å®šæ¿å’Œç›¸æœºä½ç½®å…³ç³»ä¸åŒï¼‰è·å–çš„çŸ©é˜µ$H$ï¼Œå…±åŒæ±‚è§£ç›¸æœºå†…å‚çŸ©é˜µ$A$çš„åŸå› ã€‚</p><p>  ä½†æ˜¯ï¼Œå¤–å‚çŸ©é˜µåæ˜ çš„æ˜¯æ ‡å®šæ¿å’Œç›¸æœºçš„ä½ç½®å…³ç³»ã€‚å¯¹äºä¸åŒçš„å›¾ç‰‡ï¼Œæ ‡å®šæ¿å’Œç›¸æœºçš„ä½ç½®å…³ç³»å·²ç»æ”¹å˜ï¼Œæ­¤æ—¶æ¯ä¸€å¼ å›¾ç‰‡å¯¹åº”çš„å¤–å‚çŸ©é˜µéƒ½æ˜¯ä¸åŒçš„ã€‚</p><p>  åœ¨å…³ç³»$H<br>  &#x3D;A[R_1\ \ R_2\ \ T]$ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ±‚è§£å¾—åˆ°äº†çŸ©é˜µ$H$ï¼ˆå¯¹äºåŒä¸€å¼ å›¾ç‰‡ç›¸åŒï¼Œå¯¹äºä¸åŒçš„å›¾ç‰‡ä¸åŒï¼‰ã€çŸ©é˜µ$A$ï¼ˆå¯¹äºä¸åŒçš„å›¾ç‰‡éƒ½ç›¸åŒï¼‰ã€‚é€šè¿‡å…¬å¼$[R_1\ \ R_2\ \ T]&#x3D;A^{-1}H$ï¼Œå³å¯æ±‚å¾—æ¯ä¸€å¼ å›¾ç‰‡å¯¹åº”çš„å¤–å‚çŸ©é˜µ$[R_1\ \ R_2\ \ T]$ã€‚</p><p>  æ³¨æ„ï¼Œè¿™é‡Œå€¼å¾—æŒ‡å‡ºï¼Œå®Œæ•´çš„å¤–å‚çŸ©é˜µä¸º$\left[\begin{aligned}&amp;R &amp;T\&amp;0 &amp;1\end{aligned}\right]$ã€‚ä½†æ˜¯ï¼Œç”±äºå¼ æ­£å‹æ ‡å®šæ¿å°†ä¸–ç•Œåæ ‡ç³»çš„åŸç‚¹é€‰å–åœ¨æ£‹ç›˜æ ¼ä¸Šï¼Œåˆ™æ£‹ç›˜æ ¼ä¸Šä»»ä¸€ç‚¹çš„ç‰©ç†åæ ‡$W&#x3D;0$ï¼Œå°†æ—‹è½¬çŸ©é˜µçš„$R$çš„ç¬¬ä¸‰åˆ—$R_3$æ¶ˆæ‰ï¼Œå› æ­¤ï¼Œ$R_3$åœ¨åæ ‡è½¬åŒ–ä¸­å¹¶æ²¡æœ‰ä½œç”¨ã€‚ä½†æ˜¯$R_3$è¦ä½¿å¾—$R$æ»¡è¶³æ—‹è½¬çŸ©é˜µçš„æ€§è´¨ï¼Œå³åˆ—ä¸åˆ—ä¹‹é—´å•ä½æ­£äº¤ï¼Œå› æ­¤å¯ä»¥é€šè¿‡å‘é‡$R_1,R_2$çš„å‰ä¹˜ï¼Œå³$R_3&#x3D;R_1\times R_2$è®¡ç®—å¾—åˆ°ã€‚</p><p>  æ­¤æ—¶ï¼Œç›¸æœºçš„å†…å‚çŸ©é˜µå’Œå¤–å‚çŸ©é˜µå‡å·²å¾—åˆ°ã€‚</p><p>  <strong>æ³¨ï¼šä»¥ä¸Šæ¨å¯¼éƒ½æ˜¯å‡è®¾ä¸å­˜åœ¨ç•¸å˜å‚æ•°çš„æƒ…å†µä¸‹æˆç«‹çš„</strong>ã€‚ä½†æ˜¯äº‹å®ä¸Šï¼Œç›¸æœºæ˜¯å­˜åœ¨ç•¸å˜å‚æ•°çš„ï¼Œå› æ­¤ï¼Œå¼ æ­£å‹æ ‡å®šæ³•è¿˜éœ€è¦é€šè¿‡L-Mç®—æ³•å¯¹äºå‚æ•°è¿›è¡Œè¿­ä»£ä¼˜åŒ–ã€‚</p></li></ul><h2 id="æ ‡å®šæ­¥éª¤"><a href="#æ ‡å®šæ­¥éª¤" class="headerlink" title="æ ‡å®šæ­¥éª¤"></a>æ ‡å®šæ­¥éª¤</h2><ol><li>å‡†å¤‡ä¸€ä¸ªå¼ æ­£å‹æ ‡å®šæ³•çš„æ£‹ç›˜æ ¼ï¼Œæ£‹ç›˜æ ¼å¤§å°å·²çŸ¥ï¼Œç”¨ç›¸æœºå¯¹å…¶è¿›è¡Œä¸åŒè§’åº¦çš„æ‹æ‘„ï¼Œå¾—åˆ°ä¸€ç»„å›¾åƒ</li><li>å¯¹å›¾åƒä¸­çš„ç‰¹å¾ç‚¹å¦‚æ ‡å®šæ¿è§’ç‚¹è¿›è¡Œæ£€æµ‹ï¼Œå¾—åˆ°æ ‡å®šæ¿è§’ç‚¹çš„åƒç´ åæ ‡å€¼ï¼Œæ ¹æ®å·²çŸ¥çš„æ£‹ç›˜æ ¼å¤§å°å’Œä¸–ç•Œåæ ‡ç³»åŸç‚¹ï¼Œè®¡ç®—å¾—åˆ°æ ‡å®šæ¿è§’ç‚¹çš„ç‰©ç†åæ ‡å€¼</li><li>æ±‚è§£å†…å‚çŸ©é˜µä¸å¤–å‚çŸ©é˜µã€‚æ ¹æ®ç‰©ç†åæ ‡å€¼å’Œåƒç´ åæ ‡å€¼çš„å…³ç³»ï¼Œæ±‚å‡º$H$çŸ©é˜µï¼Œè¿›è€Œæ„é€ $v$çŸ©é˜µï¼Œæ±‚è§£$B$çŸ©é˜µï¼Œåˆ©ç”¨$B$çŸ©é˜µæ±‚è§£ç›¸æœºå†…å‚çŸ©é˜µ$A$ï¼Œæœ€åæ±‚è§£æ¯å¼ å›¾ç‰‡å¯¹åº”çš„ç›¸æœºå¤–å‚çŸ©é˜µ$\left[\begin{aligned}&amp;R&amp; t\&amp;0&amp;1\end{aligned}\right]$</li><li>æ±‚è§£ç•¸å˜å‚æ•°ã€‚åˆ©ç”¨$\hat{u},u,\hat{v},v$æ„é€ $D$çŸ©é˜µï¼Œè®¡ç®—å¾„å‘ç•¸å˜å‚æ•°</li><li>åˆ©ç”¨L-Mï¼ˆLevenberg-Marquardtï¼‰ç®—æ³•å¯¹ä¸Šè¿°å‚æ•°è¿›è¡Œä¼˜åŒ–</li></ol><h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://blog.csdn.net/lql0716/article/details/71973318?locationNum=8&fps=1"></a></p><p><a href="https://blog.csdn.net/a083614/article/details/78579163">æœ€è¯¦ç»†ã€æœ€å®Œæ•´çš„ç›¸æœºæ ‡å®šè®²è§£_a083614çš„ä¸“æ -CSDNåšå®¢_ç›¸æœºæ ‡å®š</a></p><p><a href="https://zhuanlan.zhihu.com/p/30813733">ç›¸æœºæ ‡å®šç©¶ç«Ÿåœ¨æ ‡å®šä»€ä¹ˆï¼Ÿ</a></p><p><a href="https://zhuanlan.zhihu.com/p/94244568">ç›¸æœºæ ‡å®šä¹‹å¼ æ­£å‹æ ‡å®šæ³•æ•°å­¦åŸç†è¯¦è§£ï¼ˆå«pythonæºç ï¼‰</a></p>]]></content>
    
    
    <categories>
      
      <category>3D Basic</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Camera</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>start</title>
    <link href="/2022/06/24/start/"/>
    <url>/2022/06/24/start/</url>
    
    <content type="html"><![CDATA[<h1 id="å…³äºæ­¤ä»½pages"><a href="#å…³äºæ­¤ä»½pages" class="headerlink" title="å…³äºæ­¤ä»½pages"></a>å…³äºæ­¤ä»½pages</h1><br /><p>æ­¤Github Pagesä¸ºæœ¬äººè®°å½•3Då­¦ä¹ ä»¥åŠå„ç§æ‚é¡¹çš„bakã€‚</p>]]></content>
    
    
    <categories>
      
      <category>misc</category>
      
    </categories>
    
    
    <tags>
      
      <tag>misc</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
